"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[3937],{16333:function(t,n,e){e.d(n,{Ld:function(){return i.L},ad:function(){return r.a}});e(37750);var r=e(44072),i=e(38815)},21636:function(t,n,e){e.d(n,{$E:function(){return d},AA:function(){return l},Bt:function(){return i},Ex:function(){return o},Vg:function(){return s},gK:function(){return u},kj:function(){return r},n2:function(){return c},zZ:function(){return a}});const r="yellow500",i="yellow200",o="mlflow.trace.sourceScorer",s="mlflow.assessment.sourceRunId",u="mlflow.assessment.scorerTraceId",a="mlflow.assessment.judgeCost",c="mlflow.trace.session",l="mlflow.source.name",d="mlflow.source.type"},30676:function(t,n,e){e.d(n,{z7:function(){return R},VE:function(){return E}});var r=e(76386),i=e(91215),o=e(49693),s=e(94066),u=e(3491),a=e(20515),c=e(27962),l=e(54921),d=e(94811),f=e(52394),p=e(76118),v=e(73408),m=(e(46709),e(16333)),y=e(74060),N=e(27757);var h={name:"1739oy8",styles:"z-index:1"};function g({tooltipMessage:t,...n}){const e=h;return(0,v.Y)(y.LegacyTooltip,{title:t,children:(0,v.Y)(N.B,{componentId:"codegen_web-shared_src_snippet_actions_snippetactionbutton.tsx_33",...n,css:e})})}function E({copyText:t,onClick:n,...e}){const{actionIcon:r,tooltipMessage:i,copy:o}=(0,m.Ld)(t);return(0,v.Y)(g,{tooltipMessage:i,icon:r,onClick:t=>{o(),null===n||void 0===n||n(t)},...e})}r.A.registerLanguage("sql",l.A),r.A.registerLanguage("java",o.A),r.A.registerLanguage("python",a.A),r.A.registerLanguage("go",i.A),r.A.registerLanguage("javascript",s.A),r.A.registerLanguage("yaml",c.A),r.A.registerLanguage("json",u.A);const _="24px",A={light:f.A,duotoneDark:d.A};function R({theme:t="light",language:n,actions:e,style:i,children:o,showLineNumbers:s,lineNumberStyle:u,wrapLongLines:a,wrapLines:c,lineProps:l,PreTag:d}){const f={border:"none",borderRadius:0,margin:0,padding:_,...i};return(0,v.Y)(r.A,{showLineNumbers:s,lineNumberStyle:u,language:n,style:A[t],customStyle:f,codeTagProps:{style:(0,p.pick)(i,"backgroundColor")},lineProps:l,wrapLongLines:a,wrapLines:c,PreTag:d,children:o})}},42747:function(t,n,e){e.d(n,{sA:function(){return r.sA},tz:function(){return r.tz},zR:function(){return r.zR}});var r=e(77680);e(13584)},44072:function(t,n,e){e.d(n,{a:function(){return u}});e(46709);var r=e(27757),i=e(79081),o=e(38815),s=e(73408);function u({buttonProps:t,componentId:n,copyText:e,copyTooltip:u,isInsideInputGroup:a=!1,onCopy:c,tooltipProps:l}){const{actionIcon:d,copy:f,handleTooltipOpenChange:p,tooltipOpen:v,tooltipMessage:m}=(0,o.L)(e,u,c),y=(0,s.Y)(r.B,{"aria-label":m,componentId:null!==n&&void 0!==n?n:"codegen_web-shared_src_copy_copyactionbutton.tsx_17",icon:d,onClick:f,size:"small",...t}),N=(0,s.Y)(r.B,{"aria-label":m,componentId:null!==n&&void 0!==n?n:"codegen_web-shared_src_copy_copyactionbutton.tsx_17",onClick:f,...t,children:d});return(0,s.Y)(i.T,{componentId:n?`${n}-tooltip`:"codegen_web-shared_src_copy_copyactionbutton.tsx_17-tooltip",content:m,onOpenChange:p,open:v,...l,children:a?N:y})}},86125:function(t,n,e){e.d(n,{BS:function(){return c},CL:function(){return F},Hq:function(){return j},I$:function(){return W},LS:function(){return f},MF:function(){return O},N7:function(){return G},OS:function(){return S},PC:function(){return H},Q0:function(){return D},UZ:function(){return E},W0:function(){return I},ZI:function(){return $},bn:function(){return k},cp:function(){return A},f7:function(){return y},gD:function(){return g},g_:function(){return M},h8:function(){return K},ij:function(){return l},in:function(){return Y},jW:function(){return L},nr:function(){return J},ob:function(){return T},pQ:function(){return z},tC:function(){return d},vL:function(){return m},vl:function(){return U},x0:function(){return B},xD:function(){return p}});var r=e(68248),i=e(76118),o=(e(46709),e(94664)),s=e(51847),u=e(27786),a=(e(81390),e(73408));const c="model-trace-info-v3",l=t=>{};function d(t){switch(t){case o.UG.LLM:return o.Dy.MODELS;case o.UG.CHAIN:return o.Dy.CHAIN;case o.UG.AGENT:return o.Dy.AGENT;case o.UG.TOOL:return o.Dy.WRENCH;case o.UG.CHAT_MODEL:return o.Dy.MODELS;case o.UG.RETRIEVER:return o.Dy.SEARCH;case o.UG.PARSER:return o.Dy.CODE;case o.UG.EMBEDDING:return o.Dy.NUMBERS;case o.UG.RERANKER:return o.Dy.SORT;case o.UG.MEMORY:return o.Dy.SAVE;case o.UG.FUNCTION:return o.Dy.FUNCTION;case o.UG.UNKNOWN:return o.Dy.UNKNOWN;default:return o.Dy.FUNCTION}}function f(t){switch(t){case o.UG.LLM:return"LLM";case o.UG.CHAIN:return"Chain";case o.UG.AGENT:return"Agent";case o.UG.TOOL:return"Tool";case o.UG.CHAT_MODEL:return"Chat model";case o.UG.RETRIEVER:return"Retriever";case o.UG.PARSER:return"Parser";case o.UG.EMBEDDING:return"Embedding";case o.UG.RERANKER:return"Reranker";case o.UG.MEMORY:return"Memory";case o.UG.FUNCTION:return"Function";case o.UG.UNKNOWN:return"Unknown";default:return t}}function p(t){try{return JSON.parse(t)}catch(n){return t}}const v=(t,n)=>{if(!n)return[];const e=[],r={inputs:null===t||void 0===t?void 0:t.inputs,outputs:null===t||void 0===t?void 0:t.outputs,attributes:null===t||void 0===t?void 0:t.attributes,events:null===t||void 0===t?void 0:t.events};return(0,i.map)(r,((r,i)=>{if("events"===i)return void e.push(...((t,n)=>{const e=t.events;if(!e)return[];const r=[];return e.forEach(((e,i)=>{const o=e.attributes;o&&Object.keys(o).forEach((s=>{const u=s.toLowerCase().includes(n),a=D(e.name,i,s);u&&r.push({span:t,section:"events",key:a,isKeyMatch:!0,matchIndex:0});const c=JSON.stringify(o[s]).toLowerCase().split(n).length-1;for(let n=0;n<c;n++)r.push({span:t,section:"events",key:a,isKeyMatch:!1,matchIndex:n})}))})),r})(t,n));M(r).forEach((r=>{r.key.toLowerCase().includes(n)&&e.push({span:t,section:i,key:r.key,isKeyMatch:!0,matchIndex:0});const o=r.value.toLowerCase().split(n).length-1;for(let n=0;n<o;n++)e.push({span:t,section:i,key:r.key,isKeyMatch:!1,matchIndex:n})}))})),e};function m(t,n,e){var r,i;const o=n.toLowerCase().trim(),s=Object.values(e.spanTypeDisplayState).every((t=>t));if(""===o&&s)return{filteredTreeNodes:[t],matches:[]};const u=null!==(r=t.children)&&void 0!==r?r:[],a=[],c=[];u.forEach((t=>{const{filteredTreeNodes:n,matches:r}=m(t,o,e);a.push(...n),c.push(...r)}));const l=(null!==(i=t.title)&&void 0!==i?i:"").toLowerCase(),d=v(t,o),f=d.length>0||l.includes(o),p=!t.type||e.spanTypeDisplayState[t.type],y=f&&p,N=a.length>0,h=G(t)>0;return y||e.showParents&&N||e.showExceptions&&h?{filteredTreeNodes:[{...t,children:a}],matches:d.concat(c)}:{filteredTreeNodes:a,matches:c}}function y(t,n){var e;if((0,i.isNil)(n)||(0,i.isNil)(t))return;if(t.key===n)return t;const r=null!==(e=t.children)&&void 0!==e?e:[];for(const i of r){const t=y(i,n);if(t)return t}}const N=(t,n,e,r,o,u)=>{var c,l,f,v,m,y,N,h;const g=p(null===(c=t.attributes)||void 0===c?void 0:c["mlflow.spanType"]),E=p(null===(l=t.attributes)||void 0===l?void 0:l["mlflow.spanInputs"]),O=p(null===(f=t.attributes)||void 0===f?void 0:f["mlflow.spanOutputs"]),T=A(t),L=_(t),C=null!==(v=o[L])&&void 0!==v?v:[];var w;T||C.push(...null!==(w=o[""])&&void 0!==w?w:[]);const M=p(null===(m=t.attributes)||void 0===m?void 0:m["mlflow.chat.messages"]),S=p(null===(y=t.attributes)||void 0===y?void 0:y["mlflow.message.format"]),I=((t,n,e,r)=>{var o,s;if(Array.isArray(t)&&t.every(W))return(0,i.compact)(t.map($));const u=null!==(o=j(n,r))&&void 0!==o?o:[],a=null!==(s=j(e,r))&&void 0!==s?s:[];return 0!==u.length&&0!==a.length?u.concat(a):void 0})(M,E,O,S),U=((t,n)=>{var e;return Array.isArray(t)&&t.every(H)?t:Array.isArray(null===n||void 0===n?void 0:n.tools)&&null!==n&&void 0!==n&&null!==(e=n.tools)&&void 0!==e&&e.every(H)?n.tools:void 0})(p(null===(N=t.attributes)||void 0===N?void 0:N["mlflow.chat.tools"]),E),D=(0,i.mapValues)((0,i.omitBy)(t.attributes,((t,n)=>n.startsWith("mlflow."))),(t=>p(t))),k=t.events,x=(Number(R(t))-n)/1e3,K=(Number(null!==(h=b(t))&&void 0!==h?h:e)-n)/1e3;return{title:t.name,icon:(0,a.Y)(s.P,{type:d(g),hasException:G(t)>0,isRootSpan:!T}),type:g,key:L,start:x,end:K,children:r,inputs:E,outputs:O,attributes:D,events:k,chatMessageFormat:S,chatMessages:I,chatTools:U,parentId:T,assessments:C,traceId:u}},h=(t,n)=>{if(!t)return"";if(n&&t.length<16)try{return(t=>{const n=atob(t),e=n.length;let r="";for(let i=0;i<e;i++)r+=n.charCodeAt(i).toString(16).padStart(2,"0");return r})(t)}catch(e){return t}return t.startsWith("0x")?t.slice(2):t};function g(t){return"trace_location"in t}function E(t){return"start_time_unix_nano"in t}function _(t){var n,e,r;return E(t)?h(null!==(n=t.span_id)&&void 0!==n?n:"",!0):h(null!==(e=null===(r=t.context)||void 0===r?void 0:r.span_id)&&void 0!==e?e:"",!1)}function A(t){var n,e;return E(t)?h(null!==(n=t.parent_span_id)&&void 0!==n?n:"",!0):h(null!==(e=t.parent_id)&&void 0!==e?e:"",!1)}function R(t){return E(t)?Number(t.start_time_unix_nano):Number(t.start_time)}function b(t){return E(t)?Number(t.end_time_unix_nano):Number(t.end_time)}function O(t){var n;return g(t.info)?t.info.trace_id:null!==(n=t.info.request_id)&&void 0!==n?n:""}function T(t){var n,e;if(!g(t.info))return null;const r=Number(null===(n=t.info)||void 0===n||null===(e=n.trace_metadata)||void 0===e?void 0:e["mlflow.trace.sizeBytes"]);return(0,i.isNil)(r)||isNaN(r)?null:r}function L(t){var n,e;const r=O(t),u=null!==(n=null===(e=t.trace_data)||void 0===e?void 0:e.spans)&&void 0!==n?n:t.data.spans,c={},l={};u.forEach((t=>{const n=_(t);c[n]=t,l[n]=[]})),u.forEach((t=>{const n=_(t),e=A(t);if(e){if(!l[e])throw new Error("Tree structure is malformed!");l[e].push(n)}}));const f=u.find((t=>!A(t)));if((0,i.isNil)(f))return null;return function n(e){var i,u,p;const v=c[e],m=Number(R(f)),y=Number(b(f)),h=l[e].map(n),g=C(t.info);if(E(v)||"parent_id"in v)return N(v,m,y,h,g,r);const _=null!==(i=v.span_type)&&void 0!==i?i:o.UG.UNKNOWN;return{title:v.name,icon:(0,a.Y)(s.P,{type:d(_)}),type:_,key:v.context.span_id,start:Number(v.start_time)-m,end:Number(null!==(u=v.end_time)&&void 0!==u?u:y)-m,children:h,inputs:v.inputs,outputs:v.outputs,attributes:v.attributes,events:v.events,parentId:null!==(p=v.parent_id)&&void 0!==p?p:v.parent_span_id,assessments:[],traceId:r}}(_(f))}const C=t=>{let n=[];var e;g(t)?n=null!==(e=t.assessments)&&void 0!==e?e:[]:n=w(t.tags);const r=(0,i.keyBy)(n,"assessment_id");Object.values(r).forEach((t=>{if(t.overrides){const n=r[t.overrides];t.overriddenAssessment=n}})),n=Object.values(r);const o=n.reduce(((t,n)=>{var e;const r=null!==(e=n.span_id)&&void 0!==e?e:"";return t[r]||(t[r]=[]),t[r].push(n),t}),{});return Object.keys(o).forEach((t=>{o[t].sort(((t,n)=>new Date(n.last_update_time).getTime()-new Date(t.last_update_time).getTime()))})),o},w=t=>{if(!t)return[];return(Array.isArray(t)?t:Object.entries(t).map((([t,n])=>({key:t,value:n})))).filter((({key:t})=>t.startsWith("mlflow.assessment."))).map((({value:t})=>JSON.parse(t)))};const M=t=>(0,i.isNil)(t)?[]:Array.isArray(t)||(0,i.isString)(t)||(0,i.isNumber)(t)||(0,i.isBoolean)(t)?[{key:"",value:JSON.stringify(t,null,2)}]:Object.entries(t).map((([t,n])=>({key:t,value:JSON.stringify(n,null,2)}))),S=({searchFilter:t,data:n,activeMatchBackgroundColor:e,inactiveMatchBackgroundColor:o,containsActiveMatch:s,activeMatch:u,scrollToActiveMatch:c})=>{const l=new RegExp(`(${(0,i.escapeRegExp)(t.trim())})`,"gi"),d=n.split(l),f=[];let p=0;for(let i=0;i<d.length;i++)if(d[i].toLowerCase().includes(t.toLowerCase().trim())){const t=s&&u.matchIndex===p,n=t?e:o,l=(0,a.Y)("span",{ref:t?c:null,css:(0,r.AH)({backgroundColor:n,scrollMarginTop:50},""),children:d[i]},i);p++,f.push(l)}else f.push(d[i]);return f},I=t=>(0,i.has)(t,"page_content"),U=t=>t.type===o.UG.RETRIEVER&&Array.isArray(t.outputs)&&t.outputs.length>0&&(0,i.every)(t.outputs,I),D=(t,n,e)=>`${t}-${n}-${e}`,k=t=>{var n;return(null!==(n=t.events)&&void 0!==n?n:[]).filter((t=>"exception"===t.name))},G=t=>k(t).length,x=t=>!(0,i.isNil)(t)&&(!(!(0,i.isNil)(t.type)&&!(0,i.isString)(t.type))&&(!(!(0,i.isNil)(t.description)&&!(0,i.isString)(t.description))&&!(!(0,i.isNil)(t.enum)&&!Array.isArray(t.enum)))),H=t=>{var n;if((0,i.isNil)(t)||"function"!==t.type||!(0,i.has)(t,"function.name"))return!1;const e=null===(n=t.function)||void 0===n?void 0:n.parameters;if(!(0,i.isNil)(e)){const t=e.required;if(!(0,i.isNil)(t)&&(!Array.isArray(t)||!t.every(i.isString)))return!1;const n=e.properties;if(!(0,i.isNil)(n)&&!Object.values(n).every(x))return!1}return!0},K=t=>{var n,e;return t&&(0,i.isString)(t.id)&&(0,i.isString)(null===(n=t.function)||void 0===n?void 0:n.arguments)&&(0,i.isString)(null===(e=t.function)||void 0===e?void 0:e.name)},P=t=>!(!(0,i.isNil)(t)&&!(0,i.isString)(t))||!!(0,i.isArray)(t)&&t.every((t=>(t=>{switch(t.type){case"text":case"input_text":case"output_text":return(0,i.isString)(t.text);case"image_url":const{image_url:n}=t;return!(0,i.isNil)(n)&&(0,i.isString)(n.url)&&((0,i.isNil)(n.detail)||["auto","low","high"].includes(n.detail));case"input_audio":const{input_audio:e}=t;return!(0,i.isNil)(e)&&(0,i.isString)(e.data)&&((0,i.isNil)(e.format)||["wav","mp3"].includes(e.format));default:return!1}})(t))),W=t=>{if(!t)return!1;if(t.tool_calls){if(!Array.isArray(t.tool_calls))return!1;if(!t.tool_calls.every(K))return!1}return"reasoning"===t.type||!!P(t.content)&&("user"===t.role||"assistant"===t.role||"system"===t.role||"tool"===t.role)},B=t=>Array.isArray(t)&&t.length>0&&t.every((t=>{return(0,i.has)(t,"message")&&(n=t.message,!!W(n)&&((0,i.isNil)(n.content)||(0,i.isString)(n.content)));var n})),Y=t=>t&&B(t.choices),j=(t,n)=>{var e,r,o,s,a,c,l,d,f,p,v,m;try{if(Array.isArray(t)&&t.length>0&&t.every(W))return(0,i.compact)(t.map($));switch(n){case"langchain":const n=null!==(e=(0,u.HD)(t))&&void 0!==e?e:(0,u.oI)(t);if(n)return n;break;case"llamaindex":const i=null!==(r=(0,u.Hy)(t))&&void 0!==r?r:(0,u.W3)(t);if(i)return i;break;case"openai":const y=null!==(o=null!==(s=null!==(a=(0,u.a8)(t))&&void 0!==a?a:(0,u.bS)(t))&&void 0!==s?s:(0,u.n_)(t))&&void 0!==o?o:(0,u.AG)(t);if(y)return y;break;case"dspy":const N=null!==(c=(0,u.iU)(t))&&void 0!==c?c:(0,u.Pn)(t);if(N)return N;break;case"gemini":const h=null!==(l=(0,u.DE)(t))&&void 0!==l?l:(0,u.Sy)(t);if(h)return h;break;case"anthropic":const g=null!==(d=(0,u.KF)(t))&&void 0!==d?d:(0,u.pL)(t);if(g)return g;break;case"openai-agent":const E=null!==(f=(0,u.xW)(t))&&void 0!==f?f:(0,u.m$)(t);if(E)return E;break;case"autogen":const _=null!==(p=(0,u.nW)(t))&&void 0!==p?p:(0,u.u6)(t);if(_)return _;break;case"bedrock":const A=null!==(v=(0,u.Yv)(t))&&void 0!==v?v:(0,u.f1)(t);if(A)return A;break;default:const R=null!==(m=(0,u.a8)(t))&&void 0!==m?m:(0,u.bS)(t);if(R)return R}return null}catch(y){return null}},F=t=>{var n;let e=null===(n=t.function)||void 0===n?void 0:n.arguments;try{e=JSON.stringify(JSON.parse(e),null,2)}catch(r){}return{id:t.id,function:{arguments:e,name:t.function.name}}},V=t=>{if((0,i.isNil)(t)||(0,i.isString)(t))return t;return t.map((t=>{var n;switch(t.type){case"text":case"input_text":case"output_text":return t.text;case"image_url":const e=null===t||void 0===t||null===(n=t.image_url)||void 0===n?void 0:n.url;return e?`![](${e})`:"[image]";case"input_audio":return"[audio]"}})).filter((t=>void 0!==t)).join("\n\n")},$=t=>{var n;return"reasoning"===t.type?null:{...t,content:V(t.content),tool_calls:null===(n=t.tool_calls)||void 0===n?void 0:n.map(F)}},z=t=>{if((0,i.isNil)(t))return"content";if(t.chatMessages)return"chat";return!(0,i.isNil)(t.inputs)||!(0,i.isNil)(t.outputs)?"content":"attributes"},J=t=>{var n,e,r,i;return"MLFLOW_EXPERIMENT"===t.type?null===(n=t.mlflow_experiment)||void 0===n?void 0:n.experiment_id:"INFERENCE_TABLE"===t.type?null===(e=t.inference_table)||void 0===e?void 0:e.full_table_name:"UC_SCHEMA"===t.type?`${null===(r=t.uc_schema)||void 0===r?void 0:r.catalog_name}.${null===(i=t.uc_schema)||void 0===i?void 0:i.schema_name}`:void 0}},94664:function(t,n,e){e.d(n,{Dy:function(){return i},UG:function(){return r},VZ:function(){return o},cC:function(){return s}});let r=function(t){return t.LLM="LLM",t.CHAIN="CHAIN",t.AGENT="AGENT",t.TOOL="TOOL",t.FUNCTION="FUNCTION",t.CHAT_MODEL="CHAT_MODEL",t.RETRIEVER="RETRIEVER",t.PARSER="PARSER",t.EMBEDDING="EMBEDDING",t.RERANKER="RERANKER",t.MEMORY="MEMORY",t.UNKNOWN="UNKNOWN",t}({}),i=function(t){return t.MODELS="models",t.DOCUMENT="document",t.CONNECT="connect",t.SEARCH="search",t.SORT="sort",t.UNKNOWN="unknown",t.FUNCTION="function",t.CODE="code",t.NUMBERS="numbers",t.WRENCH="wrench",t.AGENT="agent",t.CHAIN="chain",t.USER="user",t.SYSTEM="system",t.SAVE="save",t}({}),o=function(t){return t.LLM="LLM",t.CHAIN="CHAIN",t.AGENT="AGENT",t.TOOL="TOOL",t.CHAT_MODEL="CHAT_MODEL",t.RETRIEVER="RETRIEVER",t.PARSER="PARSER",t.EMBEDDING="EMBEDDING",t.RERANKER="RERANKER",t.MEMORY="MEMORY",t.UNKNOWN="UNKNOWN",t}({}),s=function(t){return t.JSON="json",t.TEXT="text",t.MARKDOWN="markdown",t.PYTHON="python",t}({})}}]);