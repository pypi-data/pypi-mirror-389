# Debian Repository Manager Configuration
# Copy this file to /etc/repomanager/config.yaml and adjust settings

# GPG signing configuration
gpg:
  # GPG key ID to use for signing repositories
  key_id: "YOUR_GPG_KEY_ID"

  # Use gpg-agent for passphrase caching (recommended for server)
  use_agent: true

  # Path to gpg binary (optional, auto-detected if not specified)
  # gpg_path: "/usr/bin/gpg"

# Aptly configuration
aptly:
  # Base directory for aptly roots (each codename gets its own subdirectory)
  root_base: "/srv/aptly"

  # Base directory for published repositories (web server document root)
  publish_base: "/srv/repo/public"

  # Path to aptly binary (optional, auto-detected if not specified)
  # aptly_path: "/usr/bin/aptly"

  # Aptly architectures list (can be overridden per repository)
  # architectures:
  #   - amd64
  #   - arm64
  #   - riscv64

# Retention policies for package cleanup
retention:
  # Default policy applied to all components unless overridden
  default:
    # Minimum number of versions to keep (always preserved, regardless of age)
    min_versions: 5

    # Maximum age in days (older packages are removed if more than min_versions exist)
    max_age_days: 90

  # Per-component overrides
  overrides:
    # Example: less aggressive retention for armbian mirrors
    jethome-armbian:
      min_versions: 3
      max_age_days: 60

    # Example: more aggressive retention for debug packages
    # jethome-debug:
    #   min_versions: 2
    #   max_age_days: 30

# Repository configuration
repositories:
  # List of supported codenames (Debian/Ubuntu releases)
  codenames:
    - bookworm    # Debian 12
    - trixie      # Debian 13
    - noble       # Ubuntu 24.04 LTS
    - jammy       # Ubuntu 22.04 LTS

  # List of components (collections)
  components:
    - jethome-tools      # General utilities and tools
    - jethome-armbian    # Armbian support packages
    - jethome-bookworm   # BSP packages for devices (Debian 12)
    - jethome-noble      # BSP packages for devices (Ubuntu 24.04)

  # Supported architectures
  architectures:
    - amd64
    - arm64
    - riscv64

  # Automatically create repository when adding packages to non-existent repo
  auto_create: true

  # Dual format support (both old and new formats work simultaneously)
  # Old format: deb http://repo.jethome.ru bookworm jethome-bookworm
  # New format: deb http://repo.jethome.ru/bookworm jethome-bookworm main
  dual_format:
    # Enable simultaneous support for both formats
    enabled: true

    # Method: symlink (recommended), nginx, dual_publish
    method: "symlink"

    # Automatically create symlinks when publishing
    auto_symlink: true

# Logging configuration
logging:
  # Log level: DEBUG, INFO, WARNING, ERROR
  level: "INFO"

  # Log file path (optional, logs to stdout if not specified)
  # file: "/var/log/repomanager/repomanager.log"

  # Log format
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# Advanced options
advanced:
  # Number of snapshots to keep per component (older snapshots are cleaned up)
  max_snapshots: 10

  # Snapshot naming format (strftime format with component/codename placeholders)
  # %f adds microseconds to prevent duplicate names in rapid succession
  snapshot_format: "{component}-{codename}-%Y%m%d-%H%M%S%f"

  # Parallel operations (currently not implemented, reserved for future)
  # parallel: false

  # Dry-run by default for cleanup operations (safety)
  # cleanup_dry_run_default: true


