# é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ é‡‡ç”¨ src å¸ƒå±€

æœ¬é¡¹ç›®é‡‡ç”¨äº† Python é¡¹ç›®çš„ **src å¸ƒå±€**ï¼ˆsrc layoutï¼‰ï¼Œè¿™æ˜¯ Python ç¤¾åŒºæ¨èçš„æœ€ä½³å®è·µã€‚

### ä¸ºä»€ä¹ˆä½¿ç”¨ src å¸ƒå±€ï¼Ÿ

#### 1. **é¿å…å¯¼å…¥æ··æ·†** ğŸ”’
- é˜²æ­¢æ„å¤–å¯¼å…¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„æ¨¡å—
- ç¡®ä¿æµ‹è¯•ä½¿ç”¨çš„æ˜¯å®‰è£…åçš„åŒ…ï¼Œè€Œä¸æ˜¯æºä»£ç 
- é¿å…"å¯ä»¥æœ¬åœ°è¿è¡Œä½†å®‰è£…åå¤±è´¥"çš„é—®é¢˜

#### 2. **æ¸…æ™°çš„é¡¹ç›®ç»“æ„** ğŸ“
- æºä»£ç ä¸é…ç½®æ–‡ä»¶åˆ†ç¦»
- æ›´ä¸“ä¸šå’Œæ ‡å‡†åŒ–
- æ˜“äºæ‰“åŒ…å’Œåˆ†å‘

#### 3. **æ›´å¥½çš„æµ‹è¯•** âœ…
- æµ‹è¯•çœŸæ­£çš„å®‰è£…åŒ…è¡Œä¸º
- å‘ç°æ‰“åŒ…é—®é¢˜æ›´æ—©
- æ”¯æŒå¯ç¼–è¾‘å®‰è£…ï¼ˆeditable installï¼‰

## ğŸ—‚ï¸ å®Œæ•´ç›®å½•ç»“æ„

```
langchain_agent/
â”‚
â”œâ”€â”€ ğŸ“¦ main.py                          # åº”ç”¨å…¥å£ç‚¹ï¼ˆç®€å•çš„å¯åŠ¨å™¨ï¼‰
â”‚
â”œâ”€â”€ ğŸ“„ src/                              # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py                     # src åŒ…æ ‡è¯†
â”‚   â””â”€â”€ langchain_agent/                # æ ¸å¿ƒåº”ç”¨åŒ…
â”‚       â”œâ”€â”€ __init__.py                 # åŒ…åˆå§‹åŒ–ï¼Œå¯¼å‡ºå…¬å…± API
â”‚       â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºé€»è¾‘å’Œå¾ªç¯
â”‚       â”œâ”€â”€ config.py                   # é…ç½®ç®¡ç†ç±»
â”‚       â”œâ”€â”€ agent.py                    # ChatAgent å°è£…
â”‚       â”œâ”€â”€ tools.py                    # å·¥å…·å‡½æ•°å®šä¹‰
â”‚       â””â”€â”€ utils.py                    # é€šç”¨å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ ğŸ§ª tests/                            # æµ‹è¯•ç›®å½•ï¼ˆä¸ src å¹³è¡Œï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_config.py                  # é…ç½®æµ‹è¯•
â”‚   â””â”€â”€ test_tools.py                   # å·¥å…·æµ‹è¯•
â”‚
â”œâ”€â”€ ğŸ“œ scripts/                          # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ setup.sh                        # é¡¹ç›®è®¾ç½®è„šæœ¬
â”‚   â””â”€â”€ run_tests.sh                    # æµ‹è¯•è¿è¡Œè„šæœ¬
â”‚
â”œâ”€â”€ ğŸ³ éƒ¨ç½²æ–‡ä»¶
â”‚   â”œâ”€â”€ Dockerfile                      # Docker é•œåƒå®šä¹‰
â”‚   â”œâ”€â”€ docker-compose.yml              # Docker ç¼–æ’é…ç½®
â”‚   â””â”€â”€ .env.example                    # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚
â”œâ”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ pyproject.toml                  # é¡¹ç›®å…ƒæ•°æ®å’Œå·¥å…·é…ç½®
â”‚   â”œâ”€â”€ requirements.txt                # ä¾èµ–å£°æ˜
â”‚   â”œâ”€â”€ Makefile                        # å¸¸ç”¨å‘½ä»¤å¿«æ·æ–¹å¼
â”‚   â”œâ”€â”€ .gitignore                      # Git å¿½ç•¥è§„åˆ™
â”‚   â””â”€â”€ .python-version                 # Python ç‰ˆæœ¬å›ºå®š
â”‚
â””â”€â”€ ğŸ“š æ–‡æ¡£
    â”œâ”€â”€ README.md                       # é¡¹ç›®ä¸»æ–‡æ¡£
    â”œâ”€â”€ QUICKSTART.md                   # å¿«é€Ÿå¼€å§‹æŒ‡å—
    â”œâ”€â”€ ARCHITECTURE.md                 # æ¶æ„è®¾è®¡æ–‡æ¡£
    â”œâ”€â”€ CONTRIBUTING.md                 # è´¡çŒ®æŒ‡å—
    â”œâ”€â”€ CHANGELOG.md                    # ç‰ˆæœ¬æ›´æ–°æ—¥å¿—
    â”œâ”€â”€ PROJECT_SUMMARY.md              # é¡¹ç›®æ€»ç»“
    â”œâ”€â”€ STRUCTURE.md                    # æœ¬æ–‡ä»¶
    â”œâ”€â”€ REFACTORING_COMPLETE.md         # é‡æ„å®ŒæˆæŠ¥å‘Š
    â””â”€â”€ LICENSE                         # MIT è®¸å¯è¯
```

## ğŸ“¦ åŒ…ç»“æ„è¯¦è§£

### src/langchain_agent/

è¿™æ˜¯æ ¸å¿ƒåº”ç”¨åŒ…ï¼ŒåŒ…å«æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ã€‚

#### \_\_init\_\_.py
```python
# å®šä¹‰å…¬å…± API
from .agent import ChatAgent
from .config import AppConfig, LLMConfig, AgentConfig
from .tools import get_all_tools, get_current_time

__all__ = [
    "ChatAgent",
    "AppConfig",
    "LLMConfig", 
    "AgentConfig",
    "get_all_tools",
    "get_current_time",
]
```

**ä½œç”¨ï¼š**
- å®šä¹‰åŒ…çš„å…¬å…±æ¥å£
- ç®€åŒ–å¤–éƒ¨å¯¼å…¥
- ç‰ˆæœ¬ä¿¡æ¯å£°æ˜

#### main.py
ä¸»ç¨‹åºé€»è¾‘ï¼ŒåŒ…å«ï¼š
- `run_chat_loop()` - èŠå¤©ä¸»å¾ªç¯
- `main()` - åº”ç”¨å…¥å£å‡½æ•°

#### config.py
é…ç½®ç®¡ç†ï¼ŒåŒ…å«ï¼š
- `LLMConfig` - LLM é…ç½®ç±»
- `AgentConfig` - Agent é…ç½®ç±»
- `AppConfig` - åº”ç”¨æ€»é…ç½®ç±»

#### agent.py
Agent å°è£…ï¼ŒåŒ…å«ï¼š
- `ChatAgent` - èŠå¤©ä»£ç†å°è£…ç±»

#### tools.py
å·¥å…·å®šä¹‰ï¼ŒåŒ…å«ï¼š
- `get_current_time()` - æ—¶åŒºæŸ¥è¯¢å·¥å…·
- `get_all_tools()` - å·¥å…·æ³¨å†Œå‡½æ•°

#### utils.py
é€šç”¨å·¥å…·ï¼ŒåŒ…å«ï¼š
- `setup_logging()` - æ—¥å¿—é…ç½®
- `print_welcome()` - æ¬¢è¿ä¿¡æ¯
- `print_help()` - å¸®åŠ©ä¿¡æ¯
- `clear_screen()` - æ¸…å±

## ğŸ”— å¯¼å…¥è·¯å¾„

### ä»é¡¹ç›®å†…éƒ¨å¯¼å…¥ï¼ˆç›¸å¯¹å¯¼å…¥ï¼‰

åœ¨ `src/langchain_agent/` å†…çš„æ¨¡å—ä¹‹é—´ï¼š

```python
# agent.py å¯¼å…¥åŒåŒ…å†…çš„æ¨¡å—
from .config import AppConfig
from .tools import get_all_tools
```

### ä»å¤–éƒ¨å¯¼å…¥ï¼ˆç»å¯¹å¯¼å…¥ï¼‰

åœ¨æµ‹è¯•æˆ–å…¶ä»–åœ°æ–¹å¯¼å…¥åŒ…ï¼š

```python
# tests/test_tools.py
from src.langchain_agent.tools import get_current_time

# æˆ–ä½¿ç”¨åŒ…çš„å…¬å…± API
from src.langchain_agent import get_current_time
```

### åº”ç”¨å…¥å£

é¡¶å±‚ `main.py` ä½œä¸ºå¯åŠ¨å™¨ï¼š

```python
from src.langchain_agent.main import main

if __name__ == "__main__":
    main()
```

## ğŸ¯ è®¾è®¡ä¼˜åŠ¿

### 1. æ¨¡å—éš”ç¦» ğŸ”
```
âœ… å¥½çš„è®¾è®¡ï¼š
src/langchain_agent/config.py  # æ¸…æ™°çš„åŒ…ç»“æ„
src/langchain_agent/agent.py

âŒ æ‰å¹³è®¾è®¡ï¼š
config.py                       # å®¹æ˜“æ··ä¹±
agent.py
```

### 2. æµ‹è¯•å¯é æ€§ âœ…
```
âœ… src å¸ƒå±€ï¼š
æµ‹è¯•å¯¼å…¥ src.langchain_agent â†’ æµ‹è¯•çœŸå®å®‰è£…è¡Œä¸º

âŒ æ‰å¹³å¸ƒå±€ï¼š
æµ‹è¯•å¯èƒ½ç›´æ¥å¯¼å…¥æºæ–‡ä»¶ â†’ æ— æ³•å‘ç°æ‰“åŒ…é—®é¢˜
```

### 3. æ‰“åŒ…å‹å¥½ ğŸ“¦
```python
# pyproject.toml
[project]
# src å¸ƒå±€è‡ªåŠ¨è¢«è¯†åˆ«
# æ‰“åŒ…å·¥å…·çŸ¥é“ä»å“ªé‡Œæ‰¾æºä»£ç 
```

### 4. å‘½åç©ºé—´æ¸…æ™° ğŸ·ï¸
```python
# æ¸…æ™°çš„å¯¼å…¥è¯­å¥
from src.langchain_agent import ChatAgent
from src.langchain_agent.config import AppConfig

# é¿å…æ··æ·†
import config  # æ˜¯å“ªä¸ª configï¼Ÿ
```

## ğŸ”§ å¼€å‘å·¥ä½œæµ

### å®‰è£…å¼€å‘æ¨¡å¼
```bash
# å¯ç¼–è¾‘å®‰è£…ï¼ˆæ¨èï¼‰
pip install -e .

# ç°åœ¨å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å¯¼å…¥
python -c "from src.langchain_agent import ChatAgent"
```

### è¿è¡Œåº”ç”¨
```bash
# æ–¹å¼ 1ï¼šç›´æ¥è¿è¡Œå…¥å£æ–‡ä»¶
python main.py

# æ–¹å¼ 2ï¼šä½¿ç”¨ Make
make run

# æ–¹å¼ 3ï¼šä½œä¸ºæ¨¡å—è¿è¡Œ
python -m src.langchain_agent.main
```

### è¿è¡Œæµ‹è¯•
```bash
# pytest ä¼šè‡ªåŠ¨æ‰¾åˆ° tests/
pytest

# æˆ–ä½¿ç”¨ Make
make test
```

## ğŸ“Š ä¸æ‰å¹³ç»“æ„å¯¹æ¯”

| æ–¹é¢ | æ‰å¹³ç»“æ„ | src å¸ƒå±€ |
|------|---------|---------|
| ç›®å½•å±‚æ¬¡ | 1 å±‚ | 2-3 å±‚ |
| å‘½åç©ºé—´ | æ··ä¹± | æ¸…æ™° |
| æ‰“åŒ… | å®¹æ˜“å‡ºé”™ | å¯é  |
| æµ‹è¯• | å¯èƒ½è¯¯å¯¼ | çœŸå® |
| ä¸“ä¸šåº¦ | ä¸šä½™ | ä¸“ä¸š |
| æ¨èåº¦ | âŒ | âœ… |

## ğŸ“ æœ€ä½³å®è·µ

### âœ… æ¨è

1. **ä½¿ç”¨ç›¸å¯¹å¯¼å…¥** - åœ¨åŒ…å†…éƒ¨
2. **å¯¼å‡ºå…¬å…± API** - åœ¨ `__init__.py` ä¸­
3. **æµ‹è¯•ä½¿ç”¨ç»å¯¹å¯¼å…¥** - æµ‹è¯•çœŸå®å®‰è£…
4. **ä¿æŒ src/ çº¯å‡€** - åªæ”¾æºä»£ç 
5. **æ–‡æ¡£åœ¨æ ¹ç›®å½•** - æ˜“äºè®¿é—®

### âŒ é¿å…

1. **ä¸è¦åœ¨ src/ æ”¾é…ç½®æ–‡ä»¶**
2. **ä¸è¦åœ¨åŒ…å¤–ä½¿ç”¨ç›¸å¯¹å¯¼å…¥**
3. **ä¸è¦æ··åˆå¯¼å…¥é£æ ¼**
4. **ä¸è¦è·³è¿‡ `__init__.py`**

## ğŸ“š å‚è€ƒèµ„æº

- [Python Packaging User Guide - src layout](https://packaging.python.org/en/latest/discussions/src-layout-vs-flat-layout/)
- [pytest æ–‡æ¡£ - src layout](https://docs.pytest.org/en/latest/explanation/goodpractices.html#tests-outside-application-code)
- [setuptools æ–‡æ¡£ - package discovery](https://setuptools.pypa.io/en/latest/userguide/package_discovery.html)

## ğŸ‰ æ€»ç»“

é‡‡ç”¨ **src å¸ƒå±€**ä½¿é¡¹ç›®ï¼š

- ğŸ—ï¸ **ç»“æ„æ›´æ¸…æ™°** - æºä»£ç ä¸é…ç½®åˆ†ç¦»
- ğŸ”’ **æ›´åŠ å¯é ** - é¿å…å¯¼å…¥é™·é˜±
- ğŸ“¦ **æ‰“åŒ…å‹å¥½** - ç¬¦åˆæ ‡å‡†
- âœ… **æµ‹è¯•çœŸå®** - æµ‹è¯•å®é™…å®‰è£…è¡Œä¸º
- ğŸ“ **æ›´ä¸“ä¸š** - ç¬¦åˆç¤¾åŒºæœ€ä½³å®è·µ

è¿™æ˜¯ä¸€ä¸ª**ç”Ÿäº§å°±ç»ª**çš„é¡¹ç›®ç»“æ„ï¼

