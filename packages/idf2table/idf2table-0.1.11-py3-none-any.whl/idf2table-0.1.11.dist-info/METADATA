Metadata-Version: 2.4
Name: idf2table
Version: 0.1.11
Summary: Convertir des fichiers EnergyPlus IDF en DataFrames pandas
Project-URL: Homepage, https://gitlab.plateforme-tipee.com/idf/idf2table
Project-URL: Documentation, https://gitlab.plateforme-tipee.com/idf/idf2table/-/blob/main/README.md
Project-URL: Repository, https://gitlab.plateforme-tipee.com/idf/idf2table.git
Project-URL: Issues, https://gitlab.plateforme-tipee.com/idf/idf2table/-/issues
Author-email: TIPEE <contact@plateforme-tipee.com>
License: MIT
Keywords: building,dataframe,energyplus,eppy,idf,pandas,simulation
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Scientific/Engineering
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.12
Requires-Dist: openpyxl>=3.1.5
Requires-Dist: pandas>=2.3.3
Description-Content-Type: text/markdown

# IDF2TABLE

**Convertir des fichiers EnergyPlus IDF en DataFrames pandas**

IDF2TABLE est un outil Python qui permet de convertir les objets issus de fichiers EnergyPlus IDF (Input Data File) en DataFrames pandas. Chaque ligne du DataFrame repr√©sente un objet IDF et chaque colonne repr√©sente un attribut de cet objet.

## ‚ú® Fonctionnalit√©s

- üîÑ Conversion automatique des objets IDF en DataFrames pandas
- üìä Support de tous les types d'objets EnergyPlus (Material, Zone, Construction, etc.)
- üîç D√©tection automatique du fichier IDD EnergyPlus
- üíæ Export des r√©sultats en fichiers Excel
- üéØ Interface simple et intuitive

## üìã Pr√©requis

- **Python** >= 3.12
- **EnergyPlus** (pour le fichier IDD)
- Les autres d√©pendances sont install√©es automatiquement

## üöÄ Installation

## üì¶ D√©pendances

- **eppy** >= 0.5.66 : Manipulation des fichiers IDF EnergyPlus
- **pandas** >= 2.3.3 : Manipulation de DataFrames
- **openpyxl** >= 3.1.5 : Export Excel (inclus)

## üì¶ Installation depuis PyPI

Une fois publi√© sur PyPI, vous pourrez installer le package avec :

```bash
# Installation avec uv
uv venv venv --python 3.12
source venv/bin/activate
uv pip install git+https://github.com/santoshphilip/eppy.git
uv pip install idf2table
```


### Installation depuis GitLab (recommand√©)

Pour installer directement depuis le d√©p√¥t GitLab :

```bash
# Avec pip
pip install git+https://gitlab.plateforme-tipee.com/idf/idf2table.git

# Avec uv
uv pip install git+https://gitlab.plateforme-tipee.com/idf/idf2table.git
```

**Note :** Si le d√©p√¥t est priv√©, vous devrez peut-√™tre vous authentifier :
- Utiliser un [token d'acc√®s GitLab](https://gitlab.plateforme-tipee.com/-/user_settings/personal_access_tokens)
- Ou utiliser : `pip install git+https://<username>:<token>@gitlab.plateforme-tipee.com/idf/idf2table.git`

### Installation locale (mode d√©veloppement)

Pour contribuer au projet ou utiliser le code local :

**Mode d√©veloppement (depuis le r√©pertoire du projet) :**

```bash
# Cloner le d√©p√¥t
git clone https://gitlab.plateforme-tipee.com/idf/idf2table.git
cd idf2table

# Installer en mode √©ditable avec uv
uv sync
# Le module est install√© en mode √©ditable
```

**Installation en tant que package local :**

```bash
# Avec uv
uv pip install -e .

# Avec pip
pip install -e .
```

### D√©pendances

Les d√©pendances suivantes seront install√©es automatiquement :
- `eppy >= 0.5.66` : Manipulation des fichiers IDF
- `pandas >= 2.3.3` : DataFrames
- `openpyxl >= 3.1.5` : Export Excel (inclus)

## ‚öôÔ∏è Configuration du fichier IDD

Le fichier IDD (Input Data Dictionary) est n√©cessaire pour interpr√©ter les fichiers IDF. IDF2TABLE le cherche automatiquement dans cet ordre :

1. Variable d'environnement `ENERGYPLUS_IDD`
2. Emplacements standards selon le syst√®me d'exploitation :
   - **Windows** : `C:\EnergyPlusV9-4-0\Energy+.idd` ou `C:\Program Files\EnergyPlusV9-4-0\Energy+.idd`
   - **macOS** : `/Applications/EnergyPlus-9-4-0/Energy+.idd`
   - **Linux** : `./EnergyPlus-9.4.0-998c4b761e-Linux-Ubuntu18.04-x86_64/Energy+.idd`

### D√©finir manuellement le chemin IDD

```bash
export ENERGYPLUS_IDD=/chemin/vers/Energy+.idd
```

## üìñ Utilisation

### En tant que module Python

```python
from idf2table import idf_to_table, find_idd
from eppy.modeleditor import IDF

# Configurer le fichier IDD
idd_path = find_idd()
IDF.setiddname(str(idd_path))

# Charger le fichier IDF
idf = IDF('data/OPIO_run.idf')

# Convertir les objets Material en DataFrame
materials_df = idf_to_table(idf, "Material")

print(materials_df.head())
```

### Utilisation simplifi√©e (chemin de fichier direct)

```python
from idf2table import idf_to_table

# Le fichier IDD sera trouv√© automatiquement
materials_df = idf_to_table('data/OPIO_run.idf', "Material")
```

### En ligne de commande (CLI)
# Exporter la g√©om√©trie IDF en Wavefront OBJ

```bash
# Export des BuildingSurface:Detailed
idf2table export-obj data/OPIO_run.idf --obj out/model.obj

# Inclure fen√™tres/portes et ombrages, g√©n√©rer un MTL et inverser les normales
idf2table export-obj data/OPIO_run.idf --obj out/model.obj \
  --with-fenestration --with-shading --mtl out/model.mtl --flip-normals
```

### API d'export OBJ

```python
from idf2table.obj_export import export_idf_to_obj, ObjExportOptions

opts = ObjExportOptions(include_fenestration=True, include_shading=True, write_mtl=True, mtl_path="out/model.mtl")
export_idf_to_obj("data/OPIO_run.idf", "out/model.obj", options=opts)
```

Une fois le module install√©, vous disposez d'une commande `idf2table` avec des sous-commandes :

```bash
# Afficher l'aide g√©n√©rale
idf2table --help

# 1) Convertir un type d'objet en DataFrame (sous-commande: table)
idf2table table data/OPIO_run.idf Material

# Exporter en Excel
idf2table table data/OPIO_run.idf Material --output materials.xlsx

# Exporter en CSV
idf2table table data/OPIO_run.idf Material --csv

# Sp√©cifier un fichier IDD personnalis√©
idf2table table data/OPIO_run.idf Material --idd /path/to/Energy+.idd

# 2) Appliquer des mises √† jour depuis un Excel/CSV (sous-commande: apply)
idf2table apply data/OPIO_run.idf --excel updates.xlsx --save data/OPIO_run_updated.idf

# Utiliser une feuille nomm√©e
idf2table apply data/OPIO_run.idf --excel updates.xlsx --sheet MA_FEUILLE --save out.idf

# Exemple avec CSV
idf2table apply data/OPIO_run.idf --excel updates.csv --save out.idf
```

### Exemples de types d'objets

```python
from idf2table import idf_to_table

# Avec un objet IDF d√©j√† charg√©
from eppy.modeleditor import IDF
from idf2table import find_idd

idd_path = find_idd()
IDF.setiddname(str(idd_path))
idf = IDF('data/OPIO_run.idf')

# Mat√©riaux
materials_df = idf_to_table(idf, "Material")

# Zones
zones_df = idf_to_table(idf, "Zone")

# Surfaces de b√¢timent
surfaces_df = idf_to_table(idf, "BuildingSurface:Detailed")

# Constructions
constructions_df = idf_to_table(idf, "Construction")

# Propri√©t√©s HAMT (Heat And Moisture Transfer)
hamt_df = idf_to_table(idf, "MaterialProperty:HeatAndMoistureTransfer:SorptionIsotherm")
```

### Lister tous les types d'objets disponibles

```python
from idf2table import find_idd
from eppy.modeleditor import IDF

idd_path = find_idd()
IDF.setiddname(str(idd_path))
idf = IDF('data/OPIO_run.idf')

# Afficher tous les types d'objets disponibles
print(list(idf.idfobjects.keys()))
```

### Export en Excel

**Avec pandas :**

```python
from idf2table import idf_to_table

materials_df = idf_to_table('data/OPIO_run.idf', "Material")
materials_df.to_excel('materials.xlsx', index=False)
```

**Ou avec la CLI :**

```bash
idf2table data/OPIO_run.idf Material --output materials.xlsx
```

## üìö API
### Mise √† jour IDF depuis Excel/CSV

#### Format attendu (tableau ¬´ large ¬ª export√© par `idf_to_table`)

- Colonnes obligatoires: `key`, `Name`
- Toutes les autres colonnes sont interpr√©t√©es comme des champs √† mettre √† jour

Exemple minimal:

| key      | Name                     | Conductivity | Density |
|----------|--------------------------|--------------|---------|
| Material | MyMaterial               | 0.038        | 50      |
| Material | AnotherMaterial          | 0.040        | 25      |

Notes:
- La colonne `key` correspond au type d‚Äôobjet (ex: `Material`, `Construction`)
- La colonne `Name` correspond au nom d‚Äôobjet IDF
- Les fichiers `.csv` sont √©galement accept√©s

Note: les fichiers `.csv` sont √©galement accept√©s (m√™mes colonnes).

#### API Python

```python
from idf2table import find_idd
from idf2table.core import apply_updates_from_excel
from eppy.modeleditor import IDF

idd = find_idd(); IDF.setiddname(str(idd))
idf = IDF('data/OPIO_run.idf')

# Appliquer les updates depuis Excel
idf = apply_updates_from_excel(idf, 'updates.xlsx', save_to='data/OPIO_run_updated.idf')
```

### `idf_to_table(idf, object_type, idd_file=None)`

Convertit tous les objets d'un type donn√© en DataFrame pandas.

**Param√®tres :**

| Param√®tre | Type | Description |
|-----------|------|-------------|
| `idf` | `IDF` ou `str` | Objet IDF ou chemin vers le fichier `.idf` |
| `object_type` | `str` | Type d'objet √† convertir (ex: `"Material"`, `"Zone"`) |
| `idd_file` | `str`, optionnel | Chemin vers le fichier IDD. Si non fourni, recherche automatique |

**Retourne :**

- `pd.DataFrame` : DataFrame o√π chaque ligne = un objet, chaque colonne = un attribut

**Exemple de r√©sultat :**

```
   key              Name Roughness  Thickness  Conductivity  Density  Specific_Heat  ...
0  Material  MATERIAL_1     Rough        0.1         0.038     50.0         1540.0  ...
1  Material  MATERIAL_2     Rough       0.12           2.0   2400.0          880.0  ...
```

### `find_idd()`

Trouve automatiquement le fichier IDD EnergyPlus.

**Retourne :**

- `Path` : Chemin vers le fichier IDD trouv√©

**L√®ve :**

- `FileNotFoundError` : Si aucun fichier IDD n'est trouv√©

**Exemple :**

```python
from main import find_idd

try:
    idd_path = find_idd()
    print(f"IDD trouv√© : {idd_path}")
except FileNotFoundError as e:
    print(f"Erreur : {e}")
```

### Interface en ligne de commande

Apr√®s installation, utilisez la commande `idf2table` :

```bash
idf2table <idf_file> <object_type> [options]
```

**Options :**

| Option | Description |
|--------|-------------|
| `--idd IDD` | Chemin vers le fichier IDD (optionnel) |
| `--output OUTPUT, -o OUTPUT` | Chemin de sortie pour le fichier Excel (optionnel) |
| `--csv` | Sauvegarder en CSV au lieu d'Excel |

**Exemples :**

```bash
# Affichage simple
idf2table data/OPIO_run.idf Material

# Avec sauvegarde Excel
idf2table data/OPIO_run.idf Material --output materials.xlsx

# Sauvegarde en CSV
idf2table data/OPIO_run.idf Material --csv
```

## üí° Exemples complets

### Exemple 1 : Analyse des mat√©riaux

```python
from idf2table import idf_to_table, find_idd
from eppy.modeleditor import IDF
import pandas as pd

# Configuration
idd_path = find_idd()
IDF.setiddname(str(idd_path))
idf = IDF('data/OPIO_run.idf')

# Conversion
materials_df = idf_to_table(idf, "Material")

# Analyse
print(f"Nombre de mat√©riaux : {len(materials_df)}")
print(f"\nColonnes disponibles : {list(materials_df.columns)}")
print("\nMat√©riaux les plus isolants (faible conductivit√©) :")
print(materials_df.nsmallest(5, 'Conductivity')[['Name', 'Conductivity', 'Thickness']])
```

### Exemple 2 : Export multiple

```python
from idf2table import idf_to_table, find_idd
from eppy.modeleditor import IDF

# Configuration
idd_path = find_idd()
IDF.setiddname(str(idd_path))
idf = IDF('data/OPIO_run.idf')

# Convertir plusieurs types d'objets
object_types = ["Material", "Construction", "Zone"]

for obj_type in object_types:
    df = idf_to_table(idf, obj_type)
    df.to_excel(f"export_{obj_type}.xlsx", index=False)
    print(f"‚úì {obj_type} : {len(df)} objets export√©s")
```

### Exemple 3 : Utilisation en ligne de commande

```bash
# Convertir Material
idf2table data/OPIO_run.idf Material

# Convertir plusieurs types d'objets
for obj_type in Material Construction Zone; do
    idf2table data/OPIO_run.idf $obj_type --output ${obj_type}.xlsx
done
```

## üóÇÔ∏è Structure du projet

```
IDF2TABLE/
‚îú‚îÄ‚îÄ idf2table/               # Module principal
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py          # Exports publics du module
‚îÇ   ‚îú‚îÄ‚îÄ core.py              # Fonctions principales (idf_to_table, find_idd)
‚îÇ   ‚îî‚îÄ‚îÄ cli.py               # Interface en ligne de commande
‚îú‚îÄ‚îÄ main.py                  # Script d'exemple
‚îú‚îÄ‚îÄ data/                    # Fichiers IDF
‚îÇ   ‚îú‚îÄ‚îÄ OPIO_run.idf
‚îÇ   ‚îî‚îÄ‚îÄ OPIO_run_hamt.idf
‚îú‚îÄ‚îÄ pyproject.toml           # Configuration du projet
‚îú‚îÄ‚îÄ uv.lock                  # Lock file des d√©pendances
‚îî‚îÄ‚îÄ README.md                # Documentation
```

## üì¶ D√©pendances

- **eppy** >= 0.5.66 : Manipulation des fichiers IDF EnergyPlus
- **pandas** >= 2.3.3 : Manipulation de DataFrames
- **openpyxl** >= 3.1.5 : Export Excel (inclus)

## üì¶ Installation depuis PyPI

Une fois publi√© sur PyPI, vous pourrez installer le package avec :

```bash
# Installation standard
pip install idf2table

# Ou avec uv
uv pip install idf2table
```

### Publier sur PyPI

Pour publier votre package sur PyPI, suivez les instructions d√©taill√©es dans [DEPLOYMENT.md](DEPLOYMENT.md).

**R√©sum√© rapide :**

```bash
# 1. Installer les outils
uv add --dev build twine

# 2. Construire le package
uv run python -m build

# 3. V√©rifier le package
uv run twine check dist/*

# 4. Publier sur TestPyPI (recommand√© d'abord)
uv run twine upload --repository testpypi dist/*

# 5. Publier sur PyPI
uv run twine upload dist/*
```

Vous aurez besoin d'un token API PyPI : [https://pypi.org/manage/account/](https://pypi.org/manage/account/)

## ‚ö†Ô∏è Notes importantes

- ‚úÖ Le type d'objet peut √™tre sp√©cifi√© en **minuscules, majuscules ou casse mixte** (ex: `"Material"`, `"MATERIAL"`, `"material"`)
- ‚ùå Si aucun objet du type sp√©cifi√© n'est trouv√©, une `ValueError` est lev√©e avec la liste des types disponibles
- üìã Si aucun objet n'est trouv√© (liste vide), un DataFrame vide est retourn√©
- üßπ Les valeurs de type string sont automatiquement nettoy√©es (espaces supprim√©s)
- üìù Le DataFrame inclut toujours une colonne `key` indiquant le type d'objet

## ü§ù Contribution

Les contributions sont les bienvenues ! N'h√©sitez pas √† ouvrir une issue ou une pull request.

## üìÑ Licence

[√Ä compl√©ter selon vos besoins]
