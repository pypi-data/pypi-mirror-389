{% filter indent(width=4, first=False) %}
{% include "./_mem_offset.jinja" %}
export_cpp::fullyconnected{{ "_" ~ kernel if kernel != "" else "" }}_forward<{{ in_name[0]|upper }}_NB_CHANNELS,
                          {{ in_name[0]|upper }}_IN_HEIGHT,
                          {{ in_name[0]|upper }}_IN_WIDTH,
                          {{ out_name[0]|upper }}_NB_OUTPUTS,
                          {{ out_name[0]|upper }}_OUT_HEIGHT,
                          {{ out_name[0]|upper }}_OUT_WIDTH,
                          {{name|upper}}_ACTIVATION,
                          {{ in_name[0]|upper }}_MEM_CONT_OFFSET,
                          {{ in_name[0]|upper }}_MEM_CONT_SIZE,
                          {{ in_name[0]|upper }}_MEM_WRAP_OFFSET,
                          {{ in_name[0]|upper }}_MEM_WRAP_SIZE,
                          {{ in_name[0]|upper }}_MEM_STRIDE,
                          {{ out_name[0]|upper }}_MEM_CONT_OFFSET,
                          {{ out_name[0]|upper }}_MEM_CONT_SIZE,
                          {{ out_name[0]|upper }}_MEM_WRAP_OFFSET,
                          {{ out_name[0]|upper }}_MEM_WRAP_SIZE,
                          {{ out_name[0]|upper }}_MEM_STRIDE>
                          ({{in_name[0]}}, {{out_name[0]}}, {{in_name[1]}}, {{ in_name[2] | default("(%s *) nullptr"|format(bias_default_type), true) }}, {{name|upper}}_RESCALING);
{% include "./_save_outputs.jinja" %}
{% include "./_aidge_cmp.jinja" %}
{% endfilter %}
