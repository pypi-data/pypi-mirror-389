{% extends "fastdaisy_admin/layout.html" %}
{% from 'fastdaisy_admin/_macros.html' import render_form_fields %}

{% block head %}
<title>{{ admin.title }} - Edit</title>
{% endblock %}

{% block breadcrumbs %}
        <div class="flex items-center max-md:p-3 p-5 pb-0 flex-wrap justify-between">
        <div class="text-sm max-md:hidden breadcrumbs">
        <ul>
                <li><a href="{{ url_for('admin:index') }}" class="link link-hover">Dashboard</a></li>
                <li><a href="{{ url_for('admin:list',identity=model_view.identity) }}"class="link link-hover">{{model_view.name}}</a></li>
                <li>{{ model|string | truncate(40) }}</li>
            </ul>
        </div>
        </div>
{% endblock %}


{% block container %}
<div id="content-main" class="border-base-200 mt-3">
  <form action="{{ model_view._build_url_for('admin:edit', request, model) }}" method="POST"
        enctype="multipart/form-data"
        class="w-full h-full">
    <div class="grid grid-cols-1">
      <div class="w-full">
        {% if error %}
        <div role="alert" class="alert alert-error mb-5 rounded text-base-content">
          <i class="fa fa-exclamation"></i>
          <span>{{ error }}</span>
        </div>
        {% endif %}
          <div role="tablist" class="w-full  items-start tabs overflow-visible tabs-lift">
            <a class="indicator tab tab-active">
              {{  model_view.name }}
              <i class="text-base-info opacity-50 fa mx-1 {{model_view.icon}} p-1 rounded"></i>
            </a>
            <div role="tabpanel" class="tab-content">
              <fieldset class="mb-3  ltr:!rounded-tl-none rtl:!rounded-tr-none collapse w-full collapse-arrow overflow-visible fieldset card bg-base-100 p-1">
                <input type="checkbox"  name="fieldsets-1" checked />
                <div class="collapse-title text-xl font-medium">
                  {{  model_view.name }}
                </div>
                
                <div class="mb-3 collapse-content w-full max-w-screen-lg">
                    <fieldset class="module aligned mb-4 overflow-visible">
                        <input type="hidden" name="_form_type" value="changed">
                        {{ render_form_fields(form, model_view, form_opts=form_opts) }}
                    </fieldset>
                </div>
              </fieldset>
            </div>
          </div>
      </div>
      
      <div class="w-full z-20 border-t border-base-300  sticky max-lg:fixed max-lg:-mx-3 bottom-0 mb-1 ">
        <div class="p-3 bg-base-100 justify-between flex flex-row-reverse gap-15 sticky top-3 max-md:hidden">
          
          {% if not model_view.only_view %}
          <div class="text-start flex  gap-2">
            <button type="submit" class="btn-sm btn-primary px-4 primary-content text-base-300  btn rounded-md" name="_save">
                Save
                <i class="fas fa-save px-1"></i>
            </button>
            <button class="btn-sm bg-blue-300 text-base-300 btn rounded-md" type="submit"
                    name="_continue">
                Save and continue editing
                <i class="fas fa-sync"></i>
            </button>

            {% if model_view.can_create %}
              {% if model_view.save_as %}
                <button class="btn-sm  bg-blue-300 text-base-300 rounded-md btn" type="submit"
                    name="_saveasnew">
                Save as new
                <i class="fas fa-plus-circle"></i>
                </button>
              {% else %}
              <button class="btn-sm  bg-blue-300 text-base-300 rounded-md btn" type="submit"
                    name="_addanother">
                Save and add another
                <i class="fas fa-plus-circle"></i>
                </button>
              {% endif %}
            {% endif %}

          </div>
          {% if model_view.can_delete %}
            <div class="text-end">
              <a href="{{ model_view._build_url_for('admin:delete',request, model) }}"
                class="btn-sm btn-block btn-error error-content btn rounded-md place-self-end b-delete">
                Delete
                <i class="fa fa-xmark"></i>
              </a>
            </div>
          {% endif %}
          {% else %}
          <div class="text-end">
                <a href="{{ url_for('admin:list',identity=model_view.identity) }}"
                  class="btn-sm btn-block mt-1 btn rounded-md btn-info">Close</a>
              </div>
          {% endif %}
        </div>
        
        <div class="p-3 card bg-base-100 hidden {% if not model_view.only_view%} grid-cols-2 {%endif%}max-md:grid gap-3 border !shadow-lg">
          {% if not model_view.only_view %}
            <div class="dropdown dropdown-top w-full">
                <div tabindex="0" role="button" class="btn btn-sm btn-block">Options</div>
                <div tabindex="0"
                  class="dropdown-content min-w-full w-max menu bg-base-100 rounded-box z-[1] mb-1 border p-2 shadow">

              <button type="submit" class="btn-sm btn-primary px-4 primary-content text-base-300  btn rounded-md" name="_save">
                Save
                <i class="fas fa-save px-1"></i>
              </button>
              <button class="btn-sm bg-blue-300 text-base-300 btn rounded-md" type="submit"
                      name="_continue">
                  Save and continue editing
                  <i class="fas fa-sync"></i>
              </button>

              {% if model_view.can_create %}
              {% if model_view.save_as %}
                <button class="btn-sm  bg-blue-300 text-base-300 rounded-md btn" type="submit"
                    name="_saveasnew">
                Save as new
                <i class="fas fa-plus-circle"></i>
                </button>
              {% else %}
              <button class="btn-sm  bg-blue-300 text-base-300 rounded-md btn" type="submit"
                    name="_addanother">
                Save and add another
                <i class="fas fa-plus-circle"></i>
                </button>
              {% endif %}
              {% endif %}

              {% if model_view.can_delete %}
              <a href="{{ model_view._build_url_for('admin:delete',request, model) }}"
              class="btn-sm btn-block btn-error error-content btn rounded-md place-self-end b-delete" >
              Delete
              <i class="fa fa-xmark"></i>
              </a>
              {% endif %}
                </div>
            </div>
            <button type="submit" class="btn-sm btn-primary px-4 primary-content text-base-300  btn rounded-md" name="_save">
                Save
                <i class="fas fa-save px-1"></i>
            </button>

          {% else %}
            <a href="{{ url_for('admin:list',identity=model_view.identity) }}"
              class="btn-sm btn-info btn-wide btn rounded-md">
                  Close
              </a>
          {% endif %}
        </div>
      </div>

    </div>

  </form>

{% endblock %}