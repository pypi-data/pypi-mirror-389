[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.version]
path = "src/saigon/__init__.py"

[project]
name = "saigon-py"
dynamic = ["version"]
authors = [
  { name="abastidian@gmail.com" },
]
description = "Common components to build cloud backends"
readme = "README.md"
requires-python = ">=3.13"
dependencies = [
    "python_json_logger~=3.2.1",
    "pydantic~=2.11.7",
    "requests~=2.32.5",
    "httpx~=0.28.1",
]
classifiers = [
    "Programming Language :: Python :: 3"
]

[project.optional-dependencies]
aws = [
    "boto3~=1.35.97",
    "aws_lambda_typing~=2.20.0",
    "mypy-boto3-s3~=1.35.93",
    "mypy-boto3-sqs~=1.35.93",
    "mypy_boto3_secretsmanager~=1.35.93",
    "mypy_boto3_cognito_idp~=1.35.93",
    "mypy_boto3_cognito_identity~=1.35.93",
    "mypy-boto3-ssm~=1.35.93",
    "pyjwt~=2.10.1",
]
orm = [
    "sqlalchemy~=2.0.37",
]
fastapi = [
    "fastapi~=0.115.6"
]
backend = [
    "saigon-py[orm,fastapi]"
]
extras = [
    "paramiko~=3.5.1"
]
dev = [
    "pytest~=8.4.2",
    "pytest_asyncio~=1.2.0",
    "python-dotenv~=1.0.1",
    "flake8~=7.1.1",
    "httpx~=0.28.1",
    "shellody~=0.14",
    "prompt_toolkit~=3.0.51",
    "hatch~=1.15.1",
    "twine==6.1.0"
]
docs = [
    "sphinx~=8.2.3",
    "sphinx_rtd_theme~=3.0.2",
    "sphinx_autodoc_typehints~=3.2.0"
]

[tool.hatch.build.targets.sdist]
include = ["src/saigon", "src/saigon_test"]

[tool.hatch.build.targets.wheel]
packages = ["src/saigon", "src/saigon_test"]

[project.scripts]
saigon-lint = "saigon_test.lint:run_flake8"
cognito-cli = "saigon_test.cli.cognito:main"

[project.urls]
"Source Code" = "https://github.com/abastidian/saigon"
"Documentation" = "https://saigon.readthedocs.io/en/latest/"

[tool.hatch.envs.default]
detached=true
skip-install = true
path = ".venv"

[tool.hatch.envs.default.scripts]
lint = "saigon-lint"
docs = "cd test && python -m sphinx -T -b html -d _build/doctrees -D language=en . html"
package = [
    "hatch build"
]
publish = [
    "twine upload --repository pypi dist/saigon_py-`hatch version`*"
]

