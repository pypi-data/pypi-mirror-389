# invenio-rest-api-client (c) 2025
#
# invenio-rest-api-client is licensed under
# Creative Commons Attribution-ShareAlike 4.0 International.
#
# You should have received a copy of the license along with this work.
# If not, see <https://creativecommons.org/licenses/by-sa/4.0/>.

version: '3'

tasks:

  install_prerequisites:
    cmds:
    - npm i -g @redocly/cli@latest
    - pip install openapi-python-client mkdocs-material mkdocs-mermaid2-plugin mkdocs-jupyter legacy-cgi pdocs mkdocs-build-plantuml-plugin

  default:
    deps:
    - install_prerequisites
    cmds:
    - redocly bundle ./docs/openapi/invenio.yaml --output=./docs/openapi/invenio_bundled.yaml
    - redocly build-docs ./docs/openapi/invenio_bundled.yaml --output=./docs/openapi/invenio.html
    - |
      openapi-python-client generate \
      --meta none \
      --path ./docs/openapi/invenio_bundled.yaml \
      --output-path ./invenio_rest_api_client \
      --overwrite
