function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-XxVI3L8o.js","./index-DQ-arKq5.css","./BuilderEmbeddedCodeEditor-Dan2aGsM.js","./BuilderEmbeddedCodeEditor-CXloIist.css","./BuilderSidebarToolkit-Fi_wNWCP.js","./WdsCheckbox-DfRnsKEG.js","./WdsCheckbox-DKvpPA4D.css","./marked.esm-273vDTCT.js","./BuilderSidebarToolkit-Ipk1HoMm.css","./BuilderSidebarComponentTree-DGatnbSK.js","./useComponentDescription-mpf6rqAP.js","./BuilderSidebarComponentTree-C5AMKQcR.css","./BuilderSettings-egdH7dG-.js","./WdsDropdownMenu-D4OKx_Ql.js","./WdsDropdownMenu-BT8vFJ33.css","./useKeyValueEditor-CkOvmnm-.js","./useKeyValueEditor-CsemOh8D.css","./BuilderSettings-DNtzYAFM.css","./ComponentRenderer-BOvg6u7c.js","./ComponentRenderer-72hqvEvI.css","./BuilderInsertionOverlay-Ce_6h3v5.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-Bon1vNFr.js","./BuilderInsertionLabel-_YS5WPfq.css","./BuilderVault-DTLmDx8E.js","./BuilderVault-Cx6oQSES.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as R,i as W,a as z,r as O,u as he,c as w,o as t,f as c,g as u,x as B,y as q,A as j,G,R as v,S as $,_ as V,T as xe,U as Ee,V as we,X as It,Y as Ae,w as J,q as re,Z as Pt,$ as vt,a0 as ft,b as P,a1 as mt,D as K,s as ye,v as De,t as U,m as pe,a2 as _t,z as N,a3 as Pe,a4 as At,a5 as ht,a6 as Dt,a7 as yt,W as Q,a8 as ke,K as Me,L as me,a9 as Tt,aa as at,J as ne,ab as xt,E as se,ac as Et,ad as Mt,ae as Ce,af as it,ag as le,ah as Ie,ai as We,aj as tt,ak as be,al as Lt,am as Ft,an as nt,ao as ue,Q as ce,ap as gt,aq as bt,ar as wt,as as Nt,at as qe,au as Rt,av as Ut,aw as kt,ax as Le,ay as Vt,az as zt,aA as Wt,aB as qt,aC as Ot,aD as Kt,aE as ot,aF as Ht,aG as jt,aH as Gt,aI as Yt,aJ as Zt,p as Xt,aK as Jt,H as Qt,aL as ea,aM as dt}from"./index-XxVI3L8o.js";import{W as ta}from"./WdsCheckbox-DfRnsKEG.js";import{marked as aa}from"./marked.esm-273vDTCT.js";const na={class:"BuilderSwitcher"},oa=R({__name:"BuilderSwitcher",setup(e){const r=W(z.core),a=W(z.builderManager);let l=O(null);const o=he(r),i={ui:void 0,blueprints:void 0};function s(S){return S==="blueprints"||S==="ui"}function d(S){const m=a.mode.value;if(m!=S){switch(s(m)&&r.activePageId.value&&(i[m]=r.activePageId.value),l.value=S,S){case"ui":o.track("nav_ui_opened");break;case"preview":o.track("nav_preview_opened");break;case"blueprints":o.track("nav_blueprints_opened");break;case"vault":o.track("nav_vault_opened");break}a.mode.value=S,s(S)&&i[S]&&r.getComponentById(i[S])&&r.setActivePageId(i[S]),(S=="preview"||m=="blueprints"||S=="blueprints")&&a.setSelection(null)}}const k=w(()=>a.getMode());return(S,m)=>(t(),c("div",na,[u("button",{"data-automation-action":"set-mode-ui",class:G({active:k.value=="ui"}),type:"button",onClick:m[0]||(m[0]=f=>d("ui"))},[B(q,{name:"frame"}),m[4]||(m[4]=j(" Interface "))],2),u("button",{"data-automation-action":"set-mode-blueprints",class:G({active:k.value=="blueprints"}),type:"button",onClick:m[1]||(m[1]=f=>d("blueprints"))},[B(q,{name:"wds-blueprints"}),m[5]||(m[5]=j(" Blueprints "))],2),v(r).isWriterCloudApp.value?(t(),c("button",{key:0,class:G({active:k.value=="vault"}),"data-automation-action":"set-mode-vault",type:"button",onClick:m[2]||(m[2]=f=>d("vault"))},[B(q,{name:"key-round"}),m[6]||(m[6]=j(" Vault "))],2)):$("",!0),u("button",{class:G({active:k.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:m[3]||(m[3]=f=>d("preview"))},[B(q,{name:"view"}),m[7]||(m[7]=j(" Preview "))],2)]))}}),la=V(oa,[["__scopeId","data-v-b47b97e5"]]),ra={class:"BuilderStateExplorer"},sa=R({__name:"BuilderStateExplorer",setup(e){const r=W(z.core);return(a,l)=>(t(),c("div",ra,[B(xe,{data:v(r).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),ia=V(sa,[["__scopeId","data-v-45c6b03e"]]),da=R({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){return(r,a)=>(t(),c("div",{class:G(["WdsStateDotState",`WdsStateDotState--${e.state}`])},null,2))}}),St=V(da,[["__scopeId","data-v-4eacfc04"]]);function ua(e,r){let a;return()=>{a&&clearTimeout(a),a=setTimeout(e,r)}}function ca(e){const r=Ee(),a=he(e),l=vt(),{pushToast:o}=we(),{writerApi:i,apiBaseUrl:s}=It({signal:r.signal}),d=w(()=>e.getComponentById("root")),k=O(!1),S=Ae(),m=Ae(),f=ua(async()=>{e.isWriterCloudApp.value&&e.mode.value==="edit"&&!C.value&&i.updateApplicationMetadata(e.writerOrgId.value,e.writerAppId.value,{name:g.value}),await e.sendComponentUpdate()},1e3),g=w({get:()=>d.value.content.appName,set:y=>{d.value.content.appName!==y&&(d.value.content.appName=y,f())}});J(()=>d.value.content.appName,f),J(m,()=>{var D;const y=(D=m.value)==null?void 0:D.name;y!==void 0&&(g.value=y)});const n=w(()=>{var T,x;const y=(x=(T=m.value.writer)==null?void 0:T.teamIds)==null?void 0:x[0];if(!y)return;const D=`/organization/${e.writerOrgId.value}/team/${y}/framework/${e.writerAppId.value}`;return new URL(D,s)}),p=w(()=>{if(!(!e.writerOrgId.value||!e.writerAppId.value))return new URL(`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,s)}),C=w(()=>{var y;return(y=m.value)!=null&&y.lastDeployedAt?new Date(m.value.lastDeployedAt):void 0}),_=w(()=>!!(e.isWriterCloudApp.value&&m.value)),b=w(()=>{var y;return((y=m.value)==null?void 0:y.status)==="deployed"});J(e.writerApplication,I,{immediate:!0}),re(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await I()},{signal:r.signal})});async function I(){if(e.writerApplication.value)try{m.value=await i.fetchApplicationDeployment(e.writerOrgId.value,e.writerAppId.value)}catch(y){l.error("Failed to fetch deployment information",y),m.value=void 0}}async function h(){if(e.writerApplication.value){if(!b.value){const y=`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,D=new URL(y,s);window.open(D,"_blank");return}k.value=!0,S.value=void 0;try{await i.publishApplication(e.writerOrgId.value,e.writerAppId.value,{applicationVersionId:m.value.applicationVersion.id,applicationVersionDataId:m.value.applicationVersionData.id}),await I();const y=n.value?{label:"See it live",func:()=>window.open(n.value,"_blank"),icon:"open_in_new"}:void 0;o({type:"success",message:"agent deployed",action:y}),a.track("deployment_succeeded")}catch(y){a.track("deployment_failed",{error:String(y)}),S.value=y,l.error("Deploy failed",y),o({type:"error",message:"deploy failed"})}finally{k.value=!1}}}return{name:g,canDeploy:_,writerDeployUrl:p,hasBeenPublished:b,publishApplication:h,isDeploying:Pt(k),lastDeployedAt:C}}const pa=["data-writer-tooltip"],va=["src","alt"],fa={key:1,class:"SharedWriterAvatar__initials"},ma=R({__name:"SharedWriterAvatar",props:{userId:{type:Number,required:!0},showTooltip:{type:Boolean,required:!1}},setup(e){const r=e,a=w(()=>r.userId),l=O(!1),{user:o,isLoading:i}=ft(a),s=w(()=>{var m;return((m=o.value)==null?void 0:m.avatar)??""}),d=w(()=>{var m;return(((m=o.value)==null?void 0:m.firstName)??"?").at(0)}),k=w(()=>{if(!(!r.showTooltip||!o.value))return`${o.value.firstName??""} ${o.value.lastName??""}`}),S=w(()=>o.value?`Avatar of ${o.value.firstName??""} ${o.value.lastName??""}`:`Avatar of the user ID ${a.value}`);return(m,f)=>(t(),c("div",{class:"SharedWriterAvatar","data-writer-tooltip":k.value},[v(i)||s.value&&!l.value?(t(),P(mt,{key:0,class:"SharedWriterAvatar__loader"})):$("",!0),v(i)?$("",!0):(t(),c(K,{key:1},[s.value?ye((t(),c("img",{key:0,src:s.value,alt:S.value,class:"SharedWriterAvatar__img",onLoad:f[0]||(f[0]=g=>l.value=!0)},null,40,va)),[[De,l.value]]):(t(),c("div",fa,U(d.value),1))],64))],8,pa))}}),rt=V(ma,[["__scopeId","data-v-d974552d"]]),_a=["data-writer-tooltip"],ha={key:0,class:"profile"},ya={key:1,class:"profile"},ga=R({__name:"BuilderHeaderConnected",setup(e){const r=W(z.collaborationManager),a=w(()=>r.connectedProfiles.value.length),l=w(()=>{var i;return(i=r.connectedProfiles.value)==null?void 0:i[0]}),o=w(()=>"Also editing: "+r.connectedProfiles.value.map(s=>s.displayName).join(", "));return(i,s)=>a.value>0?(t(),c("div",{key:0,class:"BuilderHeaderConnected","data-writer-tooltip":o.value,"data-writer-tooltip-placement":"bottom"},[a.value==1?(t(),c("div",ha,[B(rt,{"user-id":l.value.userId},null,8,["user-id"])])):$("",!0),a.value>1?(t(),c("div",ya," +"+U(a.value),1)):$("",!0)],8,_a)):$("",!0)}}),ba=V(ga,[["__scopeId","data-v-a13cab91"]]),wa=R({__name:"BuilderHeaderMoreDropdown",setup(e){const r=[{label:"Import agent .zip file",value:"import",icon:"upload"},{label:"Download agent .zip file",value:"export",icon:"download"}],a=W(z.core),l=pe("exportInput"),o=he(a),i=we(),s=O(!1),d=O(!1),k=O(!1),S=w(()=>[{disabled:s.value,desc:"Cancel",fn:()=>{k.value=!1,d.value=!1}},{disabled:!k.value,loading:s.value,desc:"Import",fn:f}]);async function m(){if(o.track("nav_export_clicked"),!l.value)return;const n=await fetch("./api/export");if(!n.ok)throw new Error("Failed to connect to export API");const p=await n.blob(),C=window.URL.createObjectURL(p),_=document.createElement("a");_.href=C,_.download="export.zip",document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(C)}async function f(){if(o.track("nav_import_clicked"),!l.value)return;const n=l.value.files[0];if(n){s.value=!0;try{const p=new FormData;if(p.append("file",n),!(await fetch("./api/import",{method:"POST",body:p})).ok)throw new Error("Failed to connect to import API");d.value=!1,i.pushToast({type:"success",message:"Project imported successfully."})}catch(p){i.pushToast({type:"error",message:"Failed to import the project: "+(p instanceof Error?p.message:String(p))})}finally{s.value=!1}}}async function g(n){if(n==="export")try{await m()}catch(p){i.pushToast({message:`Failed to export the project: ${p}`,type:"error"})}else n==="import"&&(l.value.value="",l.value.click())}return(n,p)=>(t(),c(K,null,[B(_t,{class:"BuilderHeaderMoreDropdown","trigger-variant":"secondary",options:r,onSelect:g}),ye(u("input",{ref_key:"exportInput",ref:l,type:"file",accept:".zip,application/zip",onChange:p[0]||(p[0]=C=>d.value=!0)},null,544),[[De,!1]]),d.value?(t(),P(Pe,{key:0,actions:S.value,title:"Are you sure you want to continue?",description:"Your current work will be replaced with the agent in the zip file. This includes replacement of current pages, blueprints, local scripts, and custom assets.",size:"normal"},{default:N(()=>[B(ta,{modelValue:k.value,"onUpdate:modelValue":p[1]||(p[1]=C=>k.value=C),label:"Yes, I want to replace the current agent with the imported file"},null,8,["modelValue"])]),_:1},8,["actions"])):$("",!0)],64))}}),ka=V(wa,[["__scopeId","data-v-fb5792fb"]]);function Sa(e){const r=we();let a;function l(s){a?r.pushToast({id:a,...s}):a=r.pushToast(s)}J(e.syncHealth,(s,d)=>{switch(s){case"idle":return l({type:"loading",message:"Connecting to the server",closable:!1,delayMs:1/0});case"connected":return l({message:d==="suspended"?"The server has restarted":"The connection to the server has been restored.",type:"success"});case"offline":return l({type:"loading",message:"Connection was lost due to a network issue or an ongoing update. Please hang tight!",closable:!1,delayMs:1/0});case"suspended":return l({message:"Restarting the server...",type:"loading",closable:!1,delayMs:1/0})}});const o=w(()=>{let s="";switch(e.syncHealth.value){case"offline":s+="Offline. Not syncing.";break;case"connected":s+="Online. Syncing...";break;case"idle":s+="Sync not initialised.";break;case"suspended":s+="Sync suspended.";break}return e.featureFlags.value.length>0&&(s+=` Feature flags: ${e.featureFlags.value.join(", ")}`),s}),i=w(()=>{switch(e.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});return{syncHealthStatus:o,stateDotState:i}}const Ba={class:"BuilderHeader"},Ca={class:"BuilderHeader__logo"},$a=["href"],Ia={key:1,src:ht,alt:"Writer Framework logo"},Pa=["disabled"],Aa={class:"BuilderHeader__toolbar"},Da={class:"BuilderHeader__toolbar__deployBtn"},Ta=R({__name:"BuilderHeader",setup(e){const r=W(z.core),a=O(!1),l=O(!1),o=he(r),i=we(),s=At(),{stateDotState:d,syncHealthStatus:k}=Sa(r),{canDeploy:S,isDeploying:m,publishApplication:f,hasBeenPublished:g,lastDeployedAt:n,writerDeployUrl:p,name:C}=ca(r),_=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function b(){o.track("nav_deploy_clicked"),g.value?I.value=!0:await f()}const I=O(!1),h=[{desc:"Cancel",fn:()=>I.value=!1},{desc:"Yes, deploy changes",fn:async()=>{I.value=!1,await f()}}],y=w(()=>n.value?`Editor Last saved ${_.format(n.value)}`:void 0),D=w(()=>g.value===!0?"Deploy changes":(g.value===!1,"Configure deployment"));function T(){o.track("nav_state_explorer_opened"),a.value=!0}function x(){l.value=!0}async function L(){try{await s.copy(location.href)}catch{i.pushToast({type:"error",message:"Could not copy link."})}}return(F,M)=>(t(),c("div",Ba,[u("div",Ca,[v(p)?(t(),c("a",{key:0,href:v(p).toString(),target:"_blank",class:"BuilderHeader__goBack"},M[3]||(M[3]=[u("img",{src:ht,alt:"Writer Framework logo"},null,-1)]),8,$a)):(t(),c("img",Ia)),M[4]||(M[4]=u("hr",null,null,-1)),v(r).isWriterCloudApp.value?ye((t(),c("input",{key:2,"onUpdate:modelValue":M[0]||(M[0]=oe=>yt(C)?C.value=oe:null),type:"text",disabled:!!v(n),class:"BuilderHeader__logo__appTitle"},null,8,Pa)),[[Dt,v(C)]]):$("",!0)]),B(la,{class:"BuilderHeader__switcher"}),u("div",Aa,[M[6]||(M[6]=u("hr",null,null,-1)),B(Q,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:T},{default:N(()=>[B(q,{name:"compass"})]),_:1}),B(Q,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"Invite collaborators","data-writer-tooltip-placement":"bottom",onClick:x},{default:N(()=>[B(q,{name:"share-2"})]),_:1}),B(ka),v(S)?(t(),P(Q,{key:0,size:"small",loading:v(m),"data-writer-tooltip":y.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:b},{default:N(()=>[u("span",Da,U(D.value),1),I.value?(t(),P(Pe,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:h},{default:N(()=>M[5]||(M[5]=[u("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):$("",!0)]),_:1},8,["loading","data-writer-tooltip"])):$("",!0),B(ba),B(St,{state:v(d),"data-writer-tooltip":v(k),"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),a.value?(t(),P(Pe,{key:1,title:"State Explorer","display-close-button":"",onClose:M[1]||(M[1]=oe=>a.value=!1)},{default:N(()=>[B(ia)]),_:1})):$("",!0),l.value?(t(),P(Pe,{key:2,title:"Share edit link with collaborators",description:"All AI Studio builders in your org can edit this agent with you in real time. Copy the link below to point them directly to editing this agent.","display-close-button":"",actions:[{desc:"Close",fn:()=>l.value=!1},{desc:v(s).copied.value?"Copied":"Copy edit link",fn:L,icon:v(s).copied.value?"check":"clipboard",disabled:v(s).copied.value}],onClose:M[2]||(M[2]=oe=>l.value=!1)},null,8,["actions"])):$("",!0)])]))}}),xa=V(Ta,[["__scopeId","data-v-80e958e5"]]),Ea={class:"text"},Ma=200,La=4,Fa=R({__name:"BuilderTooltip",setup(e){const r=pe("rootEl"),a=O(!1),l=O(null);let o=null,i=null;const s=O("top"),d=O({top:0,left:0});async function k(){if(!o||(l.value=o.dataset.writerTooltip,!l.value))return;const n=o.dataset.writerTooltipGap?parseInt(o.dataset.writerTooltipGap):La;if(a.value=S(o),!a.value)return;await me();const{x:p,y:C,width:_,height:b}=o.getBoundingClientRect(),{width:I,height:h}=r.value.getBoundingClientRect();switch(s.value){case"top":d.value.top=C-h-n,d.value.left=p+_/2-I/2;break;case"right":d.value.top=C+b/2-h/2,d.value.left=p+_+n;break;case"left":d.value.left=p-I-n,d.value.top=C+b/2-h/2;break;case"bottom":d.value.top=C+b+n,d.value.left=p+_/2-I/2;break}}function S(n){return n.getAttribute("data-writer-tooltip-strategy")==="overflow"?n.scrollWidth>n.clientWidth:!0}function m(n){const C=n.target.closest("[data-writer-tooltip]");if(C)o!==C&&(a.value=!1);else{a.value=!1,o=null;return}o=C,s.value=o.dataset.writerTooltipPlacement??"top",setTimeout(()=>f(C),Ma)}async function f(n){n===o&&(i==null||i.disconnect(),i=new MutationObserver(k),i.observe(o,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),k())}const g=w(()=>{const{top:n,left:p}=d.value;return{top:`${n}px`,left:`${p}px`}});return re(()=>{document.documentElement.addEventListener("mouseover",m)}),ke(()=>{document.documentElement.removeEventListener("mouseover",m),i==null||i.disconnect()}),(n,p)=>ye((t(),c("div",{ref_key:"rootEl",ref:r,class:"BuilderTooltip",style:Me(g.value)},[u("div",{class:G(["arrow",s.value])},null,2),u("div",Ea,U(l.value),1)],4)),[[De,a.value]])}}),Na=V(Fa,[["__scopeId","data-v-7ba01c7c"]]),Ra=""+new URL("art-paper-D70v1WMA.svg",import.meta.url).href,Ua={class:"BuilderPanel__collapser"},Va={class:"BuilderPanel__title"},za={class:"BuilderPanel__titleCompanion"},Wa=["data-order"],qa={key:0,class:"BuilderPanel__contents__leftPanel"},Oa={class:"BuilderPanel__actions"},Ka={class:"BuilderPanel__actionsCompanion"},Ha=R({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean},maxFileSizeLimit:{}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{expose:r,emit:a}){const l=W(z.builderManager),o=["code","log"],i=e,s=w(()=>{if(typeof i.maxFileSizeLimit=="number")return`Files can be up to ${Tt(i.maxFileSizeLimit)}`}),d=a,k=pe("mainContents");r({mainContents:k});const S=w(()=>i.enableDropFile&&m.value),m=O(!1);function f(h,y){i.enableDropFile&&(h.preventDefault(),m.value=y)}function g(h){h.preventDefault(),m.value=!1}function n(h){i.enableDropFile&&h.length>0&&d("filesDrop",h)}const p=w(()=>!l.openPanels.value.has(i.panelId)),C=w(()=>o.indexOf(i.panelId));function _(h){if(l.openPanels.value.has(h)){l.openPanels.value.delete(h),d("openned",!1);return}l.openPanels.value.add(h),d("openned",!0)}function b(h){const y=Mt(h);if(y&&h.key==i.keyboardShortcutKey.toLowerCase()){h.preventDefault(),_(i.panelId);return}i.actions.forEach(D=>{if(!D.keyboardShortcut)return;const{key:T,modifierKey:x}=D.keyboardShortcut;T.toLowerCase()==h.key&&(!y&&x||(h.preventDefault(),D.callback()))})}function I(h){if(!h)return"";let y=" (";return h.modifierKey&&(y+=at()),y+=h.key,y+=")",y}return re(async()=>{document.addEventListener("keydown",b)}),ke(()=>{document.removeEventListener("keydown",b)}),(h,y)=>(t(),c("div",{class:G(["BuilderPanel",{collapsed:p.value}])},[u("div",Ua,[B(Q,{variant:"neutral",size:"small","data-automation-action":"toggle-panel","data-automation-key":h.panelId,"data-writer-tooltip":`Toggle ${h.name} (${v(at)()}${h.keyboardShortcutKey})`,onClick:y[0]||(y[0]=D=>_(h.panelId))},{default:N(()=>[B(q,{name:p.value?"chevron-right":"chevron-up"},null,8,["name"]),u("span",Va,U(h.name),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),u("div",za,[ne(h.$slots,"titleCompanion",{},void 0,!0)]),p.value?$("",!0):(t(),P(Et,{key:0,to:h.contentsTeleportEl},[u("div",{style:Me({order:C.value}),"data-order":C.value,class:G(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":h.enableLeftPanel,"BuilderPanel__contents--dropingFile":S.value}]),onDrop:g,onDragover:y[1]||(y[1]=D=>f(D,!0)),onDragleave:y[2]||(y[2]=D=>f(D,!1))},[S.value?(t(),P(xt,{key:0,multiple:"",label:"Drop files here",restrictions:s.value,onDrop:n},null,8,["restrictions"])):(t(),c(K,{key:1},[h.enableLeftPanel?(t(),c("div",qa,[ne(h.$slots,"leftPanel",{},void 0,!0)])):$("",!0),u("div",Oa,[u("div",Ka,[ne(h.$slots,"actionsCompanion",{},void 0,!0)]),(t(!0),c(K,null,se(h.actions,(D,T)=>(t(),P(Q,{key:T,"data-writer-tooltip":D.name+I(D.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:D.isDisabled,onClick:D.callback},{default:N(()=>[B(q,{name:D.icon},null,8,["name"])]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),u("div",{ref_key:"mainContents",ref:k,class:"BuilderPanel__mainContents"},[ne(h.$slots,"default",{},void 0,!0)],512)],64))],46,Wa)],8,["to"]))],2))}}),Bt=V(Ha,[["__scopeId","data-v-5ccf1c14"]]),lt=150;function ja(e){const r=O(structuredClone(Ce(e.sourceFiles.value)));J(e.sourceFiles,(b,I)=>{let h=!1,y=structuredClone(Ce(r.value));const D=s(I).map(a);for(const T of it(b)){const x=le(T,I),L=le(T,b);if(Ie(L))continue;if(x===void 0||We(L)){y=tt(T,y,structuredClone(Ce(L))),h=!0;continue}if(!be(x))continue;const F=!x.complete&&L.complete,M=x.complete&&L.complete;if(!F&&!M)continue;const oe=a(T);if(D.includes(oe))continue;const Z=le(T,y);be(Z)&&(h=!0,Z.complete=!0,Z.content=L.content)}for(const T of Lt(y))le(T,b)===void 0&&(y=Ft(T,y),h=!0);h&&(r.value=y)});function a(b){return b.join("/")}const l=Ae(),o=w(()=>Array.from(it(r.value))),i=w(()=>s(e.sourceFiles.value));function s(b){return o.value.filter(I=>{const h=le(I,r.value);if(We(h))return!1;if(!be(h))return!0;const y=le(I,b);return be(y)?!h.complete||!y.complete?!1:h.content!==y.content:!0})}const d=w(()=>{if(l.value!==void 0)return le(l.value,r.value)}),k=w({get(){return be(d.value)?d.value.content:""},set(b){if(l.value===void 0)return;const I=le(l.value,r.value);be(I)&&(I.content=b)}});function S(b=1){const I=`new-file-${b}.txt`;return le([I],r.value)?S(b+1):I}async function m(){const b=S();r.value=tt([b],Ce(r.value)),n([b]),await e.sendCreateSourceFileRequest([b])}const f=w(()=>{var I;return(I=l.value)!=null&&I.length?l.value.at(-1).split(".").at(-1):""}),g=w(()=>{switch(f.value){case"py":return"python";case"js":case"mjs":return"javascript";case"ts":return"typescript";case"md":case"markdown":return"markdown";default:return f.value}});function n(b){l.value=b,be(d.value)&&!d.value.complete&&e.requestSourceFileLoading(b)}async function p(b){if(!(!l.value||!d.value)&&(d.value.type==="file"&&await e.sendCodeSaveRequest(k.value,l.value),b)){const I=[...Ce(l.value)];l.value=void 0;try{await e.sendRenameSourceFileRequest(I,b)}catch(h){throw l.value=I,h}n(b)}}function C(b){return new Promise((I,h)=>{const y=new FileReader;y.addEventListener("loadend",D=>{const T=D.target.result;if(T instanceof ArrayBuffer){const x=String.fromCharCode.apply(null,new Uint8Array(T));return I(x)}I(T.split(",")[1])}),y.addEventListener("error",()=>{h()}),y.readAsDataURL(b)})}async function _(b){const I=lt*1024*1024;if(b.size>I)throw Error(`Cannot upload file bigger than ${lt}mb`);const h=[b.name];if(le(h,e.sourceFiles.value))throw Error(`The file ${b.name} already exists`);r.value=tt(h,Ce(r.value),{type:"binary",uploading:!0});const y=await C(b);await e.sendFileUploadRequest(h,y)}return{code:k,sourceFileDraft:r,fileOpen:d,filepathOpen:l,pathsUnsaved:i,openedFileLanguage:g,save:p,upload:_,openFile:n,openNewFile:m,getNewFilename:S}}const Ga={class:"BuilderTree"},Ya=["draggable","data-automation-key","aria-expanded"],Za=["data-writer-tooltip"],Xa={key:1,class:"BuilderTree__main__dropdown"},Ja=R({__name:"BuilderTree",props:nt({name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},variant:{type:String,required:!1,default:void 0},noNestedSpace:{type:Boolean,required:!1},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0},disableCollapse:{type:Boolean,required:!1}},{collapsed:{type:Boolean,required:!1,default:!1},collapsedModifiers:{}}),emits:nt({expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},["update:collapsed"]),setup(e,{expose:r,emit:a}){const l=ue({loader:()=>ce(()=>import("./index-XxVI3L8o.js").then(g=>g.bp),__vite__mapDeps([0,1]),import.meta.url)}),o=e,i=a;r({expand:m,toggleCollapse:f});const s=gt(e,"collapsed"),d=O(!1),k=w(()=>!o.matched),S=w(()=>!o.hasChildren);function m(){s.value=!1,i("expandBranch")}function f(g){g??(g=!s.value),g!==s.value&&(s.value=g)}return(g,n)=>(t(),c("div",Ga,[u("div",{class:G(["BuilderTree__main",{selected:e.selected,notMatched:k.value,childless:S.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!s.value,onMouseenter:n[2]||(n[2]=p=>d.value=!0),onMouseleave:n[3]||(n[3]=p=>d.value=!1),onClick:n[4]||(n[4]=p=>g.$emit("select",p)),onKeydown:n[5]||(n[5]=wt(p=>g.$emit("select",p),["enter"])),onDragover:n[6]||(n[6]=p=>g.$emit("dragover",p)),onDragstart:n[7]||(n[7]=p=>g.$emit("dragstart",p)),onDragend:n[8]||(n[8]=p=>g.$emit("dragend",p)),onDrop:n[9]||(n[9]=p=>g.$emit("drop",p))},[e.hasChildren&&!e.disableCollapse?(t(),P(Q,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:n[0]||(n[0]=bt(p=>f(void 0),["stop"]))},{default:N(()=>[B(q,{name:s.value?"chevron-down":"chevron-up"},null,8,["name"])]),_:1},8,["disabled"])):$("",!0),ne(g.$slots,"nameLeft",{},void 0,!0),u("span",{class:G(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled,"BuilderTree__main__name--root":e.variant==="root"}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},U(e.name),11,Za),ne(g.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&d.value?(t(),c("div",Xa,[B(v(l),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:n[1]||(n[1]=p=>g.$emit("dropdownSelect",p))},null,8,["options"])])):$("",!0)],42,Ya),B(Nt,null,{default:N(()=>[ye(u("div",{class:G(["BuilderTree__children",{"BuilderTree__children--noNestedSpace":e.noNestedSpace}])},[ne(g.$slots,"children",{},void 0,!0)],2),[[De,!s.value&&e.hasChildren]])]),_:3})]))}}),Qa=V(Ja,[["__scopeId","data-v-8c085d0a"]]),en=["width","height","viewBox","aria-valuenow"],tn=["r","cx","cy","stroke","stroke-width"],an=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],nn=R({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const r=e,a=w(()=>r.sizePx/2),l=w(()=>r.sizePx/2-r.strokeWidth/2),o=w(()=>2*Math.PI*l.value),i=w(()=>o.value*((100-r.progress)/100)),s=w(()=>`0 0 ${r.sizePx} ${r.sizePx}`);return(d,k)=>(t(),c("svg",{width:e.sizePx,height:e.sizePx,viewBox:s.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[u("circle",{r:l.value,cx:a.value,cy:a.value,fill:"transparent",stroke:v(qe).Blue1,"stroke-width":e.strokeWidth},null,8,tn),u("circle",{r:l.value,cx:a.value,cy:a.value,fill:"transparent",stroke:v(qe).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":o.value,"stroke-dashoffset":i.value},null,8,an)],8,en))}}),on=R({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const r=e,a=O(0);return re(()=>{let l;const o=i=>{l||(l=i);const s=i-l;a.value=Math.min(s/r.timeMs*100,100),a.value<100&&requestAnimationFrame(o)};requestAnimationFrame(o)}),(l,o)=>(t(),P(nn,{class:"BuilderCodePanelFileUploading",progress:a.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),ln=V(on,[["__scopeId","data-v-449f2dac"]]),ut=[{label:"Delete",value:"delete",icon:"trash-2"}],rn=R({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:r}){const a=e,l=r;function o(n){return n.join("/")}const i=w(()=>o(a.pathActive)),s=w(()=>a.pathsUnsaved.map(o)),d=w(()=>Ie(a.sourceFiles)?Object.entries(a.sourceFiles.children).sort((n,p)=>n[0].localeCompare(p[0])):[]);function k(n){const p=le([...a.path,n],a.sourceFiles);return We(p)&&p.uploading}function S(n){const p=o([...a.path,n]);return s.value.includes(p)}function m(n){return o([...a.path,n])===i.value}function f(n){if(!Ie(a.sourceFiles)||k(n))return;const p=a.sourceFiles.children[n];Ie(p)||l("select",[...a.path,n])}function g(n,p){n==="delete"&&l("delete",[...a.path,p])}return(n,p)=>(t(),c("div",null,[(t(!0),c(K,null,se(d.value,([C,_])=>(t(),P(Qa,{key:C,name:C,matched:"","has-children":v(Ie)(_),selected:m(C),disabled:k(C),"right-click-options":ut,"dropdown-options":v(Ie)(_)||v(We)(_)?ut:void 0,onSelect:b=>f(C),onDropdownSelect:b=>g(b,C)},Rt({children:N(()=>[B(Ct,{"source-files":_,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,C],onSelect:p[0]||(p[0]=b=>n.$emit("select",b)),onDelete:p[1]||(p[1]=b=>n.$emit("delete",b))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[k(C)||S(C)?{name:"nameLeft",fn:N(()=>[k(C)?(t(),P(ln,{key:0,"time-ms":2e3})):S(C)?(t(),P(St,{key:1,state:"newDraft"})):$("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),Ct=V(rn,[["__scopeId","data-v-13c86c55"]]),sn=["disabled"],dn={class:"WdsButtonLink__text"},un=R({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disabled:{type:Boolean}},setup(e){const r=e,a=w(()=>[`WdsButtonLink--variant-${r.variant}`,`WdsButtonLink--weight-${r.weight}`]);return(l,o)=>(t(),c("button",{class:G(["WdsButtonLink",a.value]),disabled:e.disabled,type:"button"},[e.leftIcon?(t(),P(q,{key:0,name:e.leftIcon},null,8,["name"])):$("",!0),u("span",dn,U(e.text),1),e.rightIcon?(t(),P(q,{key:1,name:e.rightIcon},null,8,["name"])):$("",!0)],10,sn))}}),$t=V(un,[["__scopeId","data-v-f2cbc67f"]]),cn={class:"BuilderCodePanelFileUploadBtn"},pn=R({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:r}){const a=pe("input"),l=r;function o(){const{files:i}=a.value;i instanceof FileList&&i.length>0&&(l("selected",Array.from(i)),a.value.value="")}return(i,s)=>(t(),c("form",cn,[ye(u("input",{ref_key:"input",ref:a,type:"file",multiple:"",onChange:o},null,544),[[De,!1]]),B($t,{"left-icon":"upload",text:"Upload",onClick:s[0]||(s[0]=d=>v(a).click())})]))}}),ct="You have unsaved changes. Are you sure you want to leave?";function vn(){const e=O(!1),r=O(null);function a(){e.value=!0}function l(){e.value=!1}function o(s){if(e.value)return s.preventDefault(),s.returnValue=ct,ct}re(()=>{r.value=o,window.addEventListener("beforeunload",r.value)}),ke(()=>{r.value&&window.removeEventListener("beforeunload",r.value)});const i=Ee();return re(()=>{window.addEventListener("beforeunload",o,{signal:i.signal})}),{enablePrevention:a,disablePrevention:l}}function fn(){const e=Ae(!1),r=Ae(null),a=(s,d)=>{e.value=!0,r.value={action:s,description:d}};return{showModal:e,executePendingAction:()=>{r.value&&(r.value.action(),r.value=null),e.value=!1},cancelPendingAction:()=>{r.value=null,e.value=!1},checkUnsavedChanges:(s,d,k)=>s?(a(d,k),!0):!1}}function mn(e){const r=Ee();function a(o,i){switch(i){case"ctrl":return o.ctrlKey&&!o.metaKey;case"cmd":return o.metaKey&&!o.ctrlKey;case"alt":return o.altKey;case"shift":return o.shiftKey;default:return!o.ctrlKey&&!o.metaKey&&!o.altKey&&!o.shiftKey}}function l(o){for(const i of e){const s=o.key.toLowerCase()===i.key.toLowerCase(),d=a(o,i.modifier);if(s&&d){i.preventDefault!==!1&&o.preventDefault(),i.handler();return}}}re(()=>{document.addEventListener("keydown",l,{signal:r.signal})})}const _n={class:"UnsavedChangesModal__content"},hn={class:"UnsavedChangesModal__icon"},yn={class:"UnsavedChangesModal__message"},gn=R({__name:"UnsavedChangesModal",props:{filename:{type:String,required:!0},isSaving:{type:Boolean,required:!1}},emits:{save:()=>!0,cancel:()=>!0},setup(e,{emit:r}){const a=e,l=r,o=w(()=>[{desc:"Cancel",fn:()=>l("cancel")},{desc:"Save",fn:()=>l("save"),disabled:a.isSaving}]);return(i,s)=>(t(),P(Pe,{title:"Unsaved Changes",description:"You have unsaved changes. What would you like to do?",actions:o.value,"display-close-button":"",onClose:s[0]||(s[0]=d=>l("cancel"))},{default:N(()=>[u("div",_n,[u("div",hn,[B(q,{name:"alert-triangle"})]),u("div",yn,[u("p",null,[s[1]||(s[1]=j(" The file ")),u("strong",null,U(e.filename),1),s[2]||(s[2]=j(" has unsaved changes. "))]),s[3]||(s[3]=u("p",null,"Your changes will be lost if you don't save them.",-1))])])]),_:1},8,["actions"]))}}),bn=V(gn,[["__scopeId","data-v-bda871b9"]]),wn={class:"BuilderCodePanel__tree"},kn={class:"BuilderCodePanel__tree__actions"},Sn={key:1,class:"BuilderCodePanel__noPreview"},Bn={class:"BuilderCodePanel__actionsCompanion"},Cn=R({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const r=ue({loader:()=>ce(()=>import("./index-XxVI3L8o.js").then(A=>A.bp),__vite__mapDeps([0,1]),import.meta.url)}),a=ue({loader:()=>ce(()=>import("./BuilderEmbeddedCodeEditor-Dan2aGsM.js").then(A=>A.B),__vite__mapDeps([2,0,1,3]),import.meta.url)}),l=W(z.core),o=W(z.builderManager),i=[{label:"Rename file",value:"rename",icon:"pencil"},{label:"Delete file",value:"delete",icon:"trash-2",variant:"danger"}],s=he(l),{sourceFileDraft:d,openFile:k,upload:S,openNewFile:m,code:f,openedFileLanguage:g,filepathOpen:n,fileOpen:p,pathsUnsaved:C,save:_}=ja(l),{enablePrevention:b,disablePrevention:I}=vn(),{showModal:h,checkUnsavedChanges:y,executePendingAction:D,cancelPendingAction:T}=fn();async function x(A){await Promise.all(A.map(L))}async function L(A){try{await S(A),M({type:"success",message:`File ${A.name} uploaded`})}catch(H){M({type:"error",message:H.message})}}const F=w(()=>{var A;return(A=p.value)==null?void 0:A.type}),{pushToast:M}=we(),oe=vt();function Z(A){const H=new AbortController;re(()=>{document.addEventListener("keydown",async te=>{const Je=te.metaKey||te.ctrlKey,Qe=te.key==="s"||te.key==="S";!Je||!Qe||(te.preventDefault(),await A())},{signal:H.signal})}),ke(()=>H.abort())}Z(async()=>{await Se()}),mn([{key:"w",modifier:"ctrl",handler:Ve},{key:"w",modifier:"cmd",handler:Ve}]);const ie=pe("filenameEl"),de=O(""),ve=O(!1),_e=w(()=>{var A;return((A=n.value)==null?void 0:A.join("/"))??""}),Oe=w(()=>_e.value!=="main.py"),Fe=w(()=>_e.value!==de.value),Ke=w(()=>ve.value||_e.value==="main.py"),fe=w(()=>{if(Fe.value)return!1;if(n.value===void 0)return!0;const A=C.value.map(te=>te.join("/")).includes(_e.value),H=n.value&&!le(n.value,l.sourceFiles.value);return!A&&!H});J(n,()=>{var A;de.value=((A=n.value)==null?void 0:A.join("/"))??""}),J(l.sessionTimestamp,()=>{ve.value=!1}),Ut(()=>{fe.value?I():b()}),J(()=>o.openPanels.value.has("code"),(A,H)=>{H&&!A&&Ze()});function He(A){A&&(s.track("nav_code_opened"),n.value===void 0&&k(["main.py"]))}async function Ne(){var A;_e.value!=="main.py"&&(await me(),(A=ie.value)==null||A.focus())}async function je(A){switch(A){case"rename":return Ne();case"delete":await Te(n.value)}}async function Re(){await m(),Ne()}async function Te(A){await l.sendDeleteSourceFileRequest(A),M({type:"success",message:"The file was deleted"}),n.value.join("/").startsWith(A.join("/"))&&k(["main.py"])}async function Se(){if(n.value===void 0)return M({type:"error",message:"There is no file open"});if(fe.value)return M({type:"info",message:"There are no file changes to save"});ve.value=!0;const A=Fe.value?de.value.split("/"):void 0;if(A){const H=Xe(A);if(H)return M({type:"error",message:H})}try{await _(A),M({type:"success",message:"The file was saved"}),s.track("nav_code_file_updated",{path:n.value})}catch(H){oe.error("The file hasn't been saved.",H),M({type:"error",message:"The file hasn't been saved"});return}finally{ve.value=!1}}async function Ge(){await Se(),D()}function ee(){T()}async function Ye(A){y(!fe.value,()=>k(A),"switch file")||k(A)}async function Ue(A){y(!fe.value,()=>Te(A),"delete file")||await Te(A)}function Ve(){y(!fe.value,()=>o.openPanels.value.delete("code"),"close panel")||o.openPanels.value.delete("code")}function Ze(){y(!fe.value,()=>{},"close panel")&&me(()=>{o.openPanels.value.add("code")})}function Xe(A){return A[0]===""?"Path should not have a leading slash":A[0]===".wf"?".wf is reserved for Writer Framework":A.some(H=>H==="")?"Invalid path":null}return(A,H)=>(t(),c(K,null,[B(Bt,{"panel-id":"code",name:"Code","contents-teleport-el":A.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"","max-file-size-limit":v(lt)*1e3*1e3,onFilesDrop:x,onOpenned:He},{leftPanel:N(()=>[u("div",wn,[B(Ct,{"path-active":v(n),"paths-unsaved":v(C),"source-files":v(d),onAddFile:Re,onSelect:Ye,onDelete:Ue},null,8,["path-active","paths-unsaved","source-files"]),u("div",kn,[B($t,{"left-icon":"plus",text:"Add file",onClick:Re}),B(pn,{onSelected:x})])])]),actionsCompanion:N(()=>[u("div",Bn,[B(kt,{ref_key:"filenameEl",ref:ie,modelValue:de.value,"onUpdate:modelValue":H[1]||(H[1]=te=>de.value=te),disabled:!Oe.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:wt(Se,["enter"])},null,8,["modelValue","disabled"]),B(Q,{variant:"primary",size:"small",disabled:ve.value||fe.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:Se},{default:N(()=>[B(q,{name:"save"}),H[3]||(H[3]=j(" Save file "))]),_:1},8,["disabled"]),B(v(r),{disabled:Ke.value,options:i,onSelect:je},null,8,["disabled"])])]),default:N(()=>[F.value==="file"?(t(),P(v(a),{key:0,modelValue:v(f),"onUpdate:modelValue":H[0]||(H[0]=te=>yt(f)?f.value=te:null),variant:"full",language:v(g),disabled:ve.value},null,8,["modelValue","language","disabled"])):$("",!0),F.value==="binary"?(t(),c("div",Sn,H[2]||(H[2]=[u("img",{class:"BuilderCodePanel__noPreview__img",src:Ra},null,-1),u("p",{class:"BuilderCodePanel__noPreview__title"},"Canâ€™t Preview File",-1),u("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):$("",!0)]),_:1},8,["contents-teleport-el","max-file-size-limit"]),v(h)?(t(),P(bn,{key:0,filename:_e.value,"is-saving":ve.value,onSave:Ge,onCancel:ee},null,8,["filename","is-saving"])):$("",!0)],64))}}),$n=V(Cn,[["__scopeId","data-v-fb4f8afc"]]),In={class:"BuiderLogBlueprintExecutionTrace"},Pn={key:0,class:"trace"},An={class:"type"},Dn={key:0},Tn={key:1},xn={class:"main"},En={key:0},Mn={key:1},Ln={key:2},Fn={key:3},Nn={class:"details"},Rn={class:"data","data-automation-key":"result"},Un={key:1,class:"nothing"},Vn={class:"data","data-automation-key":"return-value"},zn={class:"environment"},Wn={class:"data"},qn={key:1,class:"nothing"},On={class:"callStack"},Kn={class:"eyebrow"},Hn=R({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:r}){const a=W(z.core),l=W(z.builderManager),o=he(a),i=r,{goToComponentParentPage:s}=Le(a,l),d=e,k=w(()=>{var g;const f=((g=d.executionItem.executionEnvironment)==null?void 0:g.call_stack)??[];return Object.fromEntries(f.map(n=>[n,a.getComponentById(n)]))}),S=w(()=>{var f;return((f=d.executionItem.executionEnvironment)==null?void 0:f.trace)??[]});re(()=>{o.track("blueprints_logs_trace_opened")});async function m(f){i("closeModal"),l.setMode("blueprints"),await me(),s(f),await me(),l.setSelection(f,void 0,"log")}return(f,g)=>{var n,p,C;return t(),c("div",In,[S.value.length>0?(t(),c("div",Pn,[(t(!0),c(K,null,se(S.value,(_,b)=>(t(),c("div",{key:b,class:"traceEntry"},[u("div",An,[_.type=="functionCall"?(t(),c("span",Dn,"âš¡ï¸")):$("",!0),_.type=="reasoning"?(t(),c("span",Tn,"ðŸ§ ")):$("",!0)]),u("div",xn,[_.thought?(t(),c("div",En,[g[0]||(g[0]=u("strong",null,"Thought.",-1)),j(" "+U(_.thought),1)])):$("",!0),_.action?(t(),c("div",Mn,[g[1]||(g[1]=u("strong",null,"Action.",-1)),j(" "+U(_.action),1)])):$("",!0),_.name?(t(),c("div",Ln,U(_.name),1)):$("",!0),_.parameters?(t(),c("div",Fn,[B(xe,{"hide-root":!0,data:_.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):$("",!0)])]))),128))])):$("",!0),u("div",Nn,[u("div",null,[g[2]||(g[2]=u("h3",null,"Result",-1)),g[3]||(g[3]=u("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),u("div",Rn,[(n=f.executionItem)!=null&&n.result?(t(),P(xe,{key:0,data:f.executionItem.result,"initial-depth":1},null,8,["data"])):(t(),c("div",Un,"No result."))])]),u("div",null,[g[4]||(g[4]=u("h3",null,"Return value",-1)),g[5]||(g[5]=u("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),u("div",Vn,[(p=f.executionItem)!=null&&p.returnValue?(t(),P(xe,{key:0,data:f.executionItem.returnValue,"initial-depth":1},null,8,["data"])):(t(),c(K,{key:1},[j(" No return value. ")],64))])])]),u("div",zn,[g[6]||(g[6]=u("h3",null,"Execution environment",-1)),g[7]||(g[7]=u("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),u("div",Wn,[(C=f.executionItem)!=null&&C.executionEnvironment?(t(),P(xe,{key:0,data:f.executionItem.executionEnvironment,"initial-depth":1},null,8,["data"])):(t(),c("div",qn,"Empty execution environment."))])]),u("div",On,[g[8]||(g[8]=u("h3",null,"Call stack",-1)),(t(!0),c(K,null,se(k.value,(_,b)=>{var I,h,y;return t(),c("div",{key:b,class:G(["component",{active:b==f.executionItem.componentId}])},[u("div",null,[u("div",Kn,[b==f.executionItem.componentId?(t(),c(K,{key:0},[j(" This block Â· ")],64)):$("",!0),j(" "+U(((I=v(a).getComponentDefinition(_==null?void 0:_.type))==null?void 0:I.name)??"Unavailable component")+" Â· Id: "+U(b),1)]),j(" "+U(((h=_==null?void 0:_.content)==null?void 0:h.alias)??((y=v(a).getComponentDefinition(_==null?void 0:_.type))==null?void 0:y.name)??"Unavailable component"),1)]),_?(t(),P(Q,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:D=>m(b)},{default:N(()=>[B(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):$("",!0)],2)}),128))])])}}}),jn=V(Hn,[["__scopeId","data-v-f98f57c8"]]),Gn={class:"BuilderListItem"},Yn=["viewBox"],Zn=["d","stroke"],Xn=["d","stroke"],Jn={class:"BuilderListItem__content"},Qn=R({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:qe.Blue2},colorLast:{type:String,required:!1,default:qe.Blue2}},setup(e){const r=e,a=w(()=>r.height/2),l=w(()=>`0 0 17 ${r.height}`),o=w(()=>["M1 0",`V${a.value-8}`,`C1 ${a.value-4}.4183 4.58172 ${a.value} 9 ${a.value}`,"H17"].join(" ")),i=w(()=>[`M1 ${a.value-8}`,`V${r.height}`].join(" "));return(s,d)=>(t(),c("div",Gn,[(t(),c("svg",{viewBox:l.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?$("",!0):(t(),c("path",{key:0,d:i.value,stroke:e.colorLast,"stroke-width":"1"},null,8,Zn)),u("path",{d:o.value,stroke:e.color,"stroke-width":"1"},null,8,Xn)],8,Yn)),u("div",Jn,[ne(s.$slots,"default",{},void 0,!0)])]))}}),eo=V(Qn,[["__scopeId","data-v-33f3edcd"]]),to={class:"BuilderLogBlueprintExecution"},ao={class:"name"},no={key:0},oo={class:"eyebrow"},lo={class:"outcome"},ro={class:"result"},so={class:"time"},io={key:0,class:"message markdown"},uo=R({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const r=W(z.core),a=W(z.builderManager),{goToComponentParentPage:l}=Le(r,a),o=e,i=O(null),s={in_progress:5,error:4,success:3,stopped:2,skipped:1,none:0},d=w(()=>({summary:[...o.executionLog.summary.filter(f=>!!f.outcome).filter(f=>(s[f.outcome]??s.success)>1).map(f=>({...f,component:r.getComponentById(f.componentId),componentDef:r.getComponentById(f.componentId)?r.getComponentDefinition(r.getComponentById(f.componentId).type):void 0}))]}));async function k(m){a.setMode("blueprints"),await me(),l(m),await me(),a.setSelection(m,void 0,"log")}function S(m){return m<0?"N/A":m<.1?"< 0.1s":`${m.toFixed(2)}s`}return(m,f)=>{const g=Vt("dompurify-html");return t(),c("div",to,[(t(!0),c(K,null,se(d.value.summary,(n,p)=>(t(),P(eo,{key:p,"is-last":p+1===d.value.summary.length},{default:N(()=>{var C,_,b,I,h,y,D,T,x,L,F,M;return[u("div",{class:G(["itemWrapper",{"itemWrapper--first":p===0,"itemWrapper--last":p+1===d.value.summary.length}])},[u("div",{class:G(["item",{selected:v(a).isComponentIdSelected(n.componentId)}])},[u("div",ao,[(_=(C=n.component)==null?void 0:C.content)!=null&&_.alias?(t(),c("div",no,[u("div",oo,U(((b=n.componentDef)==null?void 0:b.name)??"Unavailable component"),1),j(" "+U((h=(I=n.component)==null?void 0:I.content)==null?void 0:h.alias),1)])):(t(),c(K,{key:1},[j(U(((y=n.componentDef)==null?void 0:y.name)??"Unavailable component"),1)],64)),n.component?(t(),P(Q,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:oe=>k(n.componentId)},{default:N(()=>[B(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):$("",!0)]),u("div",lo,[n.outcome!=="in_progress"?(t(),c(K,{key:0},[u("div",{class:G(["ball",(x=(T=(D=n.componentDef)==null?void 0:D.outs)==null?void 0:T[n.outcome])==null?void 0:x.style])},null,2),j(" "+U(((M=(F=(L=n.componentDef)==null?void 0:L.outs)==null?void 0:F[n.outcome])==null?void 0:M.name)??n.outcome),1)],64)):(t(),c(K,{key:1},[f[1]||(f[1]=u("div",{class:"ballContainer"},[u("div",{class:"ball inProgress"})],-1)),f[2]||(f[2]=j(" In progress... "))],64))]),u("div",ro,[i.value==p?(t(),P(Pe,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>i.value=null}]},{default:N(()=>[B(jn,{"execution-item":n,onCloseModal:f[0]||(f[0]=()=>i.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):$("",!0),n.result||n.returnValue||n.executionEnvironment?(t(),P(Q,{key:1,variant:"special",size:"small",onClick:()=>i.value=p},{default:N(()=>[B(q,{name:"file-search-2"}),f[3]||(f[3]=j(" Trace "))]),_:2},1032,["onClick"])):$("",!0)]),u("div",so,U(S(n.executionTimeInSeconds)),1),n.message?ye((t(),c("div",io,null,512)),[[g,v(aa).parse(n.message)]]):$("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),co=V(uo,[["__scopeId","data-v-a691c27b"]]),po={class:"BuilderLogIndicator"},vo={key:0,class:"number error"},fo={class:"icon"},mo={key:1,class:"number info"},_o={class:"icon"},ho=R({__name:"BuilderLogIndicator",setup(e){const r=W(z.builderManager),a=w(()=>r.getLogEntries().reduce((l,o)=>(o.type in l||(l[o.type]=0),l[o.type]++,l),{}));return(l,o)=>(t(),c("div",po,[a.value.error>0?(t(),c("div",vo,[u("div",fo,[B(q,{name:"triangle-alert"})]),j(" "+U(a.value.error??0),1)])):$("",!0),a.value.info>0?(t(),c("div",mo,[u("div",_o,[B(q,{name:"info"})]),j(" "+U(a.value.info??0),1)])):$("",!0)]))}}),yo=V(ho,[["__scopeId","data-v-f0898ae9"]]),go={key:0,class:"entries"},bo={class:"icon"},wo={class:"title"},ko={class:"time"},So={class:"content"},Bo={key:0,class:"codeContainer"},Co={key:1,class:"emptyMessage"},$o=R({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const r=W(z.core),a=W(z.builderManager),l=pe("panel"),o=he(r);async function i(S){S&&(o.track("nav_logs_opened"),await me(),await k())}const s=[{icon:"trash-2",name:"Clear log",callback:()=>{a.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],d=w(()=>a.getLogEntries());async function k(){var p;const S=(p=l.value)==null?void 0:p.mainContents;if(!S)return;const m=S.querySelector(".item.selected");if(!m)return;const f=S.getBoundingClientRect(),g=m.getBoundingClientRect(),n=S.scrollTop+(g.top-f.top)-(f.height/2-g.height/2);S.scrollTo({top:n,behavior:"smooth"})}return J(a.selection,async()=>{await me(),await k()}),(S,m)=>(t(),P(Bt,{ref_key:"panel",ref:l,"panel-id":"log",name:"Log","contents-teleport-el":S.contentsTeleportEl,actions:s,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:i},{titleCompanion:N(()=>[B(yo)]),default:N(()=>[d.value.length>0?(t(),c("div",go,[(t(!0),c(K,null,se(d.value,(f,g)=>(t(),c(K,{key:g},[u("div",{class:G(["entry",f.type])},[u("div",bo,[B(q,{name:f.type==="error"?"triangle-alert":"info"},null,8,["name"])]),u("div",wo,U(f.title)+U(f.repeated>0?` Â· Repeated ${f.repeated} times`:""),1),u("div",ko,U(f.timestampReceived.toLocaleTimeString()),1),u("div",So,[j(U(f.message)+" ",1),f.code?(t(),c("div",Bo,[u("code",null,U(f.code),1)])):$("",!0)])],2),f.blueprintExecution?(t(),P(co,{key:0,"execution-log":f.blueprintExecution},null,8,["execution-log"])):$("",!0)],64))),128))])):$("",!0),d.value.length==0?(t(),c("div",Co,m[0]||(m[0]=[u("div",null,[j(" Exceptions and other relevant messages will be shown here."),u("br"),j("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):$("",!0)]),_:1},8,["contents-teleport-el"]))}}),Io=V($o,[["__scopeId","data-v-5bf9ec81"]]),Po={class:"switches"},Ao=R({__name:"BuilderPanelSwitcher",setup(e){const r=W(z.builderManager),a=pe("screenEl");return(l,o)=>(t(),c("div",{class:G(["BuilderPanelSwitcher",{openPanels:v(r).openPanels.value.size>0}])},[u("div",{ref_key:"screenEl",ref:a,class:"screen"},null,512),u("div",Po,[B($n,{"contents-teleport-el":v(a)},null,8,["contents-teleport-el"]),B(Io,{"contents-teleport-el":v(a)},null,8,["contents-teleport-el"])])],2))}}),Do=V(Ao,[["__scopeId","data-v-93f8be10"]]),To=["href"],xo=["disabled"],Eo=R({__name:"BuilderSidebarButton",props:{icon:{type:String,required:!0},active:{type:Boolean},disabled:{type:Boolean},href:{type:String,required:!1,default:void 0}},setup(e){return(r,a)=>e.href?(t(),c("a",{key:0,class:"BuilderSidebarButton",href:e.href},[B(q,{name:e.icon},null,8,["name"])],8,To)):(t(),c("button",{key:1,class:G(["BuilderSidebarButton",{"BuilderSidebarButton--active":e.active}]),role:"button",disabled:e.disabled},[B(q,{name:e.icon},null,8,["name"])],10,xo))}}),$e=V(Eo,[["__scopeId","data-v-044cd21a"]]),Mo={class:"BuilderSidebarVersion"},Lo={class:"BuilderSidebarVersion__capsule"},Fo=R({__name:"BuilderSidebarVersion",props:{version:{type:String,required:!0}},setup(e){return(r,a)=>(t(),c("span",Mo,[u("span",Lo," BETA "+U(e.version),1)]))}}),No=V(Fo,[["__scopeId","data-v-bbae565d"]]),Ro={key:0,class:"BuilderSidebarPanel__inputContainer"},Uo={class:"BuilderSidebarPanel__footer"},Vo=R({__name:"BuilderSidebarPanel",props:nt({hideSearchBar:{type:Boolean,required:!1},placeholder:{type:String,required:!1,default:""},searchCount:{type:Number,required:!1,default:void 0}},{modelValue:{type:String,required:!1,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const r=gt(e,"modelValue"),a=e,l=w(()=>{if(a.searchCount!==void 0)return`${a.searchCount} result${a.searchCount===1?"":"s"}`}),o=O(!1);function i(s){s.target instanceof HTMLElement&&(o.value=s.target.scrollTop>0)}return(s,d)=>(t(),c("div",{class:G(["BuilderSidebarPanel",{"BuilderSidebarPanel--mainScrollSeparator":o.value}])},[e.hideSearchBar?$("",!0):(t(),c("div",Ro,[B(kt,{modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=k=>r.value=k),class:"searchInput","left-icon":"search","data-automation-action":"search",placeholder:e.placeholder,"right-text":l.value,"right-icon":r.value?"x":void 0,onRightIconClick:d[1]||(d[1]=k=>r.value="")},null,8,["modelValue","placeholder","right-text","right-icon"])])),u("div",{class:"BuilderSidebarPanel__main",onScroll:i},[ne(s.$slots,"default",{},void 0,!0)],32),u("div",Uo,[ne(s.$slots,"footer",{},void 0,!0)])],2))}}),zo=V(Vo,[["__scopeId","data-v-fcaea8d5"]]),Wo=["data-note-id"],qo={class:"BuilderSidebarNote__header"},Oo={class:"BuilderSidebarNote__header__avatar"},Ko={class:"BuilderSidebarNote__header__avatar__type"},Ho={class:"BuilderSidebarNote__header__info"},jo={key:1},Go={key:0,class:"BuilderSidebarNote__header__actions"},Yo={key:0,class:"BuilderSidebarNote__content"},Zo={key:0},Xo=R({__name:"BuilderSidebarNote",props:{component:{type:Object,required:!0},excerpt:{type:Boolean}},emits:{select:()=>!0,edit:()=>!0,delete:()=>!0},setup(e,{emit:r}){const a=e,{user:l}=zt(),o=r,i=W(z.notesManager),{createdAtFormatted:s,type:d,content:k,createdBy:S}=i.useNoteInformation(w(()=>a.component)),{user:m,isLoading:f,error:g}=ft(S),n=w(()=>f.value||g.value),p=w(()=>k.value.length<100?k.value:`${k.value.slice(0,100)}...`),C=w(()=>k.value.split(`
`)),_=w(()=>m.value?[m.value.firstName,m.value.lastName].filter(Boolean).join(" "):""),b=w(()=>{var h;if(((h=l.value)==null?void 0:h.id)===S.value)return[{value:"edit",label:"Edit",icon:"pencil"},{value:"delete",label:"Delete",icon:"trash-2",variant:"danger"}]});function I(h){switch(h){case"edit":return o("edit");case"delete":return o("delete")}}return(h,y)=>(t(),c("div",{class:"BuilderSidebarNote","data-note-id":e.component.id,tabindex:"0",onClick:y[0]||(y[0]=D=>h.$emit("select"))},[u("div",qo,[u("div",Oo,[u("div",Ko,[v(d)==="blueprints"?(t(),P(q,{key:0,name:"wds-blueprints"})):v(d)==="ui"?(t(),P(q,{key:1,name:"frame"})):$("",!0)]),B(rt,{"user-id":v(S)},null,8,["user-id"])]),u("div",Ho,[n.value?(t(),P(mt,{key:0,class:"BuilderSidebarNote__header__info__loader"})):(t(),c("p",jo,U(_.value),1)),u("p",null,U(v(s)),1)]),b.value?(t(),c("div",Go,[B(_t,{options:b.value,"trigger-custom-size":"16px",onSelect:I},null,8,["options"])])):$("",!0)]),v(k)?(t(),c("div",Yo,[e.excerpt?(t(),c("p",Zo,U(p.value),1)):(t(!0),c(K,{key:1},se(C.value,(D,T)=>(t(),c("p",{key:T},U(D),1))),128))])):$("",!0)],8,Wo))}}),pt=V(Xo,[["__scopeId","data-v-4129b8b4"]]),Jo={},Qo={class:"BuilderSidebarNotesEmpty"};function el(e,r){return t(),c("div",Qo,r[0]||(r[0]=[Wt('<svg width="77" height="77" viewBox="0 0 77 77" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-98d925a1><circle cx="38.5" cy="38.5" r="38.5" fill="#E4E9FF" data-v-98d925a1></circle><path d="M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778V30.1111Z" fill="white" data-v-98d925a1></path><path d="M32.6667 35.4444H43.3333H32.6667Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778M32.6667 35.4444H43.3333M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" data-v-98d925a1></path></svg><h5 data-v-98d925a1>No Notes</h5><p data-v-98d925a1>Click anywhere on a blueprint or interface to add a note</p>',3)]))}const tl=V(Jo,[["render",el],["__scopeId","data-v-98d925a1"]]),al={class:"BuilderSidebarNoteForm"},nl=R({__name:"BuilderSidebarNoteForm",props:{component:{type:Object,required:!0},autofocus:{type:Boolean}},emits:{submit:e=>typeof e=="string"},setup(e){const r=e,a=W(z.notesManager),l=O(a.getNoteContent(r.component));return(o,i)=>(t(),c("div",al,[B(qt,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=s=>l.value=s),class:"BuilderSidebarNoteForm__input",autofocus:e.autofocus},null,8,["modelValue","autofocus"]),B(Q,{class:"BuilderSidebarNoteForm__submit",variant:"secondary",size:"smallIcon",disabled:!l.value,onClick:i[1]||(i[1]=s=>o.$emit("submit",l.value))},{default:N(()=>[B(q,{name:"send"})]),_:1},8,["disabled"])]))}}),ol=V(nl,[["__scopeId","data-v-157847b0"]]),ll={key:0,class:"BuilderSidebarNotes__note"},rl={key:2,class:"BuilderSidebarNotes__notes"},sl=R({__name:"BuilderSidebarNotes",setup(e){const r=W(z.core),a=W(z.builderManager),{selectedNote:l,selectNote:o,selectedNoteMode:i,selectedNoteId:s,getAllNotes:d,searchNotes:k,deleteNote:S,hoveredNoteId:m,useNoteInformation:f}=W(z.notesManager),{createAndInsertComponent:g}=Le(r,a),n=Ot({componentId:s,fieldKey:"content"}),p=O(""),C=w(()=>Array.from(d()).toSorted(I)),_=w(()=>Array.from(k(p.value)).toSorted(I)),b=w(()=>!!(l.value||C.value.length===0));function I(D,T){const x=f(D).createdAt.value,L=f(T).createdAt.value;return new Date(L).getTime()-new Date(x).getTime()}function h(D){return f(D).state.value}function y(D){r.getComponentById(s.value)?n.value=D:g(l.value.type,l.value.parentId,void 0,{content:{...l.value.content,content:D},x:l.value.x,y:l.value.y}),o(void 0)}return(D,T)=>(t(),P(zo,{modelValue:p.value,"onUpdate:modelValue":T[4]||(T[4]=x=>p.value=x),class:"BuilderSidebarNotes","hide-search-bar":b.value},{default:N(()=>[v(l)?(t(),c("div",ll,[v(i)==="edit"?(t(),P(ol,{key:0,component:v(l),autofocus:"",onSubmit:y},null,8,["component"])):(t(),P(pt,{key:1,component:v(l),onGoBack:T[0]||(T[0]=x=>v(o)(void 0)),onEdit:T[1]||(T[1]=x=>v(o)(v(s),"edit")),onDelete:T[2]||(T[2]=x=>v(S)(v(s)))},null,8,["component"]))])):_.value.length===0?(t(),P(tl,{key:1})):(t(),c("div",rl,[(t(!0),c(K,null,se(_.value,x=>(t(),P(pt,{key:x.id,component:x,class:G(["BuilderSidebarNotes__notes__note",{"BuilderSidebarNotes__notes__note--hover":h(x)==="hover"}]),excerpt:"",onSelect:L=>v(o)(x.id,"show"),onEdit:L=>v(o)(x.id,"edit"),onDelete:L=>v(S)(x.id),onMouseenter:L=>m.value=x.id,onMouseleave:T[3]||(T[3]=L=>m.value=void 0)},null,8,["component","class","onSelect","onEdit","onDelete","onMouseenter"]))),128))]))]),_:1},8,["modelValue","hide-search-bar"]))}}),il=V(sl,[["__scopeId","data-v-3dc5600c"]]),dl={class:"BuilderSidebar"},ul={class:"BuilderSidebar__toolbar"},cl={key:0,class:"BuilderSidebar__toolbar__top"},pl={key:1,class:"BuilderSidebar__toolbar__center"},vl={class:"BuilderSidebar__toolbar__bottom"},fl={key:0,class:"BuilderSidebar__pane"},ml={key:1},_l=R({__name:"BuilderSidebar",emits:{activePaneChanged:e=>e===void 0||typeof e=="string"},setup(e,{emit:r}){const a=ue({loader:()=>ce(()=>import("./BuilderSidebarToolkit-Fi_wNWCP.js"),__vite__mapDeps([4,0,1,5,6,7,8]),import.meta.url)}),l=ue({loader:()=>ce(()=>import("./BuilderSidebarComponentTree-DGatnbSK.js"),__vite__mapDeps([9,0,1,10,5,6,7,11]),import.meta.url)});function o(L){return typeof L=="string"&&["layers","add"].includes(L)}const i=W(z.core),s=W(z.builderManager),d=W(z.notesManager),k=r,S=w(()=>g()),{undo:m,redo:f,getUndoRedoSnapshot:g}=Le(i,s),n=w(()=>s.mode.value==="preview"),p="1.17.1rc1",C=Kt("activePane",o),_=O(n.value?void 0:C.value),b=w(()=>_.value!=="notes"?!1:d.selectedNoteId.value!==void 0);function I(){_.value==="notes"&&d.selectNote(void 0)}J(_,()=>{d.isAnnotating.value=_.value==="notes"},{immediate:!0}),J(n,()=>{n.value&&_.value}),J(d.selectedNoteId,()=>{d.selectedNoteId.value&&(_.value="notes")});const h=w(()=>({layers:s.mode.value==="ui"?"Interface Layers":"Blueprint Layers",add:"Add block",notes:"Notes"})),y=at();async function D(L){if(!(!(ot()?L.metaKey:L.ctrlKey)||L.target.closest("textarea, input, select")))switch(L.key){case"l":L.preventDefault(),_.value="layers";break;case"Enter":L.preventDefault(),_.value="add";break}}const T=new AbortController;re(()=>{document.addEventListener("keydown",D,{signal:T.signal})}),ke(()=>T.abort());function x(L){_.value=_.value===L?void 0:L,C.value=_.value,d.selectNote(void 0),k("activePaneChanged",L)}return(L,F)=>(t(),c("div",dl,[u("div",ul,[n.value?$("",!0):(t(),c("div",cl,[F[6]||(F[6]=u("hr",null,null,-1)),B($e,{icon:"layers","data-writer-tooltip-placement":"right","data-writer-tooltip":`${h.value.layers} (${v(y)}L)`,active:_.value==="layers","data-automation-action":"sidebar-layers",onClick:F[0]||(F[0]=M=>x("layers"))},null,8,["data-writer-tooltip","active"]),B($e,{icon:"wds-blocks","data-writer-tooltip-placement":"right","data-writer-tooltip":`${h.value.add} (${v(y)}Enter)`,active:_.value==="add","data-automation-action":"sidebar-add",onClick:F[1]||(F[1]=M=>x("add"))},null,8,["data-writer-tooltip","active"]),v(i).isWriterCloudApp.value?(t(),P($e,{key:0,icon:"message-square","data-writer-tooltip-placement":"right","data-writer-tooltip":`${h.value.notes}`,active:_.value==="notes","data-automation-action":"sidebar-notes",onClick:F[2]||(F[2]=M=>x("notes"))},null,8,["data-writer-tooltip","active"])):$("",!0)])),n.value?$("",!0):(t(),c("div",pl,[F[7]||(F[7]=u("hr",null,null,-1)),B($e,{icon:"undo-2","data-automation-key":"undo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Undo (${v(y)}Z)`,disabled:!S.value.isUndoAvailable,onClick:F[3]||(F[3]=M=>v(m)())},null,8,["data-writer-tooltip","disabled"]),B($e,{"data-automation-key":"redo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Redo (${v(y)}Y)`,icon:"redo-2",disabled:!S.value.isRedoAvailable,onClick:F[4]||(F[4]=M=>v(f)())},null,8,["data-writer-tooltip","disabled"])])),u("div",vl,[v(p)?(t(),P(No,{key:0,version:v(p)},null,8,["version"])):$("",!0),F[8]||(F[8]=u("hr",null,null,-1)),B($e,{target:"_blank",href:"https://dev.writer.com/agent-builder/overview",icon:"circle-question-mark","data-writer-tooltip-placement":"right","data-writer-tooltip":"Docs"})])]),_.value&&!n.value?(t(),c("div",fl,[u("div",{class:G(["BuilderSidebar__pane__header",{"BuilderSidebar__pane__header--goBack":b.value}])},[b.value?(t(),c(K,{key:0},[B(Q,{variant:"neutral",size:"smallIcon",onClick:I},{default:N(()=>[B(q,{name:"arrow-left"})]),_:1}),F[9]||(F[9]=u("h2",null,"Back",-1))],64)):(t(),c("h2",ml,U(h.value[_.value]),1)),B(Q,{variant:"neutral",size:"smallIcon",onClick:F[5]||(F[5]=M=>_.value=void 0)},{default:N(()=>[B(q,{name:"arrow-left-to-line"})]),_:1})],2),_.value==="add"?(t(),P(v(a),{key:0})):$("",!0),_.value==="layers"?(t(),P(v(l),{key:1})):$("",!0),_.value==="notes"?(t(),P(il,{key:2})):$("",!0)])):$("",!0)]))}}),hl=V(_l,[["__scopeId","data-v-bf0b63b3"]]),yl={class:"WdsToast__icon"},gl=R({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const r=e,a=w(()=>{switch(r.type){case"info":return"info";case"success":return"check";case"error":return"x";default:return"circle-question-mark"}});return(l,o)=>(t(),c("div",{class:G(["WdsToast",`WdsToast--${e.type}`])},[u("div",yl,[e.type==="loading"?(t(),P(Ht,{key:0,size:18,color:"white"})):e.type==="info"?(t(),c(K,{key:1},[j("i")],64)):(t(),P(q,{key:2,name:a.value},null,8,["name"]))]),u("p",null,U(e.message),1),e.action?(t(),c("button",{key:0,class:"WdsToast__action",onClick:o[0]||(o[0]=(...i)=>e.action.func&&e.action.func(...i))},[j(U(e.action.label)+" ",1),e.type==="info"?(t(),c(K,{key:0},[j("i")],64)):(t(),P(q,{key:1,name:e.action.icon},null,8,["name"]))])):$("",!0),e.closable?(t(),P(Q,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:o[1]||(o[1]=i=>l.$emit("close"))},{default:N(()=>[B(q,{name:"x"})]),_:1})):$("",!0)],2))}}),bl=V(gl,[["__scopeId","data-v-aa18760d"]]),wl={class:"BuilderToasts"},kl=R({__name:"BuilderToasts",setup(e){const{toasts:r,removeToast:a}=we();return(l,o)=>(t(),c("div",wl,[B(jt,{name:"list",tag:"div"},{default:N(()=>[(t(!0),c(K,null,se(v(r),i=>(t(),P(bl,{key:i.id,class:"BuilderToasts__toast",closable:i.closable,message:i.message,type:i.type,action:i.action,onClick:s=>i.closable!==!1?v(a)(i.id):void 0},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),Sl=V(kl,[["__scopeId","data-v-a5d06336"]]),Bl=200,Cl=36,$l=R({__name:"BuilderInstanceTracker",props:{instancePath:{},matchSize:{type:Boolean},verticalOffsetPixels:{},isOffBoundsAllowed:{type:Boolean},preventSettingsBarOverlap:{type:Boolean}},setup(e,{expose:r}){const a=e,{instancePath:l,matchSize:o,verticalOffsetPixels:i,isOffBoundsAllowed:s,preventSettingsBarOverlap:d}=Gt(a),k=Ae({});let S=0;const m=pe("rootEl");function f(_){const b=document.querySelector(".ComponentRenderer"),{top:I,left:h}=_.getBoundingClientRect(),{clientHeight:y}=document.body,{clientWidth:D}=b,{left:T}=b.getBoundingClientRect(),x=document.querySelector(".BuilderSettings"),{left:L}=(x==null?void 0:x.getBoundingClientRect())||{left:1/0};let{clientHeight:F,clientWidth:M}=(o!=null&&o.value?_:m.value)??{};if(F===void 0||M===void 0)return;let oe=i!=null&&i.value?i.value:0,Z=h,ie=I+oe;if(s.value||(Z=Math.max(T,Z),Z=Math.min(T+D-M,Z),ie=Math.max(Cl,ie),ie=Math.min(y-F,ie)),d.value){let de=0;Z+M>L&&(de=Math.max(Z-(L-M),0)),Z-=de}k.value={display:"block",top:`${ie}px`,left:`${Z}px`,width:`${M}px`,height:`${F}px`}}function g(){k.value={display:"none"}}function n(){let _=document.querySelector(`.ComponentRenderer [data-writer-instance-path="${l.value}"]`);if(!_){g();return}const b=getComputedStyle(_);if(!b){g();return}if(b.display=="contents"&&(_=_.querySelector("[data-writer-id]")),!_){g();return}f(_)}function p(){S=requestAnimationFrame(async()=>{n(),!C.signal.aborted&&(await new Promise(_=>setTimeout(_,Bl)),p())})}const C=Ee();return r({refresh:n}),re(async()=>{window.addEventListener("scroll",n,{signal:C.signal}),p()}),ke(()=>{cancelAnimationFrame(S)}),(_,b)=>(t(),c("div",{ref_key:"rootEl",ref:m,class:"BuilderInstanceTracker",style:Me(k.value)},[ne(_.$slots,"default",{},void 0,!0)],4))}}),ze=V($l,[["__scopeId","data-v-c3e9e555"]]),Il={ref:"rootEl",class:"BuilderCollaborationTracker"},Pl={class:"bubble"},Al={class:"main"},Dl=R({__name:"BuilderCollaborationTracker",setup(e){const r=W(z.collaborationManager);function a(l){return!(Yt(l).length<=2)}return(l,o)=>(t(),c("div",Il,[(t(!0),c(K,null,se(v(r).connectedUsersByInstancePath.value,(i,s)=>(t(),c(K,{key:s},[a(s)?(t(),P(ze,{key:0,"is-off-bounds-allowed":!1,"instance-path":s,"vertical-offset-pixels":-32,class:"instanceTracker"},{default:N(()=>[u("div",Pl,[u("div",Al,[(t(!0),c(K,null,se(i,d=>(t(),P(rt,{key:d,"show-tooltip":!0,"user-id":d},null,8,["user-id"]))),128))]),o[0]||(o[0]=u("div",{class:"triangle"},null,-1))])]),_:2},1032,["instance-path"])):$("",!0)],64))),128))],512))}}),Tl=V(Dl,[["__scopeId","data-v-15c19d63"]]),xl={class:"ShareResizeVertical__top"},El={class:"ShareResizeVertical__divider"},Ml={class:"ShareResizeVertical__bottom"},Ll=R({__name:"ShareResizeVertical",props:{initialBottomSize:{type:Number,required:!0},disabled:{type:Boolean,required:!1}},setup(e){const r=e,a=pe("root"),l=Ee(),o=Zt(r,"initialBottomSize");let i=O(o.value);J(o,()=>i.value=o.value);const s=w(()=>({gridTemplateRows:`minmax(0px, 1fr) 1px ${i.value}px`}));function d(){if(!a.value)return;document.addEventListener("mousemove",S,{signal:l.signal}),document.addEventListener("mouseup",m,{signal:l.signal});const k=a.value.getBoundingClientRect();function S(f){i.value=k.bottom-f.clientY}function m(){document.removeEventListener("mouseup",m),document.removeEventListener("mousemove",S)}}return(k,S)=>(t(),c("div",{ref_key:"root",ref:a,class:"ShareResizeVertical",style:Me(s.value)},[u("div",xl,[ne(k.$slots,"top",{},void 0,!0)]),u("div",El,[e.disabled?$("",!0):(t(),c("div",{key:0,class:"ShareResizeVertical__divider__hand",onMousedown:bt(d,["prevent"])},null,32))]),u("div",Ml,[ne(k.$slots,"bottom",{},void 0,!0)])],4))}}),Fl=V(Ll,[["__scopeId","data-v-0de30584"]]),Nl={class:"builderMain"},Rl=R({__name:"BuilderApp",setup(e){Xt(z.isAutogenModalShown,O(!1));const r=ue({loader:()=>ce(()=>import("./BuilderSettings-egdH7dG-.js").then(E=>E.b),__vite__mapDeps([12,0,1,10,13,5,6,14,15,16,17]),import.meta.url)}),a=ue({loader:()=>ce(()=>import("./ComponentRenderer-BOvg6u7c.js"),__vite__mapDeps([18,0,1,19]),import.meta.url)}),l=ue({loader:()=>ce(()=>import("./BuilderInsertionOverlay-Ce_6h3v5.js"),__vite__mapDeps([20,0,1,21]),import.meta.url)}),o=ue({loader:()=>ce(()=>import("./BuilderInsertionLabel-Bon1vNFr.js"),__vite__mapDeps([22,0,1,23]),import.meta.url)}),i=ue({loader:()=>ce(()=>import("./BuilderVault-DTLmDx8E.js"),__vite__mapDeps([24,15,0,1,16,25]),import.meta.url)}),s=W(z.core),d=W(z.builderManager),k=W(z.notesManager),S=W(z.collaborationManager),m=he(s),f=we(),g=pe("noteEl");function n(){if(g.value!=null&&typeof g.value[Symbol.iterator]=="function")for(const ae of g.value)ae.refresh()}const{candidateId:p,candidateInstancePath:C,isCandidacyConfirmed:_,dropComponent:b,assignInsertionCandidacy:I,removeInsertionCandidacy:h}=ea(s),{createAndInsertComponent:y,undo:D,redo:T,moveComponent:x,moveComponentUp:L,moveComponentDown:F,cutComponent:M,isPasteAllowed:oe,isCopyAllowed:Z,isCutAllowed:ie,isDeleteAllowed:de,isGoToParentAllowed:ve,isGoToChildAllowed:_e,isGoToNextSiblingAllowed:Oe,isGoToPrevSiblingAllowed:Fe,pasteComponent:Ke,copyComponent:fe,removeComponentsSubtree:He,goToParent:Ne,goToChild:je,goToNextSibling:Re,goToPrevSibling:Te,moveComponentToParent:Se,moveComponentInsideNextSibling:Ge}=Le(s,d,m),ee=d.mode,Ye=d.firstSelectedId,Ue=w(()=>d.openPanels.value.size>0),Ve=w(()=>Array.from(k.getNotes(s.activePageId.value)).map(E=>({...E,parentInstancePath:k.useNoteInformation(E).parentInstancePath.value})).filter(E=>E.parentInstancePath!==void 0));async function Ze(E){if(E.key=="Escape"){d.setSelection(null);return}const ae=ot()?E.metaKey:E.ctrlKey;if(E.target.closest("textarea, input, select, [contenteditable]"))return;if(E.key=="z"&&ae){E.preventDefault(),D();return}if(E.key=="y"&&ae){E.preventDefault(),T();return}if(!d.isSingleSelectionActive.value||!d.firstSelectedItem.value)return;const{componentId:Y,instancePath:Be}=d.firstSelectedItem.value;if(E.key==(ot()?"Backspace":"Delete")){const ge=d.selection.value.filter(et=>de(et.componentId)).map(et=>et.componentId);He(...ge);return}if(ae)if(E.shiftKey)switch(E.key){case"ArrowDown":E.preventDefault(),Oe(Y)&&Re(Y);break;case"ArrowUp":E.preventDefault(),Fe(Y)&&Te(Y);break;case"ArrowLeft":E.preventDefault(),ve(Y)&&Ne(Y,Be);break;case"ArrowRight":E.preventDefault(),_e(Y)&&je(Y);break}else switch(E.key){case"ArrowDown":E.preventDefault(),F(Y);break;case"ArrowUp":E.preventDefault(),L(Y);break;case"ArrowLeft":E.preventDefault(),Se(Y);break;case"ArrowRight":E.preventDefault(),Ge(Y);break;case"v":if(!oe(Y))return;try{await Ke(Y)}catch(ge){f.pushToast({type:"error",message:String(ge)})}break;case"c":Z(Y)&&fe(Y);break;case"x":ie(Y)&&M(Y);break}}function Xe(E){ee.value!=="preview"&&I(E)}function A(E){if(ee.value==="preview")return;d.setSelection(null);const ae=b(E);if(!ae)return;const{draggedType:X,draggedId:Y,parentId:Be,position:ge}=ae;Y?x(Y,Be,ge):y(X,Be,ge)}function H(E){if(ee.value==="preview"||E.target.closest("[data-writer-unselectable]"))return;const X=E.target.closest("[data-writer-id]");if(!X)return;const Y=X.dataset.writerId,Be=X.dataset.writerInstancePath;d.isComponentIdSelected(Y)&&d.selectionStatus.value!==dt.Multiple||k.isAnnotating.value||(E.preventDefault(),E.stopPropagation(),d.handleSelectionFromEvent(E,Y,Be,"click"))}function te(){d.isSettingsBarCollapsed.value=!1}const Je=E=>{if(ee.value==="preview")return;const X=E.target.closest("[data-writer-id]").dataset.writerId,{type:Y}=s.getComponentById(X);d.selectionStatus.value===dt.Multiple&&(d.setSelection(X,void 0,"click"),d.isSettingsBarCollapsed.value=!0),E.dataTransfer.setData(`application/json;writer=${Y},${X}`,"{}")};function Qe(E){d.setSelection(null),h(E)}const st=new AbortController;return J(d.selection,()=>{S&&(S.updateOutgoingPing({action:"select",selection:d.selection.value}),S.sendCollaborationPing())}),re(()=>{document.addEventListener("keydown",Ze,{signal:st.signal})}),ke(()=>{st.abort()}),(E,ae)=>(t(),c("div",{class:"BuilderApp",tabindex:"-1",style:Me(v(Qt))},[u("div",{class:G(["mainGrid",{openPanels:v(d).openPanels.value.size>0}])},[B(xa,{class:"builderHeader"}),ye(B(hl,{class:"sidebar",onActivePaneChanged:n},null,512),[[De,v(ee)==="ui"||v(ee)==="blueprints"]]),B(Fl,{"initial-bottom-size":Ue.value?440:48,disabled:!Ue.value,class:G({"mainGrid--fullWidth":v(ee)==="preview"||v(ee)==="vault"})},{top:N(()=>[u("div",Nl,[v(ee)==="vault"?(t(),P(v(i),{key:0})):(t(),c("div",{key:1,class:G(["rendererWrapper",{addNoteCursor:v(k).isAnnotating.value&&v(d).mode.value!=="preview"}]),onScroll:n},[B(v(a),{class:G(["componentRenderer",{settingsOpen:v(d).isSingleSelectionActive}]),onDragover:Xe,onDragstart:Je,onDragend:Qe,onDrop:A,onClickCapture:H,onDblclick:te},null,8,["class"])],34)),v(d).isSingleSelectionActive?(t(),P(v(r),{key:v(Ye)??"noneSelected"})):$("",!0)])]),bottom:N(()=>[B(Do,{class:"panelSwitcher"})]),_:1},8,["initial-bottom-size","disabled","class"])],2),v(ee)!=="preview"?(t(),c(K,{key:0},[B(Tl,{class:"collaborationTracker"}),v(p)&&!v(_)?(t(),c(K,{key:0},[(t(),P(ze,{key:v(C),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":v(C),"match-size":!0},{default:N(()=>[B(v(l))]),_:1},8,["instance-path"])),(t(),P(ze,{key:v(C),class:"insertionLabelTracker","instance-path":v(C),"vertical-offset-pixels":-48},{default:N(()=>[B(v(o),null,{default:N(()=>[j(U(v(s).getComponentDefinition(v(s).getComponentById(v(p)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):$("",!0)],64)):$("",!0),v(ee)==="ui"?(t(!0),c(K,{key:1},se(Ve.value,X=>(t(),P(ze,{key:X.id,ref_for:!0,ref_key:"noteEl",ref:g,class:"BuilderApp__noteTracker","is-off-bounds-allowed":!0,"instance-path":X.parentInstancePath,"match-size":!0},{default:N(()=>[B(Jt,{class:"BuilderApp__noteTracker__note","component-id":X.id},null,8,["component-id"])]),_:2},1032,["instance-path"]))),128)):$("",!0),ae[0]||(ae[0]=u("div",{id:"modal"},null,-1)),B(Na,{id:"tooltip"}),B(Sl)],4))}}),Ul=V(Rl,[["__scopeId","data-v-452da39b"]]),ql=Object.freeze(Object.defineProperty({__proto__:null,default:Ul},Symbol.toStringTag,{value:"Module"}));export{zo as B,$t as W,Qa as a,eo as b,ql as c};
