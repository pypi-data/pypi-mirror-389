function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-D2TgG8aI.js","./index-DQ-arKq5.css","./BuilderEmbeddedCodeEditor-A12DxFS_.js","./BuilderEmbeddedCodeEditor-CXloIist.css","./BuilderSidebarToolkit-DUY1CbzX.js","./WdsCheckbox-BBvxuMZp.js","./WdsCheckbox-DKvpPA4D.css","./marked.esm-273vDTCT.js","./BuilderSidebarToolkit-Ipk1HoMm.css","./BuilderSidebarComponentTree-B9sgGPPv.js","./useComponentDescription-D9hE3hov.js","./BuilderSidebarComponentTree-C5AMKQcR.css","./BuilderSettings-Bxu9nRAh.js","./WdsDropdownMenu-BemgXnZ_.js","./WdsDropdownMenu-BT8vFJ33.css","./useKeyValueEditor-BlWwMMYt.js","./useKeyValueEditor-CsemOh8D.css","./BuilderSettings-DNtzYAFM.css","./ComponentRenderer-ChvAkG3h.js","./ComponentRenderer-72hqvEvI.css","./BuilderInsertionOverlay-D13-u_XP.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-1wm2Xqy7.js","./BuilderInsertionLabel-_YS5WPfq.css","./BuilderVault-BUt2H-II.js","./BuilderVault-Cx6oQSES.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as R,i as W,a as U,r as K,u as ve,c as k,o as t,f as u,g as c,x as S,y as q,A as G,G as O,R as v,S as C,_ as V,T as Ce,U as Ke,V as ye,X as Ct,Y as Le,w as ae,q as ce,Z as It,$ as tt,a0 as at,b as A,a1 as nt,D as H,s as me,v as Se,t as z,m as ue,a2 as ot,z as N,a3 as Ie,a4 as At,a5 as rt,a6 as Pt,a7 as lt,W as J,a8 as Be,K as Ae,L as pe,a9 as Tt,aa as qe,J as te,ab as Dt,E as ne,ac as xt,ad as Et,ae as be,af as Xe,ag as le,ah as we,ai as Me,aj as We,ak as _e,al as Lt,am as Mt,an as Oe,ao as ie,Q as de,ap as st,aq as it,ar as dt,as as Ft,at as Fe,au as Nt,av as ut,aw as Pe,ax as Rt,ay as zt,az as Vt,aA as Ut,aB as Wt,aC as qt,aD as He,aE as Ot,aF as Ht,aG as jt,aH as Kt,aI as Gt,p as Yt,aJ as Zt,H as Xt,aK as Jt,aL as Je}from"./index-D2TgG8aI.js";import{W as Qt}from"./WdsCheckbox-BBvxuMZp.js";import{marked as ea}from"./marked.esm-273vDTCT.js";const ta={class:"BuilderSwitcher"},aa=R({__name:"BuilderSwitcher",setup(e){const r=W(U.core),a=W(U.builderManager);let o=K(null);const s=ve(r),i={ui:void 0,blueprints:void 0};function d(w){return w==="blueprints"||w==="ui"}function l(w){const m=a.mode.value;if(m!=w){switch(d(m)&&r.activePageId.value&&(i[m]=r.activePageId.value),o.value=w,w){case"ui":s.track("nav_ui_opened");break;case"preview":s.track("nav_preview_opened");break;case"blueprints":s.track("nav_blueprints_opened");break;case"vault":s.track("nav_vault_opened");break}a.mode.value=w,d(w)&&i[w]&&r.getComponentById(i[w])&&r.setActivePageId(i[w]),(w=="preview"||m=="blueprints"||w=="blueprints")&&a.setSelection(null)}}const B=k(()=>a.getMode());return(w,m)=>(t(),u("div",ta,[c("button",{"data-automation-action":"set-mode-ui",class:O({active:B.value=="ui"}),type:"button",onClick:m[0]||(m[0]=_=>l("ui"))},[S(q,{name:"frame"}),m[4]||(m[4]=G(" Interface "))],2),c("button",{"data-automation-action":"set-mode-blueprints",class:O({active:B.value=="blueprints"}),type:"button",onClick:m[1]||(m[1]=_=>l("blueprints"))},[S(q,{name:"wds-blueprints"}),m[5]||(m[5]=G(" Blueprints "))],2),v(r).isWriterCloudApp.value?(t(),u("button",{key:0,class:O({active:B.value=="vault"}),"data-automation-action":"set-mode-vault",type:"button",onClick:m[2]||(m[2]=_=>l("vault"))},[S(q,{name:"key-round"}),m[6]||(m[6]=G(" Vault "))],2)):C("",!0),c("button",{class:O({active:B.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:m[3]||(m[3]=_=>l("preview"))},[S(q,{name:"view"}),m[7]||(m[7]=G(" Preview "))],2)]))}}),na=V(aa,[["__scopeId","data-v-b47b97e5"]]),oa={class:"BuilderStateExplorer"},ra=R({__name:"BuilderStateExplorer",setup(e){const r=W(U.core);return(a,o)=>(t(),u("div",oa,[S(Ce,{data:v(r).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),la=V(ra,[["__scopeId","data-v-45c6b03e"]]),sa=R({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){return(r,a)=>(t(),u("div",{class:O(["WdsStateDotState",`WdsStateDotState--${e.state}`])},null,2))}}),ct=V(sa,[["__scopeId","data-v-4eacfc04"]]);function ia(e,r){let a;return()=>{a&&clearTimeout(a),a=setTimeout(e,r)}}function da(e){const r=Ke(),a=ve(e),o=tt(),{pushToast:s}=ye(),{writerApi:i,apiBaseUrl:d}=Ct({signal:r.signal}),l=k(()=>e.getComponentById("root")),B=K(!1),w=Le(),m=Le(),_=ia(async()=>{e.isWriterCloudApp.value&&e.mode.value==="edit"&&!$.value&&i.updateApplicationMetadata(e.writerOrgId.value,e.writerAppId.value,{name:h.value}),await e.sendComponentUpdate()},1e3),h=k({get:()=>l.value.content.appName,set:g=>{l.value.content.appName!==g&&(l.value.content.appName=g,_())}});ae(()=>l.value.content.appName,_),ae(m,()=>{var P;const g=(P=m.value)==null?void 0:P.name;g!==void 0&&(h.value=g)});const n=k(()=>{var T,D;const g=(D=(T=m.value.writer)==null?void 0:T.teamIds)==null?void 0:D[0];if(!g)return;const P=`/organization/${e.writerOrgId.value}/team/${g}/framework/${e.writerAppId.value}`;return new URL(P,d)}),p=k(()=>{if(!(!e.writerOrgId.value||!e.writerAppId.value))return new URL(`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,d)}),$=k(()=>{var g;return(g=m.value)!=null&&g.lastDeployedAt?new Date(m.value.lastDeployedAt):void 0}),y=k(()=>!!(e.isWriterCloudApp.value&&m.value)),b=k(()=>{var g;return((g=m.value)==null?void 0:g.status)==="deployed"});ae(e.writerApplication,I,{immediate:!0}),ce(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await I()},{signal:r.signal})});async function I(){if(e.writerApplication.value)try{m.value=await i.fetchApplicationDeployment(e.writerOrgId.value,e.writerAppId.value)}catch(g){o.error("Failed to fetch deployment information",g),m.value=void 0}}async function f(){if(e.writerApplication.value){if(!b.value){const g=`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,P=new URL(g,d);window.open(P,"_blank");return}B.value=!0,w.value=void 0;try{await i.publishApplication(e.writerOrgId.value,e.writerAppId.value,{applicationVersionId:m.value.applicationVersion.id,applicationVersionDataId:m.value.applicationVersionData.id}),await I();const g=n.value?{label:"See it live",func:()=>window.open(n.value,"_blank"),icon:"open_in_new"}:void 0;s({type:"success",message:"agent deployed",action:g}),a.track("deployment_succeeded")}catch(g){a.track("deployment_failed",{error:String(g)}),w.value=g,o.error("Deploy failed",g),s({type:"error",message:"deploy failed"})}finally{B.value=!1}}}return{name:h,canDeploy:y,writerDeployUrl:p,hasBeenPublished:b,publishApplication:f,isDeploying:It(B),lastDeployedAt:$}}const ua=["data-writer-tooltip"],ca=["src","alt"],pa={key:1,class:"SharedWriterAvatar__initials"},va=R({__name:"SharedWriterAvatar",props:{userId:{type:Number,required:!0},showTooltip:{type:Boolean,required:!1}},setup(e){const r=e,a=k(()=>r.userId),o=K(!1),{user:s,isLoading:i}=at(a),d=k(()=>{var m;return((m=s.value)==null?void 0:m.avatar)??""}),l=k(()=>{var m;return(((m=s.value)==null?void 0:m.firstName)??"?").at(0)}),B=k(()=>{if(!(!r.showTooltip||!s.value))return`${s.value.firstName??""} ${s.value.lastName??""}`}),w=k(()=>s.value?`Avatar of ${s.value.firstName??""} ${s.value.lastName??""}`:`Avatar of the user ID ${a.value}`);return(m,_)=>(t(),u("div",{class:"SharedWriterAvatar","data-writer-tooltip":B.value},[v(i)||d.value&&!o.value?(t(),A(nt,{key:0,class:"SharedWriterAvatar__loader"})):C("",!0),v(i)?C("",!0):(t(),u(H,{key:1},[d.value?me((t(),u("img",{key:0,src:d.value,alt:w.value,class:"SharedWriterAvatar__img",onLoad:_[0]||(_[0]=h=>o.value=!0)},null,40,ca)),[[Se,o.value]]):(t(),u("div",pa,z(l.value),1))],64))],8,ua))}}),Ge=V(va,[["__scopeId","data-v-d974552d"]]),ma=["data-writer-tooltip"],fa={key:0,class:"profile"},_a={key:1,class:"profile"},ya=R({__name:"BuilderHeaderConnected",setup(e){const r=W(U.collaborationManager),a=k(()=>r.connectedProfiles.value.length),o=k(()=>{var i;return(i=r.connectedProfiles.value)==null?void 0:i[0]}),s=k(()=>"Also editing: "+r.connectedProfiles.value.map(d=>d.displayName).join(", "));return(i,d)=>a.value>0?(t(),u("div",{key:0,class:"BuilderHeaderConnected","data-writer-tooltip":s.value,"data-writer-tooltip-placement":"bottom"},[a.value==1?(t(),u("div",fa,[S(Ge,{"user-id":o.value.userId},null,8,["user-id"])])):C("",!0),a.value>1?(t(),u("div",_a," +"+z(a.value),1)):C("",!0)],8,ma)):C("",!0)}}),ha=V(ya,[["__scopeId","data-v-a13cab91"]]),ga=R({__name:"BuilderHeaderMoreDropdown",setup(e){const r=[{label:"Import agent .zip file",value:"import",icon:"upload"},{label:"Download agent .zip file",value:"export",icon:"download"}],a=W(U.core),o=ue("exportInput"),s=ve(a),i=ye(),d=K(!1),l=K(!1),B=K(!1),w=k(()=>[{disabled:d.value,desc:"Cancel",fn:()=>{B.value=!1,l.value=!1}},{disabled:!B.value,loading:d.value,desc:"Import",fn:_}]);async function m(){if(s.track("nav_export_clicked"),!o.value)return;const n=await fetch("./api/export");if(!n.ok)throw new Error("Failed to connect to export API");const p=await n.blob(),$=window.URL.createObjectURL(p),y=document.createElement("a");y.href=$,y.download="export.zip",document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL($)}async function _(){if(s.track("nav_import_clicked"),!o.value)return;const n=o.value.files[0];if(n){d.value=!0;try{const p=new FormData;if(p.append("file",n),!(await fetch("./api/import",{method:"POST",body:p})).ok)throw new Error("Failed to connect to import API");l.value=!1,i.pushToast({type:"success",message:"Project imported successfully."})}catch(p){i.pushToast({type:"error",message:"Failed to import the project: "+(p instanceof Error?p.message:String(p))})}finally{d.value=!1}}}async function h(n){if(n==="export")try{await m()}catch(p){i.pushToast({message:`Failed to export the project: ${p}`,type:"error"})}else n==="import"&&(o.value.value="",o.value.click())}return(n,p)=>(t(),u(H,null,[S(ot,{class:"BuilderHeaderMoreDropdown","trigger-variant":"secondary",options:r,onSelect:h}),me(c("input",{ref_key:"exportInput",ref:o,type:"file",accept:".zip,application/zip",onChange:p[0]||(p[0]=$=>l.value=!0)},null,544),[[Se,!1]]),l.value?(t(),A(Ie,{key:0,actions:w.value,title:"Are you sure you want to continue?",description:"Your current work will be replaced with the agent in the zip file. This includes replacement of current pages, blueprints, local scripts, and custom assets.",size:"normal"},{default:N(()=>[S(Qt,{modelValue:B.value,"onUpdate:modelValue":p[1]||(p[1]=$=>B.value=$),label:"Yes, I want to replace the current agent with the imported file"},null,8,["modelValue"])]),_:1},8,["actions"])):C("",!0)],64))}}),ba=V(ga,[["__scopeId","data-v-fb5792fb"]]);function ka(e){const r=ye();let a;function o(d){a?r.pushToast({id:a,...d}):a=r.pushToast(d)}ae(e.syncHealth,(d,l)=>{switch(d){case"idle":return o({type:"loading",message:"Connecting to the server",closable:!1,delayMs:1/0});case"connected":return o({message:l==="suspended"?"The server has restarted":"The connection to the server has been restored.",type:"success"});case"offline":return o({type:"loading",message:"Connection was lost due to a network issue or an ongoing update. Please hang tight!",closable:!1,delayMs:1/0});case"suspended":return o({message:"Restarting the server...",type:"loading",closable:!1,delayMs:1/0})}});const s=k(()=>{let d="";switch(e.syncHealth.value){case"offline":d+="Offline. Not syncing.";break;case"connected":d+="Online. Syncing...";break;case"idle":d+="Sync not initialised.";break;case"suspended":d+="Sync suspended.";break}return e.featureFlags.value.length>0&&(d+=` Feature flags: ${e.featureFlags.value.join(", ")}`),d}),i=k(()=>{switch(e.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});return{syncHealthStatus:s,stateDotState:i}}const wa={class:"BuilderHeader"},Sa={class:"BuilderHeader__logo"},Ba=["href"],$a={key:1,src:rt,alt:"Writer Framework logo"},Ca=["disabled"],Ia={class:"BuilderHeader__toolbar"},Aa={class:"BuilderHeader__toolbar__deployBtn"},Pa=R({__name:"BuilderHeader",setup(e){const r=W(U.core),a=K(!1),o=K(!1),s=ve(r),i=ye(),d=At(),{stateDotState:l,syncHealthStatus:B}=ka(r),{canDeploy:w,isDeploying:m,publishApplication:_,hasBeenPublished:h,lastDeployedAt:n,writerDeployUrl:p,name:$}=da(r),y=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function b(){s.track("nav_deploy_clicked"),h.value?I.value=!0:await _()}const I=K(!1),f=[{desc:"Cancel",fn:()=>I.value=!1},{desc:"Yes, deploy changes",fn:async()=>{I.value=!1,await _()}}],g=k(()=>n.value?`Editor Last saved ${y.format(n.value)}`:void 0),P=k(()=>h.value===!0?"Deploy changes":(h.value===!1,"Configure deployment"));function T(){s.track("nav_state_explorer_opened"),a.value=!0}function D(){o.value=!0}async function x(){try{await d.copy(location.href)}catch{i.pushToast({type:"error",message:"Could not copy link."})}}return(M,F)=>(t(),u("div",wa,[c("div",Sa,[v(p)?(t(),u("a",{key:0,href:v(p).toString(),target:"_blank",class:"BuilderHeader__goBack"},F[3]||(F[3]=[c("img",{src:rt,alt:"Writer Framework logo"},null,-1)]),8,Ba)):(t(),u("img",$a)),F[4]||(F[4]=c("hr",null,null,-1)),v(r).isWriterCloudApp.value?me((t(),u("input",{key:2,"onUpdate:modelValue":F[0]||(F[0]=Q=>lt($)?$.value=Q:null),type:"text",disabled:!!v(n),class:"BuilderHeader__logo__appTitle"},null,8,Ca)),[[Pt,v($)]]):C("",!0)]),S(na,{class:"BuilderHeader__switcher"}),c("div",Ia,[F[6]||(F[6]=c("hr",null,null,-1)),S(J,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:T},{default:N(()=>[S(q,{name:"compass"})]),_:1}),S(J,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"Invite collaborators","data-writer-tooltip-placement":"bottom",onClick:D},{default:N(()=>[S(q,{name:"share-2"})]),_:1}),S(ba),v(w)?(t(),A(J,{key:0,size:"small",loading:v(m),"data-writer-tooltip":g.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:b},{default:N(()=>[c("span",Aa,z(P.value),1),I.value?(t(),A(Ie,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:f},{default:N(()=>F[5]||(F[5]=[c("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):C("",!0)]),_:1},8,["loading","data-writer-tooltip"])):C("",!0),S(ha),S(ct,{state:v(l),"data-writer-tooltip":v(B),"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),a.value?(t(),A(Ie,{key:1,title:"State Explorer","display-close-button":"",onClose:F[1]||(F[1]=Q=>a.value=!1)},{default:N(()=>[S(la)]),_:1})):C("",!0),o.value?(t(),A(Ie,{key:2,title:"Share edit link with collaborators",description:"All AI Studio builders in your org can edit this agent with you in real time. Copy the link below to point them directly to editing this agent.","display-close-button":"",actions:[{desc:"Close",fn:()=>o.value=!1},{desc:v(d).copied.value?"Copied":"Copy edit link",fn:x,icon:v(d).copied.value?"check":"clipboard",disabled:v(d).copied.value}],onClose:F[2]||(F[2]=Q=>o.value=!1)},null,8,["actions"])):C("",!0)])]))}}),Ta=V(Pa,[["__scopeId","data-v-80e958e5"]]),Da={class:"text"},xa=200,Ea=4,La=R({__name:"BuilderTooltip",setup(e){const r=ue("rootEl"),a=K(!1),o=K(null);let s=null,i=null;const d=K("top"),l=K({top:0,left:0});async function B(){if(!s||(o.value=s.dataset.writerTooltip,!o.value))return;const n=s.dataset.writerTooltipGap?parseInt(s.dataset.writerTooltipGap):Ea;if(a.value=w(s),!a.value)return;await pe();const{x:p,y:$,width:y,height:b}=s.getBoundingClientRect(),{width:I,height:f}=r.value.getBoundingClientRect();switch(d.value){case"top":l.value.top=$-f-n,l.value.left=p+y/2-I/2;break;case"right":l.value.top=$+b/2-f/2,l.value.left=p+y+n;break;case"left":l.value.left=p-I-n,l.value.top=$+b/2-f/2;break;case"bottom":l.value.top=$+b+n,l.value.left=p+y/2-I/2;break}}function w(n){return n.getAttribute("data-writer-tooltip-strategy")==="overflow"?n.scrollWidth>n.clientWidth:!0}function m(n){const $=n.target.closest("[data-writer-tooltip]");if($)s!==$&&(a.value=!1);else{a.value=!1,s=null;return}s=$,d.value=s.dataset.writerTooltipPlacement??"top",setTimeout(()=>_($),xa)}async function _(n){n===s&&(i==null||i.disconnect(),i=new MutationObserver(B),i.observe(s,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),B())}const h=k(()=>{const{top:n,left:p}=l.value;return{top:`${n}px`,left:`${p}px`}});return ce(()=>{document.documentElement.addEventListener("mouseover",m)}),Be(()=>{document.documentElement.removeEventListener("mouseover",m),i==null||i.disconnect()}),(n,p)=>me((t(),u("div",{ref_key:"rootEl",ref:r,class:"BuilderTooltip",style:Ae(h.value)},[c("div",{class:O(["arrow",d.value])},null,2),c("div",Da,z(o.value),1)],4)),[[Se,a.value]])}}),Ma=V(La,[["__scopeId","data-v-7ba01c7c"]]),Fa=""+new URL("art-paper-D70v1WMA.svg",import.meta.url).href,Na={class:"BuilderPanel__collapser"},Ra={class:"BuilderPanel__title"},za={class:"BuilderPanel__titleCompanion"},Va=["data-order"],Ua={key:0,class:"BuilderPanel__contents__leftPanel"},Wa={class:"BuilderPanel__actions"},qa={class:"BuilderPanel__actionsCompanion"},Oa=R({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean},maxFileSizeLimit:{}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{expose:r,emit:a}){const o=W(U.builderManager),s=["code","log"],i=e,d=k(()=>{if(typeof i.maxFileSizeLimit=="number")return`Files can be up to ${Tt(i.maxFileSizeLimit)}`}),l=a,B=ue("mainContents");r({mainContents:B});const w=k(()=>i.enableDropFile&&m.value),m=K(!1);function _(f,g){i.enableDropFile&&(f.preventDefault(),m.value=g)}function h(f){f.preventDefault(),m.value=!1}function n(f){i.enableDropFile&&f.length>0&&l("filesDrop",f)}const p=k(()=>!o.openPanels.value.has(i.panelId)),$=k(()=>s.indexOf(i.panelId));function y(f){if(o.openPanels.value.has(f)){o.openPanels.value.delete(f),l("openned",!1);return}o.openPanels.value.add(f),l("openned",!0)}function b(f){const g=Et(f);if(g&&f.key==i.keyboardShortcutKey.toLowerCase()){f.preventDefault(),y(i.panelId);return}i.actions.forEach(P=>{if(!P.keyboardShortcut)return;const{key:T,modifierKey:D}=P.keyboardShortcut;T.toLowerCase()==f.key&&(!g&&D||(f.preventDefault(),P.callback()))})}function I(f){if(!f)return"";let g=" (";return f.modifierKey&&(g+=qe()),g+=f.key,g+=")",g}return ce(async()=>{document.addEventListener("keydown",b)}),Be(()=>{document.removeEventListener("keydown",b)}),(f,g)=>(t(),u("div",{class:O(["BuilderPanel",{collapsed:p.value}])},[c("div",Na,[S(J,{variant:"neutral",size:"small","data-automation-action":"toggle-panel","data-automation-key":f.panelId,"data-writer-tooltip":`Toggle ${f.name} (${v(qe)()}${f.keyboardShortcutKey})`,onClick:g[0]||(g[0]=P=>y(f.panelId))},{default:N(()=>[S(q,{name:p.value?"chevron-right":"chevron-up"},null,8,["name"]),c("span",Ra,z(f.name),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),c("div",za,[te(f.$slots,"titleCompanion",{},void 0,!0)]),p.value?C("",!0):(t(),A(xt,{key:0,to:f.contentsTeleportEl},[c("div",{style:Ae({order:$.value}),"data-order":$.value,class:O(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":f.enableLeftPanel,"BuilderPanel__contents--dropingFile":w.value}]),onDrop:h,onDragover:g[1]||(g[1]=P=>_(P,!0)),onDragleave:g[2]||(g[2]=P=>_(P,!1))},[w.value?(t(),A(Dt,{key:0,multiple:"",label:"Drop files here",restrictions:d.value,onDrop:n},null,8,["restrictions"])):(t(),u(H,{key:1},[f.enableLeftPanel?(t(),u("div",Ua,[te(f.$slots,"leftPanel",{},void 0,!0)])):C("",!0),c("div",Wa,[c("div",qa,[te(f.$slots,"actionsCompanion",{},void 0,!0)]),(t(!0),u(H,null,ne(f.actions,(P,T)=>(t(),A(J,{key:T,"data-writer-tooltip":P.name+I(P.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:P.isDisabled,onClick:P.callback},{default:N(()=>[S(q,{name:P.icon},null,8,["name"])]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),c("div",{ref_key:"mainContents",ref:B,class:"BuilderPanel__mainContents"},[te(f.$slots,"default",{},void 0,!0)],512)],64))],46,Va)],8,["to"]))],2))}}),pt=V(Oa,[["__scopeId","data-v-5ccf1c14"]]),je=150;function Ha(e){const r=K(structuredClone(be(e.sourceFiles.value)));ae(e.sourceFiles,(b,I)=>{let f=!1,g=structuredClone(be(r.value));const P=d(I).map(a);for(const T of Xe(b)){const D=le(T,I),x=le(T,b);if(we(x))continue;if(D===void 0||Me(x)){g=We(T,g,structuredClone(be(x))),f=!0;continue}if(!_e(D))continue;const M=!D.complete&&x.complete,F=D.complete&&x.complete;if(!M&&!F)continue;const Q=a(T);if(P.includes(Q))continue;const Z=le(T,g);_e(Z)&&(f=!0,Z.complete=!0,Z.content=x.content)}for(const T of Lt(g))le(T,b)===void 0&&(g=Mt(T,g),f=!0);f&&(r.value=g)});function a(b){return b.join("/")}const o=Le(),s=k(()=>Array.from(Xe(r.value))),i=k(()=>d(e.sourceFiles.value));function d(b){return s.value.filter(I=>{const f=le(I,r.value);if(Me(f))return!1;if(!_e(f))return!0;const g=le(I,b);return _e(g)?!f.complete||!g.complete?!1:f.content!==g.content:!0})}const l=k(()=>{if(o.value!==void 0)return le(o.value,r.value)}),B=k({get(){return _e(l.value)?l.value.content:""},set(b){if(o.value===void 0)return;const I=le(o.value,r.value);_e(I)&&(I.content=b)}});function w(b=1){const I=`new-file-${b}.txt`;return le([I],r.value)?w(b+1):I}async function m(){const b=w();r.value=We([b],be(r.value)),n([b]),await e.sendCreateSourceFileRequest([b])}const _=k(()=>{var I;return(I=o.value)!=null&&I.length?o.value.at(-1).split(".").at(-1):""}),h=k(()=>{switch(_.value){case"py":return"python";case"js":case"mjs":return"javascript";case"ts":return"typescript";case"md":case"markdown":return"markdown";default:return _.value}});function n(b){o.value=b,_e(l.value)&&!l.value.complete&&e.requestSourceFileLoading(b)}async function p(b){if(!(!o.value||!l.value)&&(l.value.type==="file"&&await e.sendCodeSaveRequest(B.value,o.value),b)){const I=[...be(o.value)];o.value=void 0;try{await e.sendRenameSourceFileRequest(I,b)}catch(f){throw o.value=I,f}n(b)}}function $(b){return new Promise((I,f)=>{const g=new FileReader;g.addEventListener("loadend",P=>{const T=P.target.result;if(T instanceof ArrayBuffer){const D=String.fromCharCode.apply(null,new Uint8Array(T));return I(D)}I(T.split(",")[1])}),g.addEventListener("error",()=>{f()}),g.readAsDataURL(b)})}async function y(b){const I=je*1024*1024;if(b.size>I)throw Error(`Cannot upload file bigger than ${je}mb`);const f=[b.name];if(le(f,e.sourceFiles.value))throw Error(`The file ${b.name} already exists`);r.value=We(f,be(r.value),{type:"binary",uploading:!0});const g=await $(b);await e.sendFileUploadRequest(f,g)}return{code:B,sourceFileDraft:r,fileOpen:l,filepathOpen:o,pathsUnsaved:i,openedFileLanguage:h,save:p,upload:y,openFile:n,openNewFile:m,getNewFilename:w}}const ja={class:"BuilderTree"},Ka=["draggable","data-automation-key","aria-expanded"],Ga=["data-writer-tooltip"],Ya={key:1,class:"BuilderTree__main__dropdown"},Za=R({__name:"BuilderTree",props:Oe({name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},variant:{type:String,required:!1,default:void 0},noNestedSpace:{type:Boolean,required:!1},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0},disableCollapse:{type:Boolean,required:!1}},{collapsed:{type:Boolean,required:!1,default:!1},collapsedModifiers:{}}),emits:Oe({expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},["update:collapsed"]),setup(e,{expose:r,emit:a}){const o=ie({loader:()=>de(()=>import("./index-D2TgG8aI.js").then(h=>h.bp),__vite__mapDeps([0,1]),import.meta.url)}),s=e,i=a;r({expand:m,toggleCollapse:_});const d=st(e,"collapsed"),l=K(!1),B=k(()=>!s.matched),w=k(()=>!s.hasChildren);function m(){d.value=!1,i("expandBranch")}function _(h){h??(h=!d.value),h!==d.value&&(d.value=h)}return(h,n)=>(t(),u("div",ja,[c("div",{class:O(["BuilderTree__main",{selected:e.selected,notMatched:B.value,childless:w.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!d.value,onMouseenter:n[2]||(n[2]=p=>l.value=!0),onMouseleave:n[3]||(n[3]=p=>l.value=!1),onClick:n[4]||(n[4]=p=>h.$emit("select",p)),onKeydown:n[5]||(n[5]=dt(p=>h.$emit("select",p),["enter"])),onDragover:n[6]||(n[6]=p=>h.$emit("dragover",p)),onDragstart:n[7]||(n[7]=p=>h.$emit("dragstart",p)),onDragend:n[8]||(n[8]=p=>h.$emit("dragend",p)),onDrop:n[9]||(n[9]=p=>h.$emit("drop",p))},[e.hasChildren&&!e.disableCollapse?(t(),A(J,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:n[0]||(n[0]=it(p=>_(void 0),["stop"]))},{default:N(()=>[S(q,{name:d.value?"chevron-down":"chevron-up"},null,8,["name"])]),_:1},8,["disabled"])):C("",!0),te(h.$slots,"nameLeft",{},void 0,!0),c("span",{class:O(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled,"BuilderTree__main__name--root":e.variant==="root"}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},z(e.name),11,Ga),te(h.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&l.value?(t(),u("div",Ya,[S(v(o),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:n[1]||(n[1]=p=>h.$emit("dropdownSelect",p))},null,8,["options"])])):C("",!0)],42,Ka),S(Ft,null,{default:N(()=>[me(c("div",{class:O(["BuilderTree__children",{"BuilderTree__children--noNestedSpace":e.noNestedSpace}])},[te(h.$slots,"children",{},void 0,!0)],2),[[Se,!d.value&&e.hasChildren]])]),_:3})]))}}),Xa=V(Za,[["__scopeId","data-v-8c085d0a"]]),Ja=["width","height","viewBox","aria-valuenow"],Qa=["r","cx","cy","stroke","stroke-width"],en=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],tn=R({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const r=e,a=k(()=>r.sizePx/2),o=k(()=>r.sizePx/2-r.strokeWidth/2),s=k(()=>2*Math.PI*o.value),i=k(()=>s.value*((100-r.progress)/100)),d=k(()=>`0 0 ${r.sizePx} ${r.sizePx}`);return(l,B)=>(t(),u("svg",{width:e.sizePx,height:e.sizePx,viewBox:d.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[c("circle",{r:o.value,cx:a.value,cy:a.value,fill:"transparent",stroke:v(Fe).Blue1,"stroke-width":e.strokeWidth},null,8,Qa),c("circle",{r:o.value,cx:a.value,cy:a.value,fill:"transparent",stroke:v(Fe).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":s.value,"stroke-dashoffset":i.value},null,8,en)],8,Ja))}}),an=R({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const r=e,a=K(0);return ce(()=>{let o;const s=i=>{o||(o=i);const d=i-o;a.value=Math.min(d/r.timeMs*100,100),a.value<100&&requestAnimationFrame(s)};requestAnimationFrame(s)}),(o,s)=>(t(),A(tn,{class:"BuilderCodePanelFileUploading",progress:a.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),nn=V(an,[["__scopeId","data-v-449f2dac"]]),Qe=[{label:"Delete",value:"delete",icon:"trash-2"}],on=R({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:r}){const a=e,o=r;function s(n){return n.join("/")}const i=k(()=>s(a.pathActive)),d=k(()=>a.pathsUnsaved.map(s)),l=k(()=>we(a.sourceFiles)?Object.entries(a.sourceFiles.children).sort((n,p)=>n[0].localeCompare(p[0])):[]);function B(n){const p=le([...a.path,n],a.sourceFiles);return Me(p)&&p.uploading}function w(n){const p=s([...a.path,n]);return d.value.includes(p)}function m(n){return s([...a.path,n])===i.value}function _(n){if(!we(a.sourceFiles)||B(n))return;const p=a.sourceFiles.children[n];we(p)||o("select",[...a.path,n])}function h(n,p){n==="delete"&&o("delete",[...a.path,p])}return(n,p)=>(t(),u("div",null,[(t(!0),u(H,null,ne(l.value,([$,y])=>(t(),A(Xa,{key:$,name:$,matched:"","has-children":v(we)(y),selected:m($),disabled:B($),"right-click-options":Qe,"dropdown-options":v(we)(y)||v(Me)(y)?Qe:void 0,onSelect:b=>_($),onDropdownSelect:b=>h(b,$)},Nt({children:N(()=>[S(vt,{"source-files":y,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,$],onSelect:p[0]||(p[0]=b=>n.$emit("select",b)),onDelete:p[1]||(p[1]=b=>n.$emit("delete",b))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[B($)||w($)?{name:"nameLeft",fn:N(()=>[B($)?(t(),A(nn,{key:0,"time-ms":2e3})):w($)?(t(),A(ct,{key:1,state:"newDraft"})):C("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),vt=V(on,[["__scopeId","data-v-13c86c55"]]),rn=["disabled"],ln={class:"WdsButtonLink__text"},sn=R({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disabled:{type:Boolean}},setup(e){const r=e,a=k(()=>[`WdsButtonLink--variant-${r.variant}`,`WdsButtonLink--weight-${r.weight}`]);return(o,s)=>(t(),u("button",{class:O(["WdsButtonLink",a.value]),disabled:e.disabled,type:"button"},[e.leftIcon?(t(),A(q,{key:0,name:e.leftIcon},null,8,["name"])):C("",!0),c("span",ln,z(e.text),1),e.rightIcon?(t(),A(q,{key:1,name:e.rightIcon},null,8,["name"])):C("",!0)],10,rn))}}),mt=V(sn,[["__scopeId","data-v-f2cbc67f"]]),dn={class:"BuilderCodePanelFileUploadBtn"},un=R({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:r}){const a=ue("input"),o=r;function s(){const{files:i}=a.value;i instanceof FileList&&i.length>0&&(o("selected",Array.from(i)),a.value.value="")}return(i,d)=>(t(),u("form",dn,[me(c("input",{ref_key:"input",ref:a,type:"file",multiple:"",onChange:s},null,544),[[Se,!1]]),S(mt,{"left-icon":"upload",text:"Upload",onClick:d[0]||(d[0]=l=>v(a).click())})]))}}),cn={class:"BuilderCodePanel__tree"},pn={class:"BuilderCodePanel__tree__actions"},vn={key:1,class:"BuilderCodePanel__noPreview"},mn={class:"BuilderCodePanel__actionsCompanion"},fn=R({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const r=ie({loader:()=>de(()=>import("./index-D2TgG8aI.js").then(L=>L.bp),__vite__mapDeps([0,1]),import.meta.url)}),a=ie({loader:()=>de(()=>import("./BuilderEmbeddedCodeEditor-A12DxFS_.js").then(L=>L.B),__vite__mapDeps([2,0,1,3]),import.meta.url)}),o=W(U.core),s=[{label:"Rename file",value:"rename",icon:"pencil"},{label:"Delete file",value:"delete",icon:"trash-2",variant:"danger"}],i=ve(o),{sourceFileDraft:d,openFile:l,upload:B,openNewFile:w,code:m,openedFileLanguage:_,filepathOpen:h,fileOpen:n,pathsUnsaved:p,save:$}=Ha(o);async function y(L){await Promise.all(L.map(b))}async function b(L){try{await B(L),f({type:"success",message:`File ${L.name} uploaded`})}catch(Y){f({type:"error",message:Y.message})}}const I=k(()=>{var L;return(L=n.value)==null?void 0:L.type}),{pushToast:f}=ye(),g=tt();function P(L){const Y=new AbortController;ce(()=>{document.addEventListener("keydown",async oe=>{const ze=oe.metaKey||oe.ctrlKey,Ve=oe.key==="s"||oe.key==="S";!ze||!Ve||(oe.preventDefault(),await L())},{signal:Y.signal})}),Be(()=>Y.abort())}P($e);const T=ue("filenameEl"),D=K(""),x=K(!1),M=k(()=>{var L;return((L=h.value)==null?void 0:L.join("/"))??""}),F=k(()=>M.value!=="main.py"),Q=k(()=>M.value!==D.value),Z=k(()=>x.value||M.value==="main.py"),se=k(()=>Q.value?!1:h.value===void 0?!0:!p.value.map(L=>L.join("/")).includes(M.value));ae(h,()=>{var L;D.value=((L=h.value)==null?void 0:L.join("/"))??""}),ae(o.sessionTimestamp,()=>{x.value=!1});function he(L){L&&(i.track("nav_code_opened"),h.value===void 0&&l(["main.py"]))}async function Te(){var L;M.value!=="main.py"&&(await pe(),(L=T.value)==null||L.focus())}async function Ne(L){switch(L){case"rename":return Te();case"delete":await xe(h.value)}}async function De(){await w(),Te()}async function xe(L){await o.sendDeleteSourceFileRequest(L),f({type:"success",message:"The file was deleted"}),h.value.join("/").startsWith(L.join("/"))&&l(["main.py"])}async function $e(){if(h.value===void 0)return f({type:"error",message:"There is no file open"});if(se.value)return f({type:"info",message:"There are not file changes to save"});x.value=!0;const L=Q.value?D.value.split("/"):void 0;if(L){const Y=Re(L);if(Y)return f({type:"error",message:Y})}try{await $(L),f({type:"success",message:"The file was saved"}),i.track("nav_code_file_updated",{path:h.value})}catch(Y){g.error("The file hasn't been saved.",Y),f({type:"error",message:"The file hasn't been saved"});return}finally{x.value=!1}}function Re(L){return L[0]===""?"Path should not have a leading slash":L[0]===".wf"?".wf is reserved for Writer Framework":L.some(Y=>Y==="")?"Invalid path":null}return(L,Y)=>(t(),A(pt,{"panel-id":"code",name:"Code","contents-teleport-el":L.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"","max-file-size-limit":v(je)*1e3*1e3,onFilesDrop:y,onOpenned:he},{leftPanel:N(()=>[c("div",cn,[S(vt,{"path-active":v(h),"paths-unsaved":v(p),"source-files":v(d),onAddFile:De,onSelect:v(l),onDelete:xe},null,8,["path-active","paths-unsaved","source-files","onSelect"]),c("div",pn,[S(mt,{"left-icon":"plus",text:"Add file",onClick:De}),S(un,{onSelected:y})])])]),actionsCompanion:N(()=>[c("div",mn,[S(ut,{ref_key:"filenameEl",ref:T,modelValue:D.value,"onUpdate:modelValue":Y[1]||(Y[1]=oe=>D.value=oe),disabled:!F.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:dt($e,["enter"])},null,8,["modelValue","disabled"]),S(J,{variant:"primary",size:"small",disabled:x.value||se.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:$e},{default:N(()=>[S(q,{name:"save"}),Y[3]||(Y[3]=G(" Save file "))]),_:1},8,["disabled"]),S(v(r),{disabled:Z.value,options:s,onSelect:Ne},null,8,["disabled"])])]),default:N(()=>[I.value==="file"?(t(),A(v(a),{key:0,modelValue:v(m),"onUpdate:modelValue":Y[0]||(Y[0]=oe=>lt(m)?m.value=oe:null),variant:"full",language:v(_),disabled:x.value},null,8,["modelValue","language","disabled"])):C("",!0),I.value==="binary"?(t(),u("div",vn,Y[2]||(Y[2]=[c("img",{class:"BuilderCodePanel__noPreview__img",src:Fa},null,-1),c("p",{class:"BuilderCodePanel__noPreview__title"},"Canâ€™t Preview File",-1),c("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):C("",!0)]),_:1},8,["contents-teleport-el","max-file-size-limit"]))}}),_n=V(fn,[["__scopeId","data-v-c9f7bb95"]]),yn={class:"BuiderLogBlueprintExecutionTrace"},hn={key:0,class:"trace"},gn={class:"type"},bn={key:0},kn={key:1},wn={class:"main"},Sn={key:0},Bn={key:1},$n={key:2},Cn={key:3},In={class:"details"},An={class:"data","data-automation-key":"result"},Pn={key:1,class:"nothing"},Tn={class:"data","data-automation-key":"return-value"},Dn={class:"environment"},xn={class:"data"},En={key:1,class:"nothing"},Ln={class:"callStack"},Mn={class:"eyebrow"},Fn=R({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:r}){const a=W(U.core),o=W(U.builderManager),s=ve(a),i=r,{goToComponentParentPage:d}=Pe(a,o),l=e,B=k(()=>{var h;const _=((h=l.executionItem.executionEnvironment)==null?void 0:h.call_stack)??[];return Object.fromEntries(_.map(n=>[n,a.getComponentById(n)]))}),w=k(()=>{var _;return((_=l.executionItem.executionEnvironment)==null?void 0:_.trace)??[]});ce(()=>{s.track("blueprints_logs_trace_opened")});async function m(_){i("closeModal"),o.setMode("blueprints"),await pe(),d(_),await pe(),o.setSelection(_,void 0,"log")}return(_,h)=>{var n,p,$;return t(),u("div",yn,[w.value.length>0?(t(),u("div",hn,[(t(!0),u(H,null,ne(w.value,(y,b)=>(t(),u("div",{key:b,class:"traceEntry"},[c("div",gn,[y.type=="functionCall"?(t(),u("span",bn,"âš¡ï¸")):C("",!0),y.type=="reasoning"?(t(),u("span",kn,"ðŸ§ ")):C("",!0)]),c("div",wn,[y.thought?(t(),u("div",Sn,[h[0]||(h[0]=c("strong",null,"Thought.",-1)),G(" "+z(y.thought),1)])):C("",!0),y.action?(t(),u("div",Bn,[h[1]||(h[1]=c("strong",null,"Action.",-1)),G(" "+z(y.action),1)])):C("",!0),y.name?(t(),u("div",$n,z(y.name),1)):C("",!0),y.parameters?(t(),u("div",Cn,[S(Ce,{"hide-root":!0,data:y.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):C("",!0)])]))),128))])):C("",!0),c("div",In,[c("div",null,[h[2]||(h[2]=c("h3",null,"Result",-1)),h[3]||(h[3]=c("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),c("div",An,[(n=_.executionItem)!=null&&n.result?(t(),A(Ce,{key:0,data:_.executionItem.result,"initial-depth":1},null,8,["data"])):(t(),u("div",Pn,"No result."))])]),c("div",null,[h[4]||(h[4]=c("h3",null,"Return value",-1)),h[5]||(h[5]=c("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),c("div",Tn,[(p=_.executionItem)!=null&&p.returnValue?(t(),A(Ce,{key:0,data:_.executionItem.returnValue,"initial-depth":1},null,8,["data"])):(t(),u(H,{key:1},[G(" No return value. ")],64))])])]),c("div",Dn,[h[6]||(h[6]=c("h3",null,"Execution environment",-1)),h[7]||(h[7]=c("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),c("div",xn,[($=_.executionItem)!=null&&$.executionEnvironment?(t(),A(Ce,{key:0,data:_.executionItem.executionEnvironment,"initial-depth":1},null,8,["data"])):(t(),u("div",En,"Empty execution environment."))])]),c("div",Ln,[h[8]||(h[8]=c("h3",null,"Call stack",-1)),(t(!0),u(H,null,ne(B.value,(y,b)=>{var I,f,g;return t(),u("div",{key:b,class:O(["component",{active:b==_.executionItem.componentId}])},[c("div",null,[c("div",Mn,[b==_.executionItem.componentId?(t(),u(H,{key:0},[G(" This block Â· ")],64)):C("",!0),G(" "+z(((I=v(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:I.name)??"Unavailable component")+" Â· Id: "+z(b),1)]),G(" "+z(((f=y==null?void 0:y.content)==null?void 0:f.alias)??((g=v(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:g.name)??"Unavailable component"),1)]),y?(t(),A(J,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:P=>m(b)},{default:N(()=>[S(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):C("",!0)],2)}),128))])])}}}),Nn=V(Fn,[["__scopeId","data-v-f98f57c8"]]),Rn={class:"BuilderListItem"},zn=["viewBox"],Vn=["d","stroke"],Un=["d","stroke"],Wn={class:"BuilderListItem__content"},qn=R({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:Fe.Blue2},colorLast:{type:String,required:!1,default:Fe.Blue2}},setup(e){const r=e,a=k(()=>r.height/2),o=k(()=>`0 0 17 ${r.height}`),s=k(()=>["M1 0",`V${a.value-8}`,`C1 ${a.value-4}.4183 4.58172 ${a.value} 9 ${a.value}`,"H17"].join(" ")),i=k(()=>[`M1 ${a.value-8}`,`V${r.height}`].join(" "));return(d,l)=>(t(),u("div",Rn,[(t(),u("svg",{viewBox:o.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?C("",!0):(t(),u("path",{key:0,d:i.value,stroke:e.colorLast,"stroke-width":"1"},null,8,Vn)),c("path",{d:s.value,stroke:e.color,"stroke-width":"1"},null,8,Un)],8,zn)),c("div",Wn,[te(d.$slots,"default",{},void 0,!0)])]))}}),On=V(qn,[["__scopeId","data-v-33f3edcd"]]),Hn={class:"BuilderLogBlueprintExecution"},jn={class:"name"},Kn={key:0},Gn={class:"eyebrow"},Yn={class:"outcome"},Zn={class:"result"},Xn={class:"time"},Jn={key:0,class:"message markdown"},Qn=R({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const r=W(U.core),a=W(U.builderManager),{goToComponentParentPage:o}=Pe(r,a),s=e,i=K(null),d={in_progress:5,error:4,success:3,stopped:2,skipped:1,none:0},l=k(()=>({summary:[...s.executionLog.summary.filter(_=>!!_.outcome).filter(_=>(d[_.outcome]??d.success)>1).map(_=>({..._,component:r.getComponentById(_.componentId),componentDef:r.getComponentById(_.componentId)?r.getComponentDefinition(r.getComponentById(_.componentId).type):void 0}))]}));async function B(m){a.setMode("blueprints"),await pe(),o(m),await pe(),a.setSelection(m,void 0,"log")}function w(m){return m<0?"N/A":m<.1?"< 0.1s":`${m.toFixed(2)}s`}return(m,_)=>{const h=Rt("dompurify-html");return t(),u("div",Hn,[(t(!0),u(H,null,ne(l.value.summary,(n,p)=>(t(),A(On,{key:p,"is-last":p+1===l.value.summary.length},{default:N(()=>{var $,y,b,I,f,g,P,T,D,x,M,F;return[c("div",{class:O(["itemWrapper",{"itemWrapper--first":p===0,"itemWrapper--last":p+1===l.value.summary.length}])},[c("div",{class:O(["item",{selected:v(a).isComponentIdSelected(n.componentId)}])},[c("div",jn,[(y=($=n.component)==null?void 0:$.content)!=null&&y.alias?(t(),u("div",Kn,[c("div",Gn,z(((b=n.componentDef)==null?void 0:b.name)??"Unavailable component"),1),G(" "+z((f=(I=n.component)==null?void 0:I.content)==null?void 0:f.alias),1)])):(t(),u(H,{key:1},[G(z(((g=n.componentDef)==null?void 0:g.name)??"Unavailable component"),1)],64)),n.component?(t(),A(J,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:Q=>B(n.componentId)},{default:N(()=>[S(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):C("",!0)]),c("div",Yn,[n.outcome!=="in_progress"?(t(),u(H,{key:0},[c("div",{class:O(["ball",(D=(T=(P=n.componentDef)==null?void 0:P.outs)==null?void 0:T[n.outcome])==null?void 0:D.style])},null,2),G(" "+z(((F=(M=(x=n.componentDef)==null?void 0:x.outs)==null?void 0:M[n.outcome])==null?void 0:F.name)??n.outcome),1)],64)):(t(),u(H,{key:1},[_[1]||(_[1]=c("div",{class:"ballContainer"},[c("div",{class:"ball inProgress"})],-1)),_[2]||(_[2]=G(" In progress... "))],64))]),c("div",Zn,[i.value==p?(t(),A(Ie,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>i.value=null}]},{default:N(()=>[S(Nn,{"execution-item":n,onCloseModal:_[0]||(_[0]=()=>i.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):C("",!0),n.result||n.returnValue||n.executionEnvironment?(t(),A(J,{key:1,variant:"special",size:"small",onClick:()=>i.value=p},{default:N(()=>[S(q,{name:"file-search-2"}),_[3]||(_[3]=G(" Trace "))]),_:2},1032,["onClick"])):C("",!0)]),c("div",Xn,z(w(n.executionTimeInSeconds)),1),n.message?me((t(),u("div",Jn,null,512)),[[h,v(ea).parse(n.message)]]):C("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),eo=V(Qn,[["__scopeId","data-v-a691c27b"]]),to={class:"BuilderLogIndicator"},ao={key:0,class:"number error"},no={class:"icon"},oo={key:1,class:"number info"},ro={class:"icon"},lo=R({__name:"BuilderLogIndicator",setup(e){const r=W(U.builderManager),a=k(()=>r.getLogEntries().reduce((o,s)=>(s.type in o||(o[s.type]=0),o[s.type]++,o),{}));return(o,s)=>(t(),u("div",to,[a.value.error>0?(t(),u("div",ao,[c("div",no,[S(q,{name:"triangle-alert"})]),G(" "+z(a.value.error??0),1)])):C("",!0),a.value.info>0?(t(),u("div",oo,[c("div",ro,[S(q,{name:"info"})]),G(" "+z(a.value.info??0),1)])):C("",!0)]))}}),so=V(lo,[["__scopeId","data-v-f0898ae9"]]),io={key:0,class:"entries"},uo={class:"icon"},co={class:"title"},po={class:"time"},vo={class:"content"},mo={key:0,class:"codeContainer"},fo={key:1,class:"emptyMessage"},_o=R({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const r=W(U.core),a=W(U.builderManager),o=ue("panel"),s=ve(r);async function i(w){w&&(s.track("nav_logs_opened"),await pe(),await B())}const d=[{icon:"trash-2",name:"Clear log",callback:()=>{a.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],l=k(()=>a.getLogEntries());async function B(){var p;const w=(p=o.value)==null?void 0:p.mainContents;if(!w)return;const m=w.querySelector(".item.selected");if(!m)return;const _=w.getBoundingClientRect(),h=m.getBoundingClientRect(),n=w.scrollTop+(h.top-_.top)-(_.height/2-h.height/2);w.scrollTo({top:n,behavior:"smooth"})}return ae(a.selection,async()=>{await pe(),await B()}),(w,m)=>(t(),A(pt,{ref_key:"panel",ref:o,"panel-id":"log",name:"Log","contents-teleport-el":w.contentsTeleportEl,actions:d,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:i},{titleCompanion:N(()=>[S(so)]),default:N(()=>[l.value.length>0?(t(),u("div",io,[(t(!0),u(H,null,ne(l.value,(_,h)=>(t(),u(H,{key:h},[c("div",{class:O(["entry",_.type])},[c("div",uo,[S(q,{name:_.type==="error"?"triangle-alert":"info"},null,8,["name"])]),c("div",co,z(_.title)+z(_.repeated>0?` Â· Repeated ${_.repeated} times`:""),1),c("div",po,z(_.timestampReceived.toLocaleTimeString()),1),c("div",vo,[G(z(_.message)+" ",1),_.code?(t(),u("div",mo,[c("code",null,z(_.code),1)])):C("",!0)])],2),_.blueprintExecution?(t(),A(eo,{key:0,"execution-log":_.blueprintExecution},null,8,["execution-log"])):C("",!0)],64))),128))])):C("",!0),l.value.length==0?(t(),u("div",fo,m[0]||(m[0]=[c("div",null,[G(" Exceptions and other relevant messages will be shown here."),c("br"),G("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):C("",!0)]),_:1},8,["contents-teleport-el"]))}}),yo=V(_o,[["__scopeId","data-v-5bf9ec81"]]),ho={class:"switches"},go=R({__name:"BuilderPanelSwitcher",setup(e){const r=W(U.builderManager),a=ue("screenEl");return(o,s)=>(t(),u("div",{class:O(["BuilderPanelSwitcher",{openPanels:v(r).openPanels.value.size>0}])},[c("div",{ref_key:"screenEl",ref:a,class:"screen"},null,512),c("div",ho,[S(_n,{"contents-teleport-el":v(a)},null,8,["contents-teleport-el"]),S(yo,{"contents-teleport-el":v(a)},null,8,["contents-teleport-el"])])],2))}}),bo=V(go,[["__scopeId","data-v-93f8be10"]]),ko=["href"],wo=["disabled"],So=R({__name:"BuilderSidebarButton",props:{icon:{type:String,required:!0},active:{type:Boolean},disabled:{type:Boolean},href:{type:String,required:!1,default:void 0}},setup(e){return(r,a)=>e.href?(t(),u("a",{key:0,class:"BuilderSidebarButton",href:e.href},[S(q,{name:e.icon},null,8,["name"])],8,ko)):(t(),u("button",{key:1,class:O(["BuilderSidebarButton",{"BuilderSidebarButton--active":e.active}]),role:"button",disabled:e.disabled},[S(q,{name:e.icon},null,8,["name"])],10,wo))}}),ke=V(So,[["__scopeId","data-v-044cd21a"]]),Bo={class:"BuilderSidebarVersion"},$o={class:"BuilderSidebarVersion__capsule"},Co=R({__name:"BuilderSidebarVersion",props:{version:{type:String,required:!0}},setup(e){return(r,a)=>(t(),u("span",Bo,[c("span",$o," BETA "+z(e.version),1)]))}}),Io=V(Co,[["__scopeId","data-v-bbae565d"]]),Ao={key:0,class:"BuilderSidebarPanel__inputContainer"},Po={class:"BuilderSidebarPanel__footer"},To=R({__name:"BuilderSidebarPanel",props:Oe({hideSearchBar:{type:Boolean,required:!1},placeholder:{type:String,required:!1,default:""},searchCount:{type:Number,required:!1,default:void 0}},{modelValue:{type:String,required:!1,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const r=st(e,"modelValue"),a=e,o=k(()=>{if(a.searchCount!==void 0)return`${a.searchCount} result${a.searchCount===1?"":"s"}`}),s=K(!1);function i(d){d.target instanceof HTMLElement&&(s.value=d.target.scrollTop>0)}return(d,l)=>(t(),u("div",{class:O(["BuilderSidebarPanel",{"BuilderSidebarPanel--mainScrollSeparator":s.value}])},[e.hideSearchBar?C("",!0):(t(),u("div",Ao,[S(ut,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=B=>r.value=B),class:"searchInput","left-icon":"search","data-automation-action":"search",placeholder:e.placeholder,"right-text":o.value,"right-icon":r.value?"x":void 0,onRightIconClick:l[1]||(l[1]=B=>r.value="")},null,8,["modelValue","placeholder","right-text","right-icon"])])),c("div",{class:"BuilderSidebarPanel__main",onScroll:i},[te(d.$slots,"default",{},void 0,!0)],32),c("div",Po,[te(d.$slots,"footer",{},void 0,!0)])],2))}}),Do=V(To,[["__scopeId","data-v-fcaea8d5"]]),xo=["data-note-id"],Eo={class:"BuilderSidebarNote__header"},Lo={class:"BuilderSidebarNote__header__avatar"},Mo={class:"BuilderSidebarNote__header__avatar__type"},Fo={class:"BuilderSidebarNote__header__info"},No={key:1},Ro={key:0,class:"BuilderSidebarNote__header__actions"},zo={key:0,class:"BuilderSidebarNote__content"},Vo={key:0},Uo=R({__name:"BuilderSidebarNote",props:{component:{type:Object,required:!0},excerpt:{type:Boolean}},emits:{select:()=>!0,edit:()=>!0,delete:()=>!0},setup(e,{emit:r}){const a=e,{user:o}=zt(),s=r,i=W(U.notesManager),{createdAtFormatted:d,type:l,content:B,createdBy:w}=i.useNoteInformation(k(()=>a.component)),{user:m,isLoading:_,error:h}=at(w),n=k(()=>_.value||h.value),p=k(()=>B.value.length<100?B.value:`${B.value.slice(0,100)}...`),$=k(()=>B.value.split(`
`)),y=k(()=>m.value?[m.value.firstName,m.value.lastName].filter(Boolean).join(" "):""),b=k(()=>{var f;if(((f=o.value)==null?void 0:f.id)===w.value)return[{value:"edit",label:"Edit",icon:"pencil"},{value:"delete",label:"Delete",icon:"trash-2",variant:"danger"}]});function I(f){switch(f){case"edit":return s("edit");case"delete":return s("delete")}}return(f,g)=>(t(),u("div",{class:"BuilderSidebarNote","data-note-id":e.component.id,tabindex:"0",onClick:g[0]||(g[0]=P=>f.$emit("select"))},[c("div",Eo,[c("div",Lo,[c("div",Mo,[v(l)==="blueprints"?(t(),A(q,{key:0,name:"wds-blueprints"})):v(l)==="ui"?(t(),A(q,{key:1,name:"frame"})):C("",!0)]),S(Ge,{"user-id":v(w)},null,8,["user-id"])]),c("div",Fo,[n.value?(t(),A(nt,{key:0,class:"BuilderSidebarNote__header__info__loader"})):(t(),u("p",No,z(y.value),1)),c("p",null,z(v(d)),1)]),b.value?(t(),u("div",Ro,[S(ot,{options:b.value,"trigger-custom-size":"16px",onSelect:I},null,8,["options"])])):C("",!0)]),v(B)?(t(),u("div",zo,[e.excerpt?(t(),u("p",Vo,z(p.value),1)):(t(!0),u(H,{key:1},ne($.value,(P,T)=>(t(),u("p",{key:T},z(P),1))),128))])):C("",!0)],8,xo))}}),et=V(Uo,[["__scopeId","data-v-4129b8b4"]]),Wo={},qo={class:"BuilderSidebarNotesEmpty"};function Oo(e,r){return t(),u("div",qo,r[0]||(r[0]=[Vt('<svg width="77" height="77" viewBox="0 0 77 77" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-98d925a1><circle cx="38.5" cy="38.5" r="38.5" fill="#E4E9FF" data-v-98d925a1></circle><path d="M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778V30.1111Z" fill="white" data-v-98d925a1></path><path d="M32.6667 35.4444H43.3333H32.6667Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778M32.6667 35.4444H43.3333M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" data-v-98d925a1></path></svg><h5 data-v-98d925a1>No Notes</h5><p data-v-98d925a1>Click anywhere on a blueprint or interface to add a note</p>',3)]))}const Ho=V(Wo,[["render",Oo],["__scopeId","data-v-98d925a1"]]),jo={class:"BuilderSidebarNoteForm"},Ko=R({__name:"BuilderSidebarNoteForm",props:{component:{type:Object,required:!0},autofocus:{type:Boolean}},emits:{submit:e=>typeof e=="string"},setup(e){const r=e,a=W(U.notesManager),o=K(a.getNoteContent(r.component));return(s,i)=>(t(),u("div",jo,[S(Ut,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=d=>o.value=d),class:"BuilderSidebarNoteForm__input",autofocus:e.autofocus},null,8,["modelValue","autofocus"]),S(J,{class:"BuilderSidebarNoteForm__submit",variant:"secondary",size:"smallIcon",disabled:!o.value,onClick:i[1]||(i[1]=d=>s.$emit("submit",o.value))},{default:N(()=>[S(q,{name:"send"})]),_:1},8,["disabled"])]))}}),Go=V(Ko,[["__scopeId","data-v-157847b0"]]),Yo={key:0,class:"BuilderSidebarNotes__note"},Zo={key:2,class:"BuilderSidebarNotes__notes"},Xo=R({__name:"BuilderSidebarNotes",setup(e){const r=W(U.core),a=W(U.builderManager),{selectedNote:o,selectNote:s,selectedNoteMode:i,selectedNoteId:d,getAllNotes:l,searchNotes:B,deleteNote:w,hoveredNoteId:m,useNoteInformation:_}=W(U.notesManager),{createAndInsertComponent:h}=Pe(r,a),n=Wt({componentId:d,fieldKey:"content"}),p=K(""),$=k(()=>Array.from(l()).toSorted(I)),y=k(()=>Array.from(B(p.value)).toSorted(I)),b=k(()=>!!(o.value||$.value.length===0));function I(P,T){const D=_(P).createdAt.value,x=_(T).createdAt.value;return new Date(x).getTime()-new Date(D).getTime()}function f(P){return _(P).state.value}function g(P){r.getComponentById(d.value)?n.value=P:h(o.value.type,o.value.parentId,void 0,{content:{...o.value.content,content:P},x:o.value.x,y:o.value.y}),s(void 0)}return(P,T)=>(t(),A(Do,{modelValue:p.value,"onUpdate:modelValue":T[4]||(T[4]=D=>p.value=D),class:"BuilderSidebarNotes","hide-search-bar":b.value},{default:N(()=>[v(o)?(t(),u("div",Yo,[v(i)==="edit"?(t(),A(Go,{key:0,component:v(o),autofocus:"",onSubmit:g},null,8,["component"])):(t(),A(et,{key:1,component:v(o),onGoBack:T[0]||(T[0]=D=>v(s)(void 0)),onEdit:T[1]||(T[1]=D=>v(s)(v(d),"edit")),onDelete:T[2]||(T[2]=D=>v(w)(v(d)))},null,8,["component"]))])):y.value.length===0?(t(),A(Ho,{key:1})):(t(),u("div",Zo,[(t(!0),u(H,null,ne(y.value,D=>(t(),A(et,{key:D.id,component:D,class:O(["BuilderSidebarNotes__notes__note",{"BuilderSidebarNotes__notes__note--hover":f(D)==="hover"}]),excerpt:"",onSelect:x=>v(s)(D.id,"show"),onEdit:x=>v(s)(D.id,"edit"),onDelete:x=>v(w)(D.id),onMouseenter:x=>m.value=D.id,onMouseleave:T[3]||(T[3]=x=>m.value=void 0)},null,8,["component","class","onSelect","onEdit","onDelete","onMouseenter"]))),128))]))]),_:1},8,["modelValue","hide-search-bar"]))}}),Jo=V(Xo,[["__scopeId","data-v-3dc5600c"]]),Qo={class:"BuilderSidebar"},er={class:"BuilderSidebar__toolbar"},tr={key:0,class:"BuilderSidebar__toolbar__top"},ar={key:1,class:"BuilderSidebar__toolbar__center"},nr={class:"BuilderSidebar__toolbar__bottom"},or={key:0,class:"BuilderSidebar__pane"},rr={key:1},lr=R({__name:"BuilderSidebar",emits:{activePaneChanged:e=>e===void 0||typeof e=="string"},setup(e,{emit:r}){const a=ie({loader:()=>de(()=>import("./BuilderSidebarToolkit-DUY1CbzX.js"),__vite__mapDeps([4,0,1,5,6,7,8]),import.meta.url)}),o=ie({loader:()=>de(()=>import("./BuilderSidebarComponentTree-B9sgGPPv.js"),__vite__mapDeps([9,0,1,10,5,6,7,11]),import.meta.url)});function s(x){return typeof x=="string"&&["layers","add"].includes(x)}const i=W(U.core),d=W(U.builderManager),l=W(U.notesManager),B=r,w=k(()=>h()),{undo:m,redo:_,getUndoRedoSnapshot:h}=Pe(i,d),n=k(()=>d.mode.value==="preview"),p="1.17.0rc8",$=qt("activePane",s),y=K(n.value?void 0:$.value),b=k(()=>y.value!=="notes"?!1:l.selectedNoteId.value!==void 0);function I(){y.value==="notes"&&l.selectNote(void 0)}ae(y,()=>{l.isAnnotating.value=y.value==="notes"},{immediate:!0}),ae(n,()=>{n.value&&y.value}),ae(l.selectedNoteId,()=>{l.selectedNoteId.value&&(y.value="notes")});const f=k(()=>({layers:d.mode.value==="ui"?"Interface Layers":"Blueprint Layers",add:"Add block",notes:"Notes"})),g=qe();async function P(x){if(!(!(He()?x.metaKey:x.ctrlKey)||x.target.closest("textarea, input, select")))switch(x.key){case"l":x.preventDefault(),y.value="layers";break;case"Enter":x.preventDefault(),y.value="add";break}}const T=new AbortController;ce(()=>{document.addEventListener("keydown",P,{signal:T.signal})}),Be(()=>T.abort());function D(x){y.value=y.value===x?void 0:x,$.value=y.value,l.selectNote(void 0),B("activePaneChanged",x)}return(x,M)=>(t(),u("div",Qo,[c("div",er,[n.value?C("",!0):(t(),u("div",tr,[M[6]||(M[6]=c("hr",null,null,-1)),S(ke,{icon:"layers","data-writer-tooltip-placement":"right","data-writer-tooltip":`${f.value.layers} (${v(g)}L)`,active:y.value==="layers","data-automation-action":"sidebar-layers",onClick:M[0]||(M[0]=F=>D("layers"))},null,8,["data-writer-tooltip","active"]),S(ke,{icon:"wds-blocks","data-writer-tooltip-placement":"right","data-writer-tooltip":`${f.value.add} (${v(g)}Enter)`,active:y.value==="add","data-automation-action":"sidebar-add",onClick:M[1]||(M[1]=F=>D("add"))},null,8,["data-writer-tooltip","active"]),v(i).isWriterCloudApp.value?(t(),A(ke,{key:0,icon:"message-square","data-writer-tooltip-placement":"right","data-writer-tooltip":`${f.value.notes}`,active:y.value==="notes","data-automation-action":"sidebar-notes",onClick:M[2]||(M[2]=F=>D("notes"))},null,8,["data-writer-tooltip","active"])):C("",!0)])),n.value?C("",!0):(t(),u("div",ar,[M[7]||(M[7]=c("hr",null,null,-1)),S(ke,{icon:"undo-2","data-automation-key":"undo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Undo (${v(g)}Z)`,disabled:!w.value.isUndoAvailable,onClick:M[3]||(M[3]=F=>v(m)())},null,8,["data-writer-tooltip","disabled"]),S(ke,{"data-automation-key":"redo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Redo (${v(g)}Y)`,icon:"redo-2",disabled:!w.value.isRedoAvailable,onClick:M[4]||(M[4]=F=>v(_)())},null,8,["data-writer-tooltip","disabled"])])),c("div",nr,[v(p)?(t(),A(Io,{key:0,version:v(p)},null,8,["version"])):C("",!0),M[8]||(M[8]=c("hr",null,null,-1)),S(ke,{target:"_blank",href:"https://dev.writer.com/agent-builder/overview",icon:"circle-question-mark","data-writer-tooltip-placement":"right","data-writer-tooltip":"Docs"})])]),y.value&&!n.value?(t(),u("div",or,[c("div",{class:O(["BuilderSidebar__pane__header",{"BuilderSidebar__pane__header--goBack":b.value}])},[b.value?(t(),u(H,{key:0},[S(J,{variant:"neutral",size:"smallIcon",onClick:I},{default:N(()=>[S(q,{name:"arrow-left"})]),_:1}),M[9]||(M[9]=c("h2",null,"Back",-1))],64)):(t(),u("h2",rr,z(f.value[y.value]),1)),S(J,{variant:"neutral",size:"smallIcon",onClick:M[5]||(M[5]=F=>y.value=void 0)},{default:N(()=>[S(q,{name:"arrow-left-to-line"})]),_:1})],2),y.value==="add"?(t(),A(v(a),{key:0})):C("",!0),y.value==="layers"?(t(),A(v(o),{key:1})):C("",!0),y.value==="notes"?(t(),A(Jo,{key:2})):C("",!0)])):C("",!0)]))}}),sr=V(lr,[["__scopeId","data-v-bf0b63b3"]]),ir={class:"WdsToast__icon"},dr=R({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const r=e,a=k(()=>{switch(r.type){case"info":return"info";case"success":return"check";case"error":return"x";default:return"circle-question-mark"}});return(o,s)=>(t(),u("div",{class:O(["WdsToast",`WdsToast--${e.type}`])},[c("div",ir,[e.type==="loading"?(t(),A(Ot,{key:0,size:18,color:"white"})):e.type==="info"?(t(),u(H,{key:1},[G("i")],64)):(t(),A(q,{key:2,name:a.value},null,8,["name"]))]),c("p",null,z(e.message),1),e.action?(t(),u("button",{key:0,class:"WdsToast__action",onClick:s[0]||(s[0]=(...i)=>e.action.func&&e.action.func(...i))},[G(z(e.action.label)+" ",1),e.type==="info"?(t(),u(H,{key:0},[G("i")],64)):(t(),A(q,{key:1,name:e.action.icon},null,8,["name"]))])):C("",!0),e.closable?(t(),A(J,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:s[1]||(s[1]=i=>o.$emit("close"))},{default:N(()=>[S(q,{name:"x"})]),_:1})):C("",!0)],2))}}),ur=V(dr,[["__scopeId","data-v-aa18760d"]]),cr={class:"BuilderToasts"},pr=R({__name:"BuilderToasts",setup(e){const{toasts:r,removeToast:a}=ye();return(o,s)=>(t(),u("div",cr,[S(Ht,{name:"list",tag:"div"},{default:N(()=>[(t(!0),u(H,null,ne(v(r),i=>(t(),A(ur,{key:i.id,class:"BuilderToasts__toast",closable:i.closable,message:i.message,type:i.type,action:i.action,onClick:d=>i.closable!==!1?v(a)(i.id):void 0},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),vr=V(pr,[["__scopeId","data-v-a5d06336"]]),mr=200,fr=36,_r=R({__name:"BuilderInstanceTracker",props:{instancePath:{},matchSize:{type:Boolean},verticalOffsetPixels:{},isOffBoundsAllowed:{type:Boolean},preventSettingsBarOverlap:{type:Boolean}},setup(e,{expose:r}){const a=e,{instancePath:o,matchSize:s,verticalOffsetPixels:i,isOffBoundsAllowed:d,preventSettingsBarOverlap:l}=jt(a),B=Le({});let w=0;const m=ue("rootEl");function _(y){const b=document.querySelector(".ComponentRenderer"),{top:I,left:f}=y.getBoundingClientRect(),{clientHeight:g}=document.body,{clientWidth:P}=b,{left:T}=b.getBoundingClientRect(),D=document.querySelector(".BuilderSettings"),{left:x}=(D==null?void 0:D.getBoundingClientRect())||{left:1/0};let{clientHeight:M,clientWidth:F}=(s!=null&&s.value?y:m.value)??{};if(M===void 0||F===void 0)return;let Q=i!=null&&i.value?i.value:0,Z=f,se=I+Q;if(d.value||(Z=Math.max(T,Z),Z=Math.min(T+P-F,Z),se=Math.max(fr,se),se=Math.min(g-M,se)),l.value){let he=0;Z+F>x&&(he=Math.max(Z-(x-F),0)),Z-=he}B.value={display:"block",top:`${se}px`,left:`${Z}px`,width:`${F}px`,height:`${M}px`}}function h(){B.value={display:"none"}}function n(){let y=document.querySelector(`.ComponentRenderer [data-writer-instance-path="${o.value}"]`);if(!y){h();return}const b=getComputedStyle(y);if(!b){h();return}if(b.display=="contents"&&(y=y.querySelector("[data-writer-id]")),!y){h();return}_(y)}function p(){w=requestAnimationFrame(async()=>{n(),!$.signal.aborted&&(await new Promise(y=>setTimeout(y,mr)),p())})}const $=Ke();return r({refresh:n}),ce(async()=>{window.addEventListener("scroll",n,{signal:$.signal}),p()}),Be(()=>{cancelAnimationFrame(w)}),(y,b)=>(t(),u("div",{ref_key:"rootEl",ref:m,class:"BuilderInstanceTracker",style:Ae(B.value)},[te(y.$slots,"default",{},void 0,!0)],4))}}),Ee=V(_r,[["__scopeId","data-v-c3e9e555"]]),yr={ref:"rootEl",class:"BuilderCollaborationTracker"},hr={class:"bubble"},gr={class:"main"},br=R({__name:"BuilderCollaborationTracker",setup(e){const r=W(U.collaborationManager);function a(o){return!(Kt(o).length<=2)}return(o,s)=>(t(),u("div",yr,[(t(!0),u(H,null,ne(v(r).connectedUsersByInstancePath.value,(i,d)=>(t(),u(H,{key:d},[a(d)?(t(),A(Ee,{key:0,"is-off-bounds-allowed":!1,"instance-path":d,"vertical-offset-pixels":-32,class:"instanceTracker"},{default:N(()=>[c("div",hr,[c("div",gr,[(t(!0),u(H,null,ne(i,l=>(t(),A(Ge,{key:l,"show-tooltip":!0,"user-id":l},null,8,["user-id"]))),128))]),s[0]||(s[0]=c("div",{class:"triangle"},null,-1))])]),_:2},1032,["instance-path"])):C("",!0)],64))),128))],512))}}),kr=V(br,[["__scopeId","data-v-15c19d63"]]),wr={class:"ShareResizeVertical__top"},Sr={class:"ShareResizeVertical__divider"},Br={class:"ShareResizeVertical__bottom"},$r=R({__name:"ShareResizeVertical",props:{initialBottomSize:{type:Number,required:!0},disabled:{type:Boolean,required:!1}},setup(e){const r=e,a=ue("root"),o=Ke(),s=Gt(r,"initialBottomSize");let i=K(s.value);ae(s,()=>i.value=s.value);const d=k(()=>({gridTemplateRows:`minmax(0px, 1fr) 1px ${i.value}px`}));function l(){if(!a.value)return;document.addEventListener("mousemove",w,{signal:o.signal}),document.addEventListener("mouseup",m,{signal:o.signal});const B=a.value.getBoundingClientRect();function w(_){i.value=B.bottom-_.clientY}function m(){document.removeEventListener("mouseup",m),document.removeEventListener("mousemove",w)}}return(B,w)=>(t(),u("div",{ref_key:"root",ref:a,class:"ShareResizeVertical",style:Ae(d.value)},[c("div",wr,[te(B.$slots,"top",{},void 0,!0)]),c("div",Sr,[e.disabled?C("",!0):(t(),u("div",{key:0,class:"ShareResizeVertical__divider__hand",onMousedown:it(l,["prevent"])},null,32))]),c("div",Br,[te(B.$slots,"bottom",{},void 0,!0)])],4))}}),Cr=V($r,[["__scopeId","data-v-0de30584"]]),Ir={class:"builderMain"},Ar=R({__name:"BuilderApp",setup(e){Yt(U.isAutogenModalShown,K(!1));const r=ie({loader:()=>de(()=>import("./BuilderSettings-Bxu9nRAh.js").then(E=>E.b),__vite__mapDeps([12,0,1,10,13,5,6,14,15,16,17]),import.meta.url)}),a=ie({loader:()=>de(()=>import("./ComponentRenderer-ChvAkG3h.js"),__vite__mapDeps([18,0,1,19]),import.meta.url)}),o=ie({loader:()=>de(()=>import("./BuilderInsertionOverlay-D13-u_XP.js"),__vite__mapDeps([20,0,1,21]),import.meta.url)}),s=ie({loader:()=>de(()=>import("./BuilderInsertionLabel-1wm2Xqy7.js"),__vite__mapDeps([22,0,1,23]),import.meta.url)}),i=ie({loader:()=>de(()=>import("./BuilderVault-BUt2H-II.js"),__vite__mapDeps([24,15,0,1,16,25]),import.meta.url)}),d=W(U.core),l=W(U.builderManager),B=W(U.notesManager),w=W(U.collaborationManager),m=ve(d),_=ye(),h=ue("noteEl");function n(){if(h.value!=null&&typeof h.value[Symbol.iterator]=="function")for(const ee of h.value)ee.refresh()}const{candidateId:p,candidateInstancePath:$,isCandidacyConfirmed:y,dropComponent:b,assignInsertionCandidacy:I,removeInsertionCandidacy:f}=Jt(d),{createAndInsertComponent:g,undo:P,redo:T,moveComponent:D,moveComponentUp:x,moveComponentDown:M,cutComponent:F,isPasteAllowed:Q,isCopyAllowed:Z,isCutAllowed:se,isDeleteAllowed:he,isGoToParentAllowed:Te,isGoToChildAllowed:Ne,isGoToNextSiblingAllowed:De,isGoToPrevSiblingAllowed:xe,pasteComponent:$e,copyComponent:Re,removeComponentsSubtree:L,goToParent:Y,goToChild:oe,goToNextSibling:ze,goToPrevSibling:Ve,moveComponentToParent:ft,moveComponentInsideNextSibling:_t}=Pe(d,l,m),re=l.mode,yt=l.firstSelectedId,Ye=k(()=>l.openPanels.value.size>0),ht=k(()=>Array.from(B.getNotes(d.activePageId.value)).map(E=>({...E,parentInstancePath:B.useNoteInformation(E).parentInstancePath.value})).filter(E=>E.parentInstancePath!==void 0));async function gt(E){if(E.key=="Escape"){l.setSelection(null);return}const ee=He()?E.metaKey:E.ctrlKey;if(E.target.closest("textarea, input, select, [contenteditable]"))return;if(E.key=="z"&&ee){E.preventDefault(),P();return}if(E.key=="y"&&ee){E.preventDefault(),T();return}if(!l.isSingleSelectionActive.value||!l.firstSelectedItem.value)return;const{componentId:j,instancePath:ge}=l.firstSelectedItem.value;if(E.key==(He()?"Backspace":"Delete")){const fe=l.selection.value.filter(Ue=>he(Ue.componentId)).map(Ue=>Ue.componentId);L(...fe);return}if(ee)if(E.shiftKey)switch(E.key){case"ArrowDown":E.preventDefault(),De(j)&&ze(j);break;case"ArrowUp":E.preventDefault(),xe(j)&&Ve(j);break;case"ArrowLeft":E.preventDefault(),Te(j)&&Y(j,ge);break;case"ArrowRight":E.preventDefault(),Ne(j)&&oe(j);break}else switch(E.key){case"ArrowDown":E.preventDefault(),M(j);break;case"ArrowUp":E.preventDefault(),x(j);break;case"ArrowLeft":E.preventDefault(),ft(j);break;case"ArrowRight":E.preventDefault(),_t(j);break;case"v":if(!Q(j))return;try{await $e(j)}catch(fe){_.pushToast({type:"error",message:String(fe)})}break;case"c":Z(j)&&Re(j);break;case"x":se(j)&&F(j);break}}function bt(E){re.value!=="preview"&&I(E)}function kt(E){if(re.value==="preview")return;l.setSelection(null);const ee=b(E);if(!ee)return;const{draggedType:X,draggedId:j,parentId:ge,position:fe}=ee;j?D(j,ge,fe):g(X,ge,fe)}function wt(E){if(re.value==="preview"||E.target.closest("[data-writer-unselectable]"))return;const X=E.target.closest("[data-writer-id]");if(!X)return;const j=X.dataset.writerId,ge=X.dataset.writerInstancePath;l.isComponentIdSelected(j)&&l.selectionStatus.value!==Je.Multiple||B.isAnnotating.value||(E.preventDefault(),E.stopPropagation(),l.handleSelectionFromEvent(E,j,ge,"click"))}function St(){l.isSettingsBarCollapsed.value=!1}const Bt=E=>{if(re.value==="preview")return;const X=E.target.closest("[data-writer-id]").dataset.writerId,{type:j}=d.getComponentById(X);l.selectionStatus.value===Je.Multiple&&(l.setSelection(X,void 0,"click"),l.isSettingsBarCollapsed.value=!0),E.dataTransfer.setData(`application/json;writer=${j},${X}`,"{}")};function $t(E){l.setSelection(null),f(E)}const Ze=new AbortController;return ae(l.selection,()=>{w&&(w.updateOutgoingPing({action:"select",selection:l.selection.value}),w.sendCollaborationPing())}),ce(()=>{document.addEventListener("keydown",gt,{signal:Ze.signal})}),Be(()=>{Ze.abort()}),(E,ee)=>(t(),u("div",{class:"BuilderApp",tabindex:"-1",style:Ae(v(Xt))},[c("div",{class:O(["mainGrid",{openPanels:v(l).openPanels.value.size>0}])},[S(Ta,{class:"builderHeader"}),me(S(sr,{class:"sidebar",onActivePaneChanged:n},null,512),[[Se,v(re)==="ui"||v(re)==="blueprints"]]),S(Cr,{"initial-bottom-size":Ye.value?440:48,disabled:!Ye.value,class:O({"mainGrid--fullWidth":v(re)==="preview"||v(re)==="vault"})},{top:N(()=>[c("div",Ir,[v(re)==="vault"?(t(),A(v(i),{key:0})):(t(),u("div",{key:1,class:O(["rendererWrapper",{addNoteCursor:v(B).isAnnotating.value&&v(l).mode.value!=="preview"}]),onScroll:n},[S(v(a),{class:O(["componentRenderer",{settingsOpen:v(l).isSingleSelectionActive}]),onDragover:bt,onDragstart:Bt,onDragend:$t,onDrop:kt,onClickCapture:wt,onDblclick:St},null,8,["class"])],34)),v(l).isSingleSelectionActive?(t(),A(v(r),{key:v(yt)??"noneSelected"})):C("",!0)])]),bottom:N(()=>[S(bo,{class:"panelSwitcher"})]),_:1},8,["initial-bottom-size","disabled","class"])],2),v(re)!=="preview"?(t(),u(H,{key:0},[S(kr,{class:"collaborationTracker"}),v(p)&&!v(y)?(t(),u(H,{key:0},[(t(),A(Ee,{key:v($),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":v($),"match-size":!0},{default:N(()=>[S(v(o))]),_:1},8,["instance-path"])),(t(),A(Ee,{key:v($),class:"insertionLabelTracker","instance-path":v($),"vertical-offset-pixels":-48},{default:N(()=>[S(v(s),null,{default:N(()=>[G(z(v(d).getComponentDefinition(v(d).getComponentById(v(p)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):C("",!0)],64)):C("",!0),v(re)==="ui"?(t(!0),u(H,{key:1},ne(ht.value,X=>(t(),A(Ee,{key:X.id,ref_for:!0,ref_key:"noteEl",ref:h,class:"BuilderApp__noteTracker","is-off-bounds-allowed":!0,"instance-path":X.parentInstancePath,"match-size":!0},{default:N(()=>[S(Zt,{class:"BuilderApp__noteTracker__note","component-id":X.id},null,8,["component-id"])]),_:2},1032,["instance-path"]))),128)):C("",!0),ee[0]||(ee[0]=c("div",{id:"modal"},null,-1)),S(Ma,{id:"tooltip"}),S(vr)],4))}}),Pr=V(Ar,[["__scopeId","data-v-452da39b"]]),Er=Object.freeze(Object.defineProperty({__proto__:null,default:Pr},Symbol.toStringTag,{value:"Module"}));export{Do as B,mt as W,Xa as a,On as b,Er as c};
