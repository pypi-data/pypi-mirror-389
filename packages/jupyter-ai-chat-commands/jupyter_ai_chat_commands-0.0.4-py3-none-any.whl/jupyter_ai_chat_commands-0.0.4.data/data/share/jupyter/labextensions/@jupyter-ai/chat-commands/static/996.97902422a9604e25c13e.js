"use strict";(self.webpackChunk_jupyter_ai_chat_commands=self.webpackChunk_jupyter_ai_chat_commands||[]).push([[996],{1996:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var n=r(1297),a=r(6860),o=r(3345),s=r.n(o),i=r(1845),c=r(82);const l="@jupyter-ai/core:file-command-provider";class d{constructor(e,t){this.id=l,this._regex=/@file:(([\w/\-_.@]|\\ )+)/g,this._contentsManager=e,this._docRegistry=t}async listCommandCompletions(e){const t=e.currentWord;if(!t||!t.startsWith("@"))return[];if(t.startsWith("@file:")){const e=t.split("@file:")[1],r=await async function(e,t,r){const[n,a]=function(e){var t;const r=e.split("/");let n,a;return 1===r.length?(n="",a=r[0]):(n=r.slice(0,-1).join("/")+"/",a=null!==(t=r[r.length-1])&&void 0!==t?t:""),[n,a]}(r),o=await e.get(n.replaceAll("\\ "," ")),s=[];if(!Array.isArray(o.content))return[];const i=o.content.filter(e=>e.name.toLowerCase().startsWith(a.toLowerCase())).sort((e,t)=>{const r=("directory"===e.type?-1:1)-("directory"===t.type?-1:1),n=e.name<t.name?-1:1;return r||n});for(const e of i){const{icon:r}=t.getFileTypeForModel(e);let a,o="@file:"+n+e.name;o=o.replaceAll(/(?<!\\) /g,"\\ "),a="directory"===e.type?{name:e.name+"/",providerId:l,icon:r,description:"Search this directory",replaceWith:o+"/"}:{name:e.name,providerId:l,icon:r,description:"Attach this file",replaceWith:o,spaceOnAccept:!0},s.push(a)}return s}(this._contentsManager,this._docRegistry,e);return r}return"@file".startsWith(t)?[{name:"@file:",providerId:this.id,description:"Include a file with your prompt",icon:s().createElement(c.A,null)}]:[]}async onSubmit(e){var t;const r=Array.from(e.value.matchAll(this._regex)),n=[];for(const e of r)e.length<2||n.push(e[1]);for(let r of n)r=r.replaceAll("\\ "," "),null===(t=e.addAttachment)||void 0===t||t.call(e,{type:"file",value:r});e.value=e.value.replaceAll(this._regex,(e,t)=>`\`${t.replaceAll("\\ "," ")}\``)}}const p={id:"@jupyter-ai/core:file-command-plugin",description:"Adds support for the @file command in Jupyter AI.",autoStart:!0,requires:[i.IChatCommandRegistry],activate:(e,t)=>{const{serviceManager:r,docRegistry:n}=e;t.addProvider(new d(r.contents,n))}};var u=r(2702);class h{constructor(){this.id="@jupyter-ai/core:slash-command-provider",this._regex=/\/([\w-]*)/g,this._slash_commands=[{name:"/refresh-personas",providerId:this.id,description:"Refresh available personas",icon:s().createElement(u.A,null),spaceOnAccept:!0}]}async listCommandCompletions(e){const t=function(e){let t=0;for(;t<e.length&&/\s/.test(e[t]);)t++;let r=t;for(;r<e.length&&!/\s/.test(e[r]);)r++;return e.substring(t,r)||null}(e.value);return e.currentWord!==t?[]:t&&t.startsWith("/")?this._slash_commands.filter(e=>e.name.startsWith(t)):[]}async onSubmit(e){}}const m=[{id:"@jupyter-ai/chat-commands:plugin",description:"Package providing the set of default chat commands in Jupyter AI.",autoStart:!0,activate:e=>{console.log("JupyterLab extension @jupyter-ai/chat-commands is activated!"),async function(e="",t={}){const r=a.ServerConnection.makeSettings(),o=n.URLExt.join(r.baseUrl,"jupyter-ai-chat-commands",e);let s;try{s=await a.ServerConnection.makeRequest(o,t,r)}catch(e){throw new a.ServerConnection.NetworkError(e)}let i=await s.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",s)}if(!s.ok)throw new a.ServerConnection.ResponseError(s,i.message||i);return i}("get-example").then(e=>{console.log(e)}).catch(e=>{console.error(`The jupyter_ai_chat_commands server extension appears to be missing.\n${e}`)})}},p,{id:"@jupyter-ai/core:slash-command-plugin",description:"Adds support for slash commands in Jupyter AI.",autoStart:!0,requires:[i.IChatCommandRegistry],activate:(e,t)=>{t.addProvider(new h)}}]}}]);