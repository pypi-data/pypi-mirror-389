"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8350],{58350:(e,o,n)=>{n.r(o),n.d(o,{default:()=>x});var t=n(65043),r=n(97326),l=n(22019),a=n(85672),s=n(6051),i=n(12624),c=n(8354),d=n(42261),g=n(10491),m=n(15492),h=n(76399),p=n(25558),u=n(32513),f=n(73847),C=n(95240),b=n(70579);const{Panel:y}=r.A,x=e=>{let{visible:o,onClose:n}=e;const[x,v]=(0,t.useState)(null),[j,w]=(0,t.useState)(""),[k,A]=(0,t.useState)(!1);(0,t.useEffect)(()=>{o&&O()},[o]);const O=async()=>{try{const e=await fetch("/api/mcp/shell-config");if(e.ok){const o=await e.json();v(o)}}catch(e){console.error("Failed to fetch shell config:",e),v({enabled:!0,allowedCommands:[],gitOperationsEnabled:!0,safeGitOperations:[],timeout:30})}},S=async e=>{try{await fetch("/api/mcp/toggle-server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:"shell",enabled:e})})}catch(o){console.warn("Failed to sync MCP server toggle:",o)}},$=()=>{x&&j.trim()&&!x.allowedCommands.includes(j.trim())&&(v(e=>({...e,allowedCommands:[...e.allowedCommands,j.trim()]})),w(""))},E=["rm","rmdir","mv","cp","chmod","chown","sudo","su"],B=e=>E.some(o=>e.toLowerCase().includes(o.toLowerCase()));return x?(0,b.jsx)(a.A,{title:"Shell Command Configuration",open:o,onCancel:n,onOk:async()=>{if(x){A(!0);try{const e=await fetch("/api/mcp/shell-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(e.ok){const o=await e.json();o.success?(await S(x.enabled),window.dispatchEvent(new CustomEvent("mcpStatusChanged",{detail:{serverName:"shell",enabled:x.enabled}})),l.Ay.success(o.message||"Shell configuration updated instantly")):l.Ay.error(o.message||"Failed to update shell configuration"),n()}else l.Ay.error("Failed to save shell configuration")}catch(e){l.Ay.error("Failed to save shell configuration"),console.error("Save error:",e)}finally{A(!1)}}},confirmLoading:k,width:600,okText:"Save Configuration",children:(0,b.jsxs)(s.A,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(s.A,{align:"center",children:[(0,b.jsx)(i.A,{checked:x.enabled,onChange:async e=>{v(o=>({...o,enabled:e})),await S(e)}}),(0,b.jsx)("span",{children:"Enable shell command execution"})]}),(0,b.jsx)("div",{style:{marginTop:8,color:"#666",fontSize:"12px"},children:"When enabled, the AI agent can execute whitelisted shell commands"})]}),(0,b.jsx)(c.A,{}),(0,b.jsx)(d.A,{message:"Security Notice",description:"Only enable commands that are safe for AI execution. Git operations are limited to read-only and safe operations by default.",type:"info",showIcon:!0,style:{marginBottom:16}}),(0,b.jsxs)(r.A,{defaultActiveKey:["1"],ghost:!0,children:[(0,b.jsxs)(y,{header:"Basic Configuration",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{children:"Allowed Commands"}),(0,b.jsx)("div",{style:{marginBottom:12,color:"#666",fontSize:"12px"},children:"Commands that the AI agent can execute. These are loaded from the server configuration."}),(0,b.jsx)("div",{style:{marginBottom:12},children:(0,b.jsxs)(g.A.Group,{compact:!0,children:[(0,b.jsx)(g.A,{placeholder:"Add additional command",value:j,onChange:e=>w(e.target.value),onPressEnter:$,style:{width:"calc(100% - 80px)"}}),(0,b.jsx)(m.Ay,{type:"primary",icon:(0,b.jsx)(f.A,{}),onClick:$,style:{width:80},children:"Add"})]})}),x.allowedCommands&&x.allowedCommands.length>0&&(0,b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:16},children:x.allowedCommands.map(e=>(0,b.jsxs)(h.A,{closable:!0,color:B(e)?"red":"blue",onClose:()=>(e=>{x&&v(o=>({...o,allowedCommands:o.allowedCommands.filter(o=>o!==e)}))})(e),style:{marginBottom:"4px"},children:[e,B(e)&&(0,b.jsx)(C.A,{style:{marginLeft:4,color:"#ff4d4f"}})]},e))})]}),(0,b.jsx)(c.A,{}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{children:["Command Timeout: ",x.timeout,"s"]}),(0,b.jsx)(p.A,{min:10,max:600,value:x.timeout,onChange:e=>v(o=>({...o,timeout:e})),marks:{10:"10s",60:"1m",120:"2m",300:"5m",600:"10m"},style:{width:"100%",marginBottom:20}})]}),(0,b.jsx)(c.A,{}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(s.A,{align:"center",style:{marginBottom:12},children:[(0,b.jsx)(i.A,{checked:x.gitOperationsEnabled,onChange:e=>v(o=>({...o,gitOperationsEnabled:e}))}),(0,b.jsx)("span",{children:"Enable safe Git operations"})]}),(0,b.jsx)("div",{style:{marginBottom:12,color:"#666",fontSize:"12px"},children:"When enabled, allows read-only and safe Git commands"}),x.gitOperationsEnabled&&(0,b.jsxs)("div",{style:{marginLeft:24},children:[(0,b.jsx)("h5",{children:"Allowed Git Operations:"}),(0,b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:["status","log","show","diff","branch","remote","config --get","ls-files","ls-tree","blame","tag","stash list","reflog","rev-parse","describe","shortlog","whatchanged"].map(e=>(0,b.jsxs)(u.A,{checked:x.safeGitOperations.includes(e),onChange:()=>(e=>{x&&v(o=>({...o,safeGitOperations:o.safeGitOperations.includes(e)?o.safeGitOperations.filter(o=>o!==e):[...o.safeGitOperations,e]}))})(e),children:["git ",e]},e))})]})]})]},"1"),(0,b.jsx)(y,{header:"Advanced Configuration",children:(0,b.jsx)(d.A,{message:"Advanced Configuration",description:"This section is reserved for future advanced shell configuration options.",type:"info",showIcon:!0})},"2")]})]})}):(0,b.jsx)(a.A,{title:"Shell Command Configuration",open:o,onCancel:n,footer:null,children:(0,b.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:"Loading configuration..."})})}},76399:(e,o,n)=>{n.d(o,{A:()=>B});var t=n(65043),r=n(98139),l=n.n(r),a=n(18574),s=n(11128),i=n(55391),c=n(12701),d=n(12366),g=n(35296),m=n(7896),h=n(61857),p=n(94414),u=n(78446),f=n(78855);const C=e=>{const{lineWidth:o,fontSizeIcon:n,calc:t}=e,r=e.fontSizeSM;return(0,u.oX)(e,{tagFontSize:r,tagLineHeight:(0,m.zA)(t(e.lineHeightSM).mul(r).equal()),tagIconSize:t(n).sub(t(o).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},b=e=>({defaultBg:new h.Y(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText}),y=(0,f.OF)("Tag",e=>(e=>{const{paddingXXS:o,lineWidth:n,tagPaddingHorizontal:t,componentCls:r,calc:l}=e,a=l(t).sub(n).equal(),s=l(o).sub(n).equal();return{[r]:Object.assign(Object.assign({},(0,p.dF)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:a,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,m.zA)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${r}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${r}-close-icon`]:{marginInlineStart:s,fontSize:e.tagIconSize,color:e.colorIcon,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${r}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${r}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:a}}),[`${r}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}})(C(e)),b);var x=function(e,o){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(t=Object.getOwnPropertySymbols(e);r<t.length;r++)o.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(n[t[r]]=e[t[r]])}return n};const v=t.forwardRef((e,o)=>{const{prefixCls:n,style:r,className:a,checked:s,children:i,icon:c,onChange:d,onClick:m}=e,h=x(e,["prefixCls","style","className","checked","children","icon","onChange","onClick"]),{getPrefixCls:p,tag:u}=t.useContext(g.QO),f=p("tag",n),[C,b,v]=y(f),j=l()(f,`${f}-checkable`,{[`${f}-checkable-checked`]:s},null===u||void 0===u?void 0:u.className,a,b,v);return C(t.createElement("span",Object.assign({},h,{ref:o,style:Object.assign(Object.assign({},r),null===u||void 0===u?void 0:u.style),className:j,onClick:e=>{null===d||void 0===d||d(!s),null===m||void 0===m||m(e)}}),c,t.createElement("span",null,i)))}),j=v;var w=n(8835);const k=(0,f.bf)(["Tag","preset"],e=>(e=>(0,w.A)(e,(o,n)=>{let{textColor:t,lightBorderColor:r,lightColor:l,darkColor:a}=n;return{[`${e.componentCls}${e.componentCls}-${o}`]:{color:t,background:l,borderColor:r,"&-inverse":{color:e.colorTextLightSolid,background:a,borderColor:a},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}}))(C(e)),b);const A=(e,o,n)=>{const t="string"!==typeof(r=n)?r:r.charAt(0).toUpperCase()+r.slice(1);var r;return{[`${e.componentCls}${e.componentCls}-${o}`]:{color:e[`color${n}`],background:e[`color${t}Bg`],borderColor:e[`color${t}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},O=(0,f.bf)(["Tag","status"],e=>{const o=C(e);return[A(o,"success","Success"),A(o,"processing","Info"),A(o,"error","Error"),A(o,"warning","Warning")]},b);var S=function(e,o){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(t=Object.getOwnPropertySymbols(e);r<t.length;r++)o.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(n[t[r]]=e[t[r]])}return n};const $=t.forwardRef((e,o)=>{const{prefixCls:n,className:r,rootClassName:m,style:h,children:p,icon:u,color:f,onClose:C,bordered:b=!0,visible:x}=e,v=S(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:j,direction:w,tag:A}=t.useContext(g.QO),[$,E]=t.useState(!0),B=(0,a.A)(v,["closeIcon","closable"]);t.useEffect(()=>{void 0!==x&&E(x)},[x]);const P=(0,s.nP)(f),T=(0,s.ZZ)(f),I=P||T,N=Object.assign(Object.assign({backgroundColor:f&&!I?f:void 0},null===A||void 0===A?void 0:A.style),h),z=j("tag",n),[F,G,L]=y(z),H=l()(z,null===A||void 0===A?void 0:A.className,{[`${z}-${f}`]:I,[`${z}-has-color`]:f&&!I,[`${z}-hidden`]:!$,[`${z}-rtl`]:"rtl"===w,[`${z}-borderless`]:!b},r,m,G,L),W=e=>{e.stopPropagation(),null===C||void 0===C||C(e),e.defaultPrevented||E(!1)},[,M]=(0,i.A)((0,i.d)(e),(0,i.d)(A),{closable:!1,closeIconRender:e=>{const o=t.createElement("span",{className:`${z}-close-icon`,onClick:W},e);return(0,c.fx)(e,o,e=>({onClick:o=>{var n;null===(n=null===e||void 0===e?void 0:e.onClick)||void 0===n||n.call(e,o),W(o)},className:l()(null===e||void 0===e?void 0:e.className,`${z}-close-icon`)}))}}),R="function"===typeof v.onClick||p&&"a"===p.type,q=u||null,X=q?t.createElement(t.Fragment,null,q,p&&t.createElement("span",null,p)):p,Q=t.createElement("span",Object.assign({},B,{ref:o,className:H,style:N}),X,M,P&&t.createElement(k,{key:"preset",prefixCls:z}),T&&t.createElement(O,{key:"status",prefixCls:z}));return F(R?t.createElement(d.A,{component:"Tag"},Q):Q)}),E=$;E.CheckableTag=j;const B=E}}]);
//# sourceMappingURL=8350.ee8d1c1d.chunk.js.map