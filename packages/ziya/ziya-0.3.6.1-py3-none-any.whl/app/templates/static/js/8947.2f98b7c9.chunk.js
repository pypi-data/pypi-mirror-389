"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8947],{32799:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var a=s(65043),n=s(61494),l=s(98105),r=s(22019),i=s(6051),c=s(15492),o=s(91686),d=s(42261),u=s(89073),p=s(96603),h=s(8354),f=s(76399),x=s(8347),y=s(35589),m=s(35271),j=s(20168),g=s(70579);const{Title:A,Text:v}=n.A,{TabPane:b}=l.A,k=[{label:"Full Pipeline",value:"full"},{label:"Prism Only",value:"prismOnly"},{label:"Diff Only",value:"diffOnly"},{label:"Raw",value:"raw"}],w=()=>{const{isDarkMode:e}=(0,x.D)(),[t,s]=(0,a.useState)([]),[n,w]=(0,a.useState)("all"),[C,S]=(0,a.useState)(!0),[T,P]=(0,a.useState)({}),[D,R]=(0,a.useState)(null),[F,$]=(0,a.useState)(!1),[E,N]=(0,a.useState)("full");(0,a.useEffect)(()=>{!async function(){S(!0);try{const e="/testcases";console.log("Loading test cases from:",e);const t=await fetch(`${e}/index.json`);if(!t.ok)throw new Error(`Failed to load index.json: ${t.statusText}`);const a=await t.json();console.log("Index loaded:",a);const n=(await Promise.all(Object.entries(a.testSets||{}).map(async t=>{let[s,a]=t;return Promise.all(a.cases.map(async t=>{const[n,l]=await Promise.all([fetch(`${e}/${a.path}/${t}.meta.json`),fetch(`${e}/${a.path}/${t}.diff`)]),r=await n.json(),i=await l.text();return{...r,id:t,category:s,diff:i}}))}))).flat().filter(e=>Boolean(e)&&Boolean(e.id)&&Boolean(e.name)&&Array.isArray(e.tags));s(n)}catch(e){console.error("Error loading test cases:",e),r.Ay.error("Failed to load test cases")}finally{S(!1)}}()},[]);const O=[...new Set(t.map(e=>e.category))],V="all"===n?t:t.filter(e=>e.category===n);return(0,g.jsxs)("div",{children:[(0,g.jsxs)(i.A,{direction:"vertical",style:{width:"100%",marginBottom:"16px"},children:[(0,g.jsx)(A,{level:3,children:"Diff Rendering Test Cases"}),(0,g.jsxs)(i.A,{children:[(0,g.jsx)(c.Ay,{type:"primary",onClick:async()=>{$(!0);const e=new m.y;try{const t=await Promise.all(j.bc.map(t=>e.runSuite(t)));R(t[0]),r.Ay.success("Test suite completed")}catch(t){r.Ay.error("Failed to run tests"),console.error("Test error:",t)}finally{$(!1)}},loading:F,children:"Run All Tests"}),(0,g.jsx)(c.Ay,{onClick:()=>P({}),disabled:0===Object.keys(T).length,children:"Clear Results"})]})]}),C?(0,g.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,g.jsx)(o.A,{size:"large"}),(0,g.jsx)("div",{style:{marginTop:"16px"},children:"Loading test cases..."})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(d.A,{message:"Visual Verification Suite",description:`${t.length} test cases loaded across ${O.length} categories.\n                                    Each case can be validated against its source file when provided.`,type:"info",showIcon:!0,style:{margin:"16px"}}),(0,g.jsx)(u.A,{style:{margin:"16px"},children:(0,g.jsxs)(i.A,{direction:"vertical",children:[(0,g.jsx)(v,{strong:!0,children:"Render Pipeline Control"}),(0,g.jsx)(p.Ay.Group,{options:k,onChange:e=>N(e.target.value),value:E,optionType:"button",buttonStyle:"solid"})]})}),D&&(0,g.jsx)(d.A,{message:"Test Results",description:(0,g.jsxs)(i.A,{direction:"vertical",size:"small",children:[(0,g.jsx)(A,{level:5,children:"Summary"}),(0,g.jsxs)(i.A,{direction:"vertical",children:[(0,g.jsxs)(v,{children:["Total Suites: ",D.summary.totalSuites]}),(0,g.jsxs)(v,{children:["Total Tests: ",D.summary.totalTests]}),(0,g.jsxs)(v,{children:["Passed: ",D.summary.totalPassed]}),(0,g.jsxs)(v,{children:["Failed: ",D.summary.totalFailed]}),(0,g.jsxs)(v,{children:["Skipped: ",D.summary.totalSkipped]}),(0,g.jsxs)(v,{children:["Duration: ",D.summary.totalDuration,"ms"]})]}),(0,g.jsx)(h.A,{}),(0,g.jsx)(A,{level:5,children:"Suite Details"}),D.suiteResults.map((e,t)=>(0,g.jsx)(u.A,{size:"small",style:{marginBottom:8},children:(0,g.jsxs)(i.A,{direction:"vertical",children:[(0,g.jsx)(v,{strong:!0,children:e.suiteName}),(0,g.jsxs)(i.A,{children:[(0,g.jsxs)(f.A,{color:"blue",children:[e.totalTests," tests"]}),(0,g.jsxs)(f.A,{color:"success",children:[e.passed," passed"]}),e.failed>0&&(0,g.jsxs)(f.A,{color:"error",children:[e.failed," failed"]}),e.skipped>0&&(0,g.jsxs)(f.A,{color:"warning",children:[e.skipped," skipped"]})]})]})},t))]}),type:0===D.summary.totalFailed?"success":"warning",showIcon:!0,style:{margin:"16px"}}),(0,g.jsxs)(l.A,{activeKey:n,onChange:w,style:{margin:"0 16px"},children:[(0,g.jsx)(b,{tab:"All Cases"},"all"),O.map(e=>(0,g.jsx)(b,{tab:e},e))]}),(0,g.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(600px, 1fr))",gap:"16px",padding:"16px"},children:V.map(t=>(0,g.jsx)(u.A,{title:t.name,extra:(0,g.jsxs)(i.A,{children:[(0,g.jsx)(f.A,{color:"blue",children:t.id}),(0,g.jsx)(f.A,{color:"purple",children:t.category}),t.subcategory&&(0,g.jsx)(f.A,{color:"cyan",children:t.subcategory}),void 0!==T[t.id]&&(0,g.jsx)(f.A,{color:T[t.id]?"success":"error",children:T[t.id]?"Valid":"Invalid"})]}),children:(0,g.jsxs)(i.A,{direction:"vertical",style:{width:"100%"},children:[(0,g.jsx)(v,{type:"secondary",children:t.description}),t.tags&&t.tags.length>0&&(0,g.jsx)(i.A,{wrap:!0,children:t.tags.map(e=>(0,g.jsx)(f.A,{children:e},e))}),(0,g.jsx)("div",{className:"diff-container",children:(0,g.jsx)(y.default,{markdown:`\`\`\`diff\n${t.diff}\n\`\`\``,enableCodeApply:!1})}),t.sourceContent&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h.A,{children:"Source File"}),(0,g.jsx)("pre",{style:{backgroundColor:e?"#1f1f1f":"#f6f8fa",padding:"16px",borderRadius:"6px",overflow:"auto"},children:(0,g.jsx)("code",{children:t.sourceContent})})]}),(0,g.jsx)(c.Ay,{onClick:()=>(async e=>{try{const t=(await fetch("/api/apply-changes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({diff:e.diff,filePath:e.sourceFile,content:e.sourceContent,validate:!0})})).ok;return P(s=>({...s,[e.id]:t})),r.Ay.success(t?"Diff validation successful":"Diff validation failed"),t}catch(t){return console.error("Validation error:",t),r.Ay.error("Validation error occurred"),!1}})(t),style:{marginTop:"8px"},children:"Validate Diff"})]})},t.id))})]})]})}},79688:(e,t,s)=>{s.d(t,{A:()=>h});var a=s(58168),n=s(89379),l=s(64467),r=s(5544),i=s(80045),c=s(98139),o=s.n(c),d=s(28678),u=s(65043),p=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"];const h=(0,u.forwardRef)(function(e,t){var s=e.prefixCls,c=void 0===s?"rc-checkbox":s,h=e.className,f=e.style,x=e.checked,y=e.disabled,m=e.defaultChecked,j=void 0!==m&&m,g=e.type,A=void 0===g?"checkbox":g,v=e.title,b=e.onChange,k=(0,i.A)(e,p),w=(0,u.useRef)(null),C=(0,u.useRef)(null),S=(0,d.A)(j,{value:x}),T=(0,r.A)(S,2),P=T[0],D=T[1];(0,u.useImperativeHandle)(t,function(){return{focus:function(e){var t;null===(t=w.current)||void 0===t||t.focus(e)},blur:function(){var e;null===(e=w.current)||void 0===e||e.blur()},input:w.current,nativeElement:C.current}});var R=o()(c,h,(0,l.A)((0,l.A)({},"".concat(c,"-checked"),P),"".concat(c,"-disabled"),y));return u.createElement("span",{className:R,title:v,style:f,ref:C},u.createElement("input",(0,a.A)({},k,{className:"".concat(c,"-input"),ref:w,onChange:function(t){y||("checked"in e||D(t.target.checked),null===b||void 0===b||b({target:(0,n.A)((0,n.A)({},e),{},{type:A,checked:t.target.checked}),stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()},nativeEvent:t.nativeEvent}))},disabled:y,checked:!!P,type:A})),u.createElement("span",{className:"".concat(c,"-inner")}))})},88042:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(65043),n=s(45818);function l(e){const t=a.useRef(null),s=()=>{n.A.cancel(t.current),t.current=null};return[()=>{s(),t.current=(0,n.A)(()=>{t.current=null})},a=>{t.current&&(a.stopPropagation(),s()),null===e||void 0===e||e(a)}]}}}]);
//# sourceMappingURL=8947.2f98b7c9.chunk.js.map