"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[728],{50728:(e,s,i)=>{i.r(s),i.d(s,{default:()=>P});var r=i(65043),t=i(97326),n=i(98080),o=i(98105),l=i(22019),a=i(85672),c=i(15492),d=i(91686),h=i(6051),p=i(42261),x=i(76399),v=i(20691),y=i(12624),u=i(54522),j=i(99472),m=i(70501),g=i(35589),f=i(29792),A=i(46237),S=i(89967),w=i(74017),b=i(1259),C=i(70579);const{Panel:I}=t.A,{Option:T}=n.A,{TabPane:k}=o.A,P=e=>{let{visible:s,onClose:i}=e;const[P,E]=(0,r.useState)(null),[_,z]=(0,r.useState)(!1),[M,N]=(0,r.useState)(!1),[D,F]=(0,r.useState)({}),[L,O]=(0,r.useState)(null),[$,B]=(0,r.useState)([]),[R,U]=(0,r.useState)({}),[J,q]=(0,r.useState)({});(0,r.useEffect)(()=>{if(s){G();const e=()=>{K(),setTimeout(()=>G(),1e3)};return window.addEventListener("mcpStatusChanged",e),()=>{window.removeEventListener("mcpStatusChanged",e)}}},[s]);const G=async()=>{z(!0);try{const e=await fetch("/api/mcp/status");if(e.ok){const s=await e.json();console.log("MCP Status received:",s),console.log("Servers:",s.servers),console.log("Server configs:",s.server_configs),E(s)}else console.error("MCP status fetch failed:",e.status,e.statusText)}catch(e){console.error("Failed to fetch MCP status:",e)}finally{z(!1)}},K=async()=>{try{const e=await fetch("/api/mcp/permissions");if(e.ok){const s=await e.json();O(s)}}catch(e){console.error("Failed to fetch MCP permissions:",e)}};return(0,C.jsxs)(a.A,{title:"MCP Server Status",open:s,onCancel:i,footer:[(0,C.jsx)(c.Ay,{icon:(0,C.jsx)(f.A,{}),onClick:()=>N(!0),children:"Browse Registry"},"registry"),(0,C.jsx)(c.Ay,{type:"primary",onClick:async()=>{z(!0);try{(await fetch("/api/mcp/initialize",{method:"POST"})).ok&&await G()}catch(e){console.error("Failed to reinitialize MCP:",e)}finally{z(!1)}},loading:_,children:"Reinitialize"},"reinit"),(0,C.jsx)(c.Ay,{onClick:i,children:"Close"},"close")],width:800,children:[_?(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsx)(d.A,{size:"large"})}):P?(0,C.jsxs)(h.A,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,C.jsx)(p.A,{message:"MCP System "+(P.initialized?"Initialized":"Not Initialized"),description:(0,C.jsxs)("div",{children:[(0,C.jsxs)("div",{children:[P.connected_servers,"/",P.total_servers," servers connected"]}),(0,C.jsx)("div",{style:{fontSize:"12px",marginTop:"4px",opacity:.8},children:(()=>{if(!P)return null;const e=(e,s)=>e.includes("/.ziya/")?"(user's home)":e.endsWith("/mcp_config.json")&&!e.includes("/.ziya/")?e.includes("/mcp_config.json")&&e.split("/").length>2?"(project root)":"(current working directory)":"";return P.config_path&&P.config_exists?`Using config: ${P.config_path}`:P.config_search_paths&&P.config_search_paths.length>0?(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{children:"No MCP configuration file found in search path."}),(0,C.jsx)("div",{style:{fontSize:"11px",opacity:.7,marginTop:"2px"},children:"Using built-in server defaults."}),(0,C.jsxs)("div",{style:{fontSize:"11px",opacity:.7,marginTop:"4px",wordBreak:"break-all"},children:["Search path: ",P.config_search_paths.map((s,i)=>(0,C.jsxs)("div",{style:{marginTop:i>0?"2px":"0"},children:[i>0&&"\u2193 ",(0,C.jsx)("code",{style:{backgroundColor:"rgba(0,0,0,0.1)",padding:"1px 3px",borderRadius:"2px",fontSize:"10px",fontFamily:"monospace"},children:s}),(0,C.jsx)("span",{style:{marginLeft:"4px",fontStyle:"italic"},children:e(s)})]},i))]})]}):"Using built-in server defaults"})()})]}),type:P.initialized&&P.connected_servers>0?"success":"warning",showIcon:!0}),(0,C.jsx)(t.A,{activeKey:$,onChange:e=>{const s=Array.isArray(e)?e:[e];B(s),s.forEach(e=>{e&&(async e=>{if(!R[e]){q(s=>({...s,[e]:!0}));try{const s=await fetch(`/api/mcp/servers/${e}/details`);if(s.ok){const i=await s.json();console.log(`Fetched details for ${e}:`,i),U(s=>({...s,[e]:i}))}else console.error(`Failed to fetch details for ${e}: ${s.status} ${s.statusText}`),U(s=>({...s,[e]:{tools:[],resources:[],prompts:[]}}))}catch(s){console.error(`Failed to fetch details for ${e}:`,s),U(s=>({...s,[e]:{tools:[],resources:[],prompts:[]}}))}finally{q(s=>({...s,[e]:!1}))}}})(e)})},children:(P.server_configs?Object.keys(P.server_configs):Object.keys(P.servers)).map(e=>{var s,i,r,t,a;const c=P.servers[e]||{connected:!1,resources:0,tools:0,prompts:0,capabilities:{}},m=!1!==(null===(s=P.server_configs)||void 0===s||null===(i=s[e])||void 0===i?void 0:i.enabled),f=(null===L||void 0===L||null===(r=L.servers)||void 0===r||null===(t=r[e])||void 0===t?void 0:t.permission)||(null===L||void 0===L||null===(a=L.defaults)||void 0===a?void 0:a.server)||"ask";return(0,C.jsx)(I,{header:(0,C.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,C.jsxs)(h.A,{children:[(0,C.jsx)(x.A,{color:m&&c.connected?"green":m?"red":"default",icon:m&&c.connected?(0,C.jsx)(A.A,{}):(0,C.jsx)(S.A,{}),children:m?c.connected?"Connected":"Disconnected":"Disabled"}),(0,C.jsx)("span",{children:e}),c.builtin&&(0,C.jsx)(x.A,{color:"blue",children:"built-in"})]}),(0,C.jsxs)(h.A,{children:[(0,C.jsxs)(x.A,{icon:(0,C.jsx)(w.A,{}),children:[c.tools," tools"]}),(0,C.jsxs)(x.A,{icon:(0,C.jsx)(b.A,{}),children:[c.resources," resources"]})]})]}),children:(0,C.jsxs)(h.A,{direction:"vertical",style:{width:"100%"},children:[(0,C.jsxs)(v.A,{bordered:!0,size:"small",column:1,children:[(0,C.jsxs)(v.A.Item,{label:"Server Process",children:[(0,C.jsx)(y.A,{checked:m,onChange:s=>(async(e,s)=>{F(s=>({...s,[e]:!0}));try{const i=await fetch("/api/mcp/toggle-server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:e,enabled:s})});if(i.ok){const e=await i.json();e.success?(l.Ay.success(e.message),await G()):l.Ay.error(e.message||"Failed to toggle server")}else l.Ay.error("Failed to toggle server")}catch(i){l.Ay.error("Failed to toggle server"),console.error("Toggle error:",i)}finally{F(s=>({...s,[e]:!1}))}})(e,s),loading:D[e],size:"small"}),(0,C.jsx)("span",{style:{marginLeft:8},children:m?"Enabled":"Disabled"})]}),(0,C.jsx)(v.A.Item,{label:"Server Permissions",children:(0,C.jsxs)(n.A,{value:f,style:{width:120},onChange:s=>(async(e,s)=>{try{(await fetch("/api/mcp/permissions/server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:e,permission:s})})).ok?(l.Ay.success(`Permission for ${e} updated.`),K()):l.Ay.error("Failed to update permission.")}catch(i){l.Ay.error("Failed to update permission.")}})(e,s),children:[(0,C.jsx)(T,{value:"enabled",children:"Enabled"}),(0,C.jsx)(T,{value:"disabled",children:"Disabled"}),(0,C.jsx)(T,{value:"ask",children:"Ask"})]})})]}),J[e]?(0,C.jsx)(d.A,{}):R[e]?(0,C.jsxs)(o.A,{defaultActiveKey:"tools",children:[(0,C.jsx)(k,{tab:`Tools (${R[e].tools.length})`,children:(0,C.jsx)(u.A,{dataSource:R[e].tools,renderItem:s=>{var i,r,t,o,a;const c=(null===L||void 0===L||null===(i=L.servers)||void 0===i||null===(r=i[e])||void 0===r||null===(t=r.tools)||void 0===t||null===(o=t[s.name])||void 0===o?void 0:o.permission)||(null===L||void 0===L||null===(a=L.defaults)||void 0===a?void 0:a.tool)||"ask";return(0,C.jsxs)(u.A.Item,{children:[(0,C.jsx)(u.A.Item.Meta,{title:s.name,description:s.description?(0,C.jsx)("div",{style:{fontSize:"13px"},children:(0,C.jsx)(g.default,{markdown:s.description,enableCodeApply:!1})}):null}),(0,C.jsxs)(n.A,{value:c,style:{width:120},onChange:i=>(async(e,s,i)=>{try{(await fetch("/api/mcp/permissions/tool",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:e,tool_name:s,permission:i})})).ok?(l.Ay.success(`Permission for ${s} updated.`),K()):l.Ay.error("Failed to update permission.")}catch(r){l.Ay.error("Failed to update permission.")}})(e,s.name,i),children:[(0,C.jsx)(T,{value:"enabled",children:"Enabled"}),(0,C.jsx)(T,{value:"disabled",children:"Disabled"}),(0,C.jsx)(T,{value:"ask",children:"Ask"})]})]})},locale:{emptyText:(0,C.jsx)(j.A,{description:"No tools found",image:j.A.PRESENTED_IMAGE_SIMPLE})}})},"tools"),(0,C.jsx)(k,{tab:`Resources (${R[e].resources.length})`,children:(0,C.jsx)(u.A,{dataSource:R[e].resources,renderItem:e=>(0,C.jsx)(u.A.Item,{children:(0,C.jsx)(u.A.Item.Meta,{title:e.name,description:e.description?(0,C.jsxs)("div",{style:{fontSize:"13px"},children:[(0,C.jsx)(g.default,{markdown:e.description,enableCodeApply:!1}),(0,C.jsx)("div",{style:{color:"#999",fontSize:"11px",marginTop:"4px"},children:e.uri})]}):e.uri})}),locale:{emptyText:(0,C.jsx)(j.A,{description:"No resources found",image:j.A.PRESENTED_IMAGE_SIMPLE})}})},"resources"),(0,C.jsx)(k,{tab:`Prompts (${R[e].prompts.length})`,children:(0,C.jsx)(u.A,{dataSource:R[e].prompts,renderItem:e=>(0,C.jsx)(u.A.Item,{children:(0,C.jsx)(u.A.Item.Meta,{title:e.name,description:e.description?(0,C.jsx)("div",{style:{fontSize:"13px"},children:(0,C.jsx)(g.default,{markdown:e.description,enableCodeApply:!1})}):null})}),locale:{emptyText:(0,C.jsx)(j.A,{description:"No prompts found",image:j.A.PRESENTED_IMAGE_SIMPLE})}})},"prompts")]}):(0,C.jsx)(p.A,{message:"Could not load server details. The server might be disconnected or disabled.",type:"warning"})]})},e)})})]}):(0,C.jsx)(p.A,{message:"Failed to load MCP status",type:"error"}),(0,C.jsx)(m.default,{visible:M,onClose:()=>{N(!1),G()}})]})}},70501:(e,s,i)=>{i.r(s),i.d(s,{default:()=>z});var r=i(65043),t=i(10491),n=i(61494),o=i(98080),l=i(98105),a=i(22019),c=i(89073),d=i(15492),h=i(6051),p=i(76399),x=i(37490),v=i(85672),y=i(42261),u=i(32513),j=i(91686),m=i(54522),g=i(89330),f=i(24228),A=i(61966),S=i(74017),w=i(29792),b=i(72411),C=i(70579);const{Search:I}=t.A,{Text:T,Title:k,Paragraph:P}=n.A,{Option:E}=o.A,{TabPane:_}=l.A,z=e=>{let{visible:s,onClose:i}=e;const[t,n]=(0,r.useState)([]),[k,z]=(0,r.useState)([]),[M,N]=(0,r.useState)([]),[D,F]=(0,r.useState)([]),[L,O]=(0,r.useState)(!1),[$,B]=(0,r.useState)({}),[R,U]=(0,r.useState)(""),[J,q]=(0,r.useState)("browse"),[G,K]=(0,r.useState)([]),[W,H]=(0,r.useState)(!0);(0,r.useEffect)(()=>{s&&(Q(),V(),X())},[s]);const Q=async()=>{try{const e=await fetch("/api/mcp/registry/providers");if(e.ok){const s=await e.json();N(s.providers),K(s.providers.map(e=>e.id))}}catch(e){console.error("Error loading providers:",e)}},V=async()=>{O(!0);try{const e=await fetch("/api/mcp/registry/services");if(e.ok){const s=await e.json();n(s.services)}else a.Ay.error("Failed to load available services")}catch(e){console.error("Error loading services:",e),a.Ay.error("Error loading services")}finally{O(!1)}},X=async()=>{try{const e=await fetch("/api/mcp/registry/services/installed");if(e.ok){const s=await e.json();z(s.services)}}catch(e){console.error("Error loading installed services:",e)}},Y=async e=>{B(s=>({...s,[e]:!0}));try{const s=await fetch("/api/mcp/registry/services/install",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_id:e,provider_id:null})});if(s.ok){const e=await s.json();a.Ay.success(`Successfully installed ${e.service_name}`),await X(),window.dispatchEvent(new Event("mcpStatusChanged"))}else{const e=await s.json();a.Ay.error(`Installation failed: ${e.detail}`)}}catch(s){console.error("Installation error:",s),a.Ay.error("Installation failed")}finally{B(s=>({...s,[e]:!1}))}},Z=e=>{switch(e){case"Recommended":return"green";case"Supported":return"blue";case"Under assessment":return"orange";case"In development":return"red";default:return"default"}},ee=e=>k.some(s=>s.serviceId===e);return(0,C.jsx)(v.A,{title:(0,C.jsxs)(h.A,{children:[(0,C.jsx)(w.A,{}),(0,C.jsx)("span",{children:"MCP Registry"})]}),open:s,onCancel:i,footer:[(0,C.jsx)(d.Ay,{onClick:i,children:"Close"},"close")],width:800,style:{top:20},bodyStyle:{height:"70vh",overflow:"hidden"},children:(0,C.jsxs)(l.A,{activeKey:J,onChange:q,style:{height:"100%"},children:[(0,C.jsx)(_,{tab:(0,C.jsxs)(h.A,{children:[(0,C.jsx)(b.A,{}),(0,C.jsx)("span",{children:"Browse Services"})]}),children:(0,C.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,C.jsx)(y.A,{message:"Browse and install approved MCP servers",description:(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{children:"These servers have been reviewed and approved for use."}),(0,C.jsx)("div",{style:{marginTop:8},children:(0,C.jsx)(u.A,{checked:W,onChange:e=>{H(e.target.checked),setTimeout(V,100)},children:"Include internal services"})})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),(0,C.jsx)("div",{style:{flex:1,overflow:"auto"},children:L?(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsx)(j.A,{size:"large"})}):(0,C.jsx)(m.A,{dataSource:t,renderItem:e=>{var s;return(0,C.jsx)(c.A,{size:"small",style:{marginBottom:16},actions:[(0,C.jsx)(d.Ay,{type:"primary",icon:(0,C.jsx)(g.A,{}),loading:$[e.serviceId],disabled:ee(e.serviceId),onClick:()=>Y(e.serviceId),children:ee(e.serviceId)?"Installed":"Install"},"install"),e.securityReviewLink&&(0,C.jsx)(d.Ay,{icon:(0,C.jsx)(f.A,{}),onClick:()=>window.open(e.securityReviewLink,"_blank"),children:"Security Review"},"security")].filter(Boolean),children:(0,C.jsx)(c.A.Meta,{title:(0,C.jsxs)(h.A,{children:[(0,C.jsx)("span",{children:e.serviceName}),(0,C.jsx)(p.A,{color:Z(e.supportLevel),children:e.supportLevel}),(0,C.jsx)(p.A,{color:e.provider.isInternal?"gold":"blue",children:e.provider.name}),(0,C.jsx)(x.A,{count:`v${e.version}`,color:"blue"})]}),description:(0,C.jsxs)("div",{children:[(0,C.jsx)(P,{ellipsis:{rows:2},style:{marginBottom:8},children:e.serviceDescription}),(0,C.jsx)("div",{style:{marginBottom:8},children:null===(s=e.tags)||void 0===s?void 0:s.map(e=>(0,C.jsx)(p.A,{children:e},e))}),(0,C.jsxs)(T,{type:"secondary",style:{fontSize:"12px"},children:["ID: ",e.serviceId," | Provider: ",e.provider.name]})]})})},e.serviceId)},locale:{emptyText:"No services available"}})})]})},"browse"),(0,C.jsx)(_,{tab:(0,C.jsxs)(h.A,{children:[(0,C.jsx)(w.A,{}),(0,C.jsx)("span",{children:"Installed Services"}),(0,C.jsx)(x.A,{count:k.length})]}),children:(0,C.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,C.jsx)(y.A,{message:"Manage your installed MCP services",description:"These services are currently installed and configured in your system.",type:"success",showIcon:!0,style:{marginBottom:16}}),(0,C.jsx)("div",{style:{flex:1,overflow:"auto"},children:0===k.length?(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsx)(T,{type:"secondary",children:"No registry services installed"})}):(0,C.jsx)(m.A,{dataSource:k,renderItem:e=>(0,C.jsx)(c.A,{size:"small",style:{marginBottom:16},actions:[(0,C.jsx)(d.Ay,{danger:!0,icon:(0,C.jsx)(A.A,{}),onClick:()=>(async e=>{try{const s=await fetch("/api/mcp/registry/services/uninstall",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:e})});if(s.ok)a.Ay.success("Service uninstalled successfully"),await X(),window.dispatchEvent(new Event("mcpStatusChanged"));else{const e=await s.json();a.Ay.error(`Uninstall failed: ${e.detail}`)}}catch(s){console.error("Uninstall error:",s),a.Ay.error("Uninstall failed")}})(e.serverName),children:"Uninstall"},"uninstall")],children:(0,C.jsx)(c.A.Meta,{title:(0,C.jsxs)(h.A,{children:[(0,C.jsx)("span",{children:e.serviceName}),e.supportLevel&&(0,C.jsx)(p.A,{color:Z(e.supportLevel),children:e.supportLevel}),e.version&&(0,C.jsx)(x.A,{count:`v${e.version}`,color:"blue"}),(0,C.jsx)(p.A,{color:e.enabled?"green":"red",children:e.enabled?"Enabled":"Disabled"})]}),description:(0,C.jsxs)("div",{children:[(0,C.jsxs)(T,{type:"secondary",style:{fontSize:"12px"},children:["Server: ",e.serverName]}),e.installedAt&&(0,C.jsx)("div",{children:(0,C.jsxs)(T,{type:"secondary",style:{fontSize:"12px"},children:["Installed: ",new Date(e.installedAt).toLocaleDateString()]})})]})})},e.serverName)})})]})},"installed"),(0,C.jsx)(_,{tab:(0,C.jsxs)(h.A,{children:[(0,C.jsx)(S.A,{}),(0,C.jsx)("span",{children:"Search Tools"})]}),children:(0,C.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,C.jsxs)("div",{style:{marginBottom:16},children:[(0,C.jsxs)("div",{style:{marginBottom:12},children:[(0,C.jsx)(T,{strong:!0,children:"Search Providers:"}),(0,C.jsx)(o.A,{mode:"multiple",placeholder:"Select providers to search",style:{width:"100%",marginTop:4},value:G,onChange:K,children:M.map(e=>(0,C.jsxs)(E,{value:e.id,children:[e.name," ",e.isInternal?"(Internal)":""]},e.id))})]}),(0,C.jsx)(I,{placeholder:"Describe what you want to do (e.g., 'file operations', 'database queries')",enterButton:"Search Tools",size:"large",value:R,onChange:e=>U(e.target.value),onSearch:async e=>{if(e.trim()){O(!0);try{const s=await fetch("/api/mcp/registry/tools/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,maxTools:20,providers:G.length>0?G:null})});if(s.ok){const e=await s.json();F(e.results)}else a.Ay.error("Failed to search tools")}catch(s){console.error("Error searching tools:",s),a.Ay.error("Error searching tools")}finally{O(!1)}}else F([])},loading:L}),(0,C.jsx)(T,{type:"secondary",style:{fontSize:"12px",display:"block",marginTop:4},children:"Search for MCP servers by describing the tools you need"})]}),(0,C.jsx)("div",{style:{flex:1,overflow:"auto"},children:L?(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsx)(j.A,{size:"large"})}):D.length>0?(0,C.jsx)(m.A,{dataSource:D,renderItem:e=>(0,C.jsx)(c.A,{size:"small",style:{marginBottom:16},actions:[(0,C.jsx)(d.Ay,{type:"primary",icon:(0,C.jsx)(g.A,{}),loading:$[e.service.serviceId],disabled:ee(e.service.serviceId),onClick:()=>Y(e.service.serviceId),children:ee(e.service.serviceId)?"Installed":"Install"},"install")],children:(0,C.jsx)(c.A.Meta,{title:(0,C.jsxs)(h.A,{children:[(0,C.jsx)("span",{children:e.service.serviceName}),(0,C.jsx)(p.A,{color:Z(e.service.supportLevel),children:e.service.supportLevel})]}),description:(0,C.jsxs)("div",{children:[(0,C.jsx)(P,{ellipsis:{rows:1},style:{marginBottom:8},children:e.service.serviceDescription}),(0,C.jsxs)("div",{style:{marginTop:8},children:[(0,C.jsx)(T,{strong:!0,children:"Matching Tools:"}),(0,C.jsx)("div",{style:{marginTop:4},children:e.matchingTools.map(e=>(0,C.jsx)(p.A,{icon:(0,C.jsx)(S.A,{}),children:e.toolName},e.toolName))})]})]})})},e.service.serviceId)}):R?(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsxs)(T,{type:"secondary",children:['No tools found for "',R,'"']})}):(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsx)(T,{type:"secondary",children:"Enter a search query to find relevant tools"})})})]})},"search")]})})}}}]);
//# sourceMappingURL=728.91013a86.chunk.js.map