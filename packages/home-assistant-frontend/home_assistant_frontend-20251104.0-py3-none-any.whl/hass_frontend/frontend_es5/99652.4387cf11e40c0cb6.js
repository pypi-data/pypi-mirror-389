"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["99652"],{94029:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{K:function(){return d}});var o=i(77489),a=i(65940),r=i(22989),s=t([o,r]);[o,r]=s.then?(await s)():s;const l=(0,a.A)(t=>new Intl.RelativeTimeFormat(t.language,{numeric:"auto"})),d=(t,e,i,n=!0)=>{const o=(0,r.x)(t,i,e);return n?l(e).format(o.value,o.unit):Intl.NumberFormat(e.language,{style:"unit",unit:o.unit,unitDisplay:"long"}).format(Math.abs(o.value))};n()}catch(l){n(l)}})},22989:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{x:function(){return p}});i(12977);var o=i(41484),a=i(88258),r=i(42794),s=i(50654),l=t([s]);s=(l.then?(await l)():l)[0];const c=1e3,u=60,h=60*u;function p(t,e=Date.now(),i,n={}){const l=Object.assign(Object.assign({},m),n||{}),d=(+t-+e)/c;if(Math.abs(d)<l.second)return{value:Math.round(d),unit:"second"};const p=d/u;if(Math.abs(p)<l.minute)return{value:Math.round(p),unit:"minute"};const _=d/h;if(Math.abs(_)<l.hour)return{value:Math.round(_),unit:"hour"};const g=new Date(t),y=new Date(e);g.setHours(0,0,0,0),y.setHours(0,0,0,0);const f=(0,o.c)(g,y);if(0===f)return{value:Math.round(_),unit:"hour"};if(Math.abs(f)<l.day)return{value:f,unit:"day"};const v=(0,s.PE)(i),w=(0,a.k)(g,{weekStartsOn:v}),b=(0,a.k)(y,{weekStartsOn:v}),x=(0,r.I)(w,b);if(0===x)return{value:f,unit:"day"};if(Math.abs(x)<l.week)return{value:x,unit:"week"};const $=g.getFullYear()-y.getFullYear(),P=12*$+g.getMonth()-y.getMonth();return 0===P?{value:x,unit:"week"}:Math.abs(P)<l.month||0===$?{value:P,unit:"month"}:{value:Math.round($),unit:"year"}}const m={second:45,minute:45,hour:22,day:5,week:4,month:11};n()}catch(d){n(d)}})},65298:function(t,e,i){i.d(e,{n:function(){return n}});i(35748),i(95013);const n=(t,e,i=!0,n=!0)=>{let o,a=0;const r=(...r)=>{const s=()=>{a=!1===i?0:Date.now(),o=void 0,t(...r)},l=Date.now();a||!1!==i||(a=l);const d=e-(l-a);d<=0||d>e?(o&&(clearTimeout(o),o=void 0),a=l,t(...r)):o||!1===n||(o=window.setTimeout(s,d))};return r.cancel=()=>{clearTimeout(o),o=void 0,a=0},r}},78918:function(t,e,i){i(35748),i(65315),i(22416),i(95013);var n=i(69868),o=i(84922),a=i(11991),r=i(91541);i(33574),i(61631);let s,l,d=t=>t;class c extends o.WF{get items(){var t;return null===(t=this._menu)||void 0===t?void 0:t.items}get selected(){var t;return null===(t=this._menu)||void 0===t?void 0:t.selected}focus(){var t,e;null!==(t=this._menu)&&void 0!==t&&t.open?this._menu.focusItemAtIndex(0):null===(e=this._triggerButton)||void 0===e||e.focus()}render(){return(0,o.qy)(s||(s=d` <div @click="${0}"> <slot name="trigger" @slotchange="${0}"></slot> </div> <ha-menu .corner="${0}" .menuCorner="${0}" .fixed="${0}" .multi="${0}" .activatable="${0}" .y="${0}" .x="${0}"> <slot></slot> </ha-menu> `),this._handleClick,this._setTriggerAria,this.corner,this.menuCorner,this.fixed,this.multi,this.activatable,this.y,this.x)}firstUpdated(t){super.firstUpdated(t),"rtl"===r.G.document.dir&&this.updateComplete.then(()=>{this.querySelectorAll("ha-list-item").forEach(t=>{const e=document.createElement("style");e.innerHTML="span.material-icons:first-of-type { margin-left: var(--mdc-list-item-graphic-margin, 32px) !important; margin-right: 0px !important;}",t.shadowRoot.appendChild(e)})})}_handleClick(){this.disabled||(this._menu.anchor=this.noAnchor?null:this,this._menu.show())}get _triggerButton(){return this.querySelector('ha-icon-button[slot="trigger"], ha-button[slot="trigger"]')}_setTriggerAria(){this._triggerButton&&(this._triggerButton.ariaHasPopup="menu")}constructor(...t){super(...t),this.corner="BOTTOM_START",this.menuCorner="START",this.x=null,this.y=null,this.multi=!1,this.activatable=!1,this.disabled=!1,this.fixed=!1,this.noAnchor=!1}}c.styles=(0,o.AH)(l||(l=d`:host{display:inline-block;position:relative}::slotted([disabled]){color:var(--disabled-text-color)}`)),(0,n.__decorate)([(0,a.MZ)()],c.prototype,"corner",void 0),(0,n.__decorate)([(0,a.MZ)({attribute:"menu-corner"})],c.prototype,"menuCorner",void 0),(0,n.__decorate)([(0,a.MZ)({type:Number})],c.prototype,"x",void 0),(0,n.__decorate)([(0,a.MZ)({type:Number})],c.prototype,"y",void 0),(0,n.__decorate)([(0,a.MZ)({type:Boolean})],c.prototype,"multi",void 0),(0,n.__decorate)([(0,a.MZ)({type:Boolean})],c.prototype,"activatable",void 0),(0,n.__decorate)([(0,a.MZ)({type:Boolean})],c.prototype,"disabled",void 0),(0,n.__decorate)([(0,a.MZ)({type:Boolean})],c.prototype,"fixed",void 0),(0,n.__decorate)([(0,a.MZ)({type:Boolean,attribute:"no-anchor"})],c.prototype,"noAnchor",void 0),(0,n.__decorate)([(0,a.P)("ha-menu",!0)],c.prototype,"_menu",void 0),c=(0,n.__decorate)([(0,a.EM)("ha-button-menu")],c)},77510:function(t,e,i){var n=i(69868),o=i(41188),a=i(57437),r=i(84922),s=i(11991);let l,d,c,u=t=>t;class h extends o.J{renderRipple(){return this.noninteractive?"":super.renderRipple()}static get styles(){return[a.R,(0,r.AH)(l||(l=u`:host{padding-left:var(--mdc-list-side-padding-left,var(--mdc-list-side-padding,20px));padding-inline-start:var(--mdc-list-side-padding-left,var(--mdc-list-side-padding,20px));padding-right:var(--mdc-list-side-padding-right,var(--mdc-list-side-padding,20px));padding-inline-end:var(--mdc-list-side-padding-right,var(--mdc-list-side-padding,20px))}:host([graphic=avatar]:not([twoLine])),:host([graphic=icon]:not([twoLine])){height:48px}span.material-icons:first-of-type{margin-inline-start:0px!important;margin-inline-end:var(--mdc-list-item-graphic-margin,16px)!important;direction:var(--direction)!important}span.material-icons:last-of-type{margin-inline-start:auto!important;margin-inline-end:0px!important;direction:var(--direction)!important}.mdc-deprecated-list-item__meta{display:var(--mdc-list-item-meta-display);align-items:center;flex-shrink:0}:host([graphic=icon]:not([twoline])) .mdc-deprecated-list-item__graphic{margin-inline-end:var(--mdc-list-item-graphic-margin,20px)!important}:host([multiline-secondary]){height:auto}:host([multiline-secondary]) .mdc-deprecated-list-item__text{padding:8px 0}:host([multiline-secondary]) .mdc-deprecated-list-item__secondary-text{text-overflow:initial;white-space:normal;overflow:auto;display:inline-block;margin-top:10px}:host([multiline-secondary]) .mdc-deprecated-list-item__primary-text{margin-top:10px}:host([multiline-secondary]) .mdc-deprecated-list-item__secondary-text::before{display:none}:host([multiline-secondary]) .mdc-deprecated-list-item__primary-text::before{display:none}:host([disabled]){color:var(--disabled-text-color)}:host([noninteractive]){pointer-events:unset}`)),"rtl"===document.dir?(0,r.AH)(d||(d=u`span.material-icons:first-of-type,span.material-icons:last-of-type{direction:rtl!important;--direction:rtl}`)):(0,r.AH)(c||(c=u``))]}}h=(0,n.__decorate)([(0,s.EM)("ha-list-item")],h)},14532:function(t,e,i){var n=i(69868),o=i(81484),a=i(60311),r=i(11991);class s extends o.iY{}s.styles=a.R,s=(0,n.__decorate)([(0,r.EM)("ha-list")],s)},61631:function(t,e,i){var n=i(69868),o=i(95463),a=i(3941),r=i(84922),s=i(11991),l=i(75907);i(14532);let d,c=t=>t;class u extends o.ZR{get listElement(){return this.listElement_||(this.listElement_=this.renderRoot.querySelector("ha-list")),this.listElement_}renderList(){const t="menu"===this.innerRole?"menuitem":"option",e=this.renderListClasses();return(0,r.qy)(d||(d=c`<ha-list rootTabbable .innerAriaLabel="${0}" .innerRole="${0}" .multi="${0}" class="${0}" .itemRoles="${0}" .wrapFocus="${0}" .activatable="${0}" @action="${0}"> <slot></slot> </ha-list>`),this.innerAriaLabel,this.innerRole,this.multi,(0,l.H)(e),t,this.wrapFocus,this.activatable,this.onAction)}}u.styles=a.R,u=(0,n.__decorate)([(0,s.EM)("ha-menu")],u)},84432:function(t,e,i){i.d(e,{A1:function(){return n},CY:function(){return r},Fn:function(){return o},Jz:function(){return l},St:function(){return s},VA:function(){return c},WI:function(){return u},iY:function(){return d},xw:function(){return a}});i(46852),i(5934),i(56660);const n=(t,e)=>t.callWS({type:"media_source/resolve_media",media_content_id:e}),o=(t,e)=>t.callWS({type:"media_source/browse_media",media_content_id:e}),a="__MANUAL_ENTRY__",r=t=>t.startsWith(a),s=t=>t.startsWith("media-source://"),l=t=>t.startsWith("media-source://media_source"),d=t=>t.startsWith("media-source://image_upload"),c=async(t,e,i)=>{const n=new FormData;n.append("media_content_id",e),n.append("file",i);const o=await t.fetchWithAuth("/api/media_source/local_source/upload",{method:"POST",body:n});if(413===o.status)throw new Error(`Uploaded file is too large (${i.name})`);if(200!==o.status)throw new Error("Unknown error");return o.json()},u=async(t,e)=>t.callWS({type:"media_source/local_source/remove",media_content_id:e})},76619:function(t,e,i){i.d(e,{o:function(){return o}});i(35748),i(12977),i(5934),i(95013);var n=i(44017);const o=(t,e)=>new Promise(o=>{const a=e.closeDialog,r=e.logInHereAction;(0,n.r)(t,"show-dialog",{dialogTag:"dialog-cloud-already-connected",dialogImport:()=>Promise.all([i.e("3245"),i.e("79584"),i.e("48734")]).then(i.bind(i,92109)),dialogParams:Object.assign(Object.assign({},e),{},{closeDialog:()=>{null==a||a(),o(!1)},logInHereAction:()=>{null==r||r(),o(!0)}})})})},18633:function(t,e,i){i.a(t,async function(t,e){try{i(46852),i(35748),i(12977),i(5934),i(54323),i(95013);var n=i(69868),o=i(84922),a=i(11991),r=i(44017),s=i(41042),l=(i(94124),i(70490),i(17372)),d=(i(35988),i(80287),i(50809)),c=i(50991),u=i(67717),h=i(156),p=i(76619),m=i(6033),_=t([s,l,u]);[s,l,u]=_.then?(await _)():_;let g,y,f,v,w=t=>t;class b extends o.WF{render(){return this.cardLess?this._renderLoginForm():(0,o.qy)(g||(g=w` <ha-card outlined .header="${0}"> ${0} </ha-card> `),this.localize(`ui.panel.${this.translationKeyPanel}.login.sign_in`),this._renderLoginForm())}_renderLoginForm(){var t;return(0,o.qy)(y||(y=w` <div class="card-content login-form"> ${0} <ha-textfield .label="${0}" id="email" name="username" type="email" autocomplete="username" required .value="${0}" @keydown="${0}" .disabled="${0}" .validationMessage="${0}"></ha-textfield> <ha-password-field id="password" name="password" .label="${0}" autocomplete="current-password" required minlength="8" @keydown="${0}" .disabled="${0}" .validationMessage="${0}"></ha-password-field> </div> <div class="card-actions"> <ha-button appearance="plain" .disabled="${0}" @click="${0}"> ${0} </ha-button> <ha-progress-button @click="${0}" .progress="${0}">${0}</ha-progress-button> </div> `),this._error?(0,o.qy)(f||(f=w`<ha-alert alert-type="error">${0}</ha-alert>`),this._error):o.s6,this.localize(`ui.panel.${this.translationKeyPanel}.login.email`),null!==(t=this.email)&&void 0!==t?t:"",this._keyDown,this._inProgress,this.localize(`ui.panel.${this.translationKeyPanel}.login.email_error_msg`),this.localize(`ui.panel.${this.translationKeyPanel}.login.password`),this._keyDown,this._inProgress,this.localize(`ui.panel.${this.translationKeyPanel}.login.password_error_msg`),this._inProgress,this._handleForgotPassword,this.localize(`ui.panel.${this.translationKeyPanel}.login.forgot_password`),this._handleLogin,this._inProgress,this.localize(`ui.panel.${this.translationKeyPanel}.login.sign_in`))}_keyDown(t){"Enter"===t.key&&this._handleLogin()}async _handleLogin(){if(!this._inProgress){if(!this.emailField.reportValidity())return void this.emailField.focus();if(!this._passwordField.reportValidity())return void this._passwordField.focus();this._inProgress=!0,this._login(this.emailField.value,this._passwordField.value,this.checkConnection)}}_handleForgotPassword(){(0,r.r)(this,"cloud-forgot-password")}static get styles(){return[d.RF,(0,o.AH)(v||(v=w`ha-card{overflow:hidden}ha-card .card-header{margin-bottom:-8px}.card-actions{display:flex;justify-content:space-between;align-items:center}.login-form{display:flex;flex-direction:column}`))]}constructor(...t){super(...t),this.checkConnection=!1,this.translationKeyPanel="config.cloud",this.cardLess=!1,this._inProgress=!1,this._handleCloudLoginError=async(t,e,i,n)=>{const o=t&&t.body&&t.body.code;if("mfarequired"===o){const t=await(0,u.showPromptDialog)(this,{title:this.localize(`ui.panel.${this.translationKeyPanel}.login.totp_code_prompt_title`),inputLabel:this.localize(`ui.panel.${this.translationKeyPanel}.login.totp_code`),inputType:"text",defaultValue:"",confirmText:this.localize(`ui.panel.${this.translationKeyPanel}.login.submit`),dismissText:this.localize(`ui.panel.${this.translationKeyPanel}.login.cancel`)});if(null!==t&&""!==t)return this._login(e,i,n,t),"continue"}if("alreadyconnectederror"===o){const n=await(0,p.o)(this,{details:JSON.parse(t.body.message)});return n&&this._login(e,i,!1),n?"continue":"cancel"}if("PasswordChangeRequired"===o)return(0,u.showAlertDialog)(this,{title:this.localize(`ui.panel.${this.translationKeyPanel}.login.alert_password_change_required`)}),"password-change";if("usernotfound"!==o||e===e.toLowerCase())switch(o){case"UserNotConfirmed":return this.localize(`ui.panel.${this.translationKeyPanel}.login.alert_email_confirm_necessary`);case"mfarequired":return this.localize(`ui.panel.${this.translationKeyPanel}.login.alert_mfa_code_required`);case"mfaexpiredornotstarted":return this.localize(`ui.panel.${this.translationKeyPanel}.login.alert_mfa_expired_or_not_started`);case"invalidtotpcode":return this.localize(`ui.panel.${this.translationKeyPanel}.login.alert_totp_code_invalid`);default:return t&&t.body&&t.body.message?t.body.message:"Unknown error"}else this._login(e.toLowerCase(),i,n)},this._login=async(t,e,i,n)=>{if(!e&&!n)throw new Error("Password or code required");try{if(this.hass){const o=await(0,c.p7)(Object.assign(Object.assign({hass:this.hass,email:t},n?{code:n}:{password:e}),{},{check_connection:i}));o.cloud_pipeline&&await(0,u.showConfirmationDialog)(this,{title:this.hass.localize("ui.panel.config.cloud.login.cloud_pipeline_title"),text:this.hass.localize("ui.panel.config.cloud.login.cloud_pipeline_text"),confirmText:this.hass.localize("ui.common.yes"),dismissText:this.hass.localize("ui.common.no")})&&(0,h.NH)(this.hass,o.cloud_pipeline)}else await(0,m.AC)(Object.assign({email:t},n?{code:n}:{password:e}));this.email="",(0,r.r)(this,"ha-refresh-cloud-status")}catch(o){const n=await this._handleCloudLoginError(o,t,e,i);if("cancel"===n)return this._inProgress=!1,this.email="",void(this._passwordField.value="");if("password-change"===n)return void this._handleForgotPassword();"continue"!==n&&(this._inProgress=!1,this._error=n)}}}}(0,n.__decorate)([(0,a.MZ)({attribute:!1})],b.prototype,"hass",void 0),(0,n.__decorate)([(0,a.MZ)({type:Boolean,attribute:"check-connection"})],b.prototype,"checkConnection",void 0),(0,n.__decorate)([(0,a.MZ)()],b.prototype,"email",void 0),(0,n.__decorate)([(0,a.MZ)({attribute:!1})],b.prototype,"localize",void 0),(0,n.__decorate)([(0,a.MZ)({attribute:"translation-key-panel"})],b.prototype,"translationKeyPanel",void 0),(0,n.__decorate)([(0,a.MZ)({type:Boolean,attribute:"card-less"})],b.prototype,"cardLess",void 0),(0,n.__decorate)([(0,a.P)("#email",!0)],b.prototype,"emailField",void 0),(0,n.__decorate)([(0,a.P)("#password",!0)],b.prototype,"_passwordField",void 0),(0,n.__decorate)([(0,a.wk)()],b.prototype,"_error",void 0),(0,n.__decorate)([(0,a.wk)()],b.prototype,"_inProgress",void 0),b=(0,n.__decorate)([(0,a.EM)("cloud-login")],b),e()}catch(g){e(g)}})}}]);
//# sourceMappingURL=99652.4387cf11e40c0cb6.js.map