[build-system]
requires = ["hatchling>=1.25"]
build-backend = "hatchling.build"

[project]
name = "fastmdanalysis"
version = "1.0.0"
description = "Software for automated MD trajectory analysis"
readme = "README.md"
requires-python = ">=3.9"
license = { file = "LICENSE" }
authors = [
  { name = "Adekunle Aina", email = "kunleaina@gmail.com" }
]
keywords = ["molecular dynamics", "trajectory analysis"]
classifiers = [
  "Programming Language :: Python :: 3",
  "License :: OSI Approved :: MIT License",
  "Operating System :: OS Independent"
]

# Runtime dependencies
dependencies = [
  "mdtraj>=1.9.7",
  "numpy>=1.21.0",
  "matplotlib>=3.5.0",
  "scikit-learn>=1.0.0",
  "scipy>=1.10",
  "python-pptx>=0.6.21",   # slide deck generation
  "Pillow>=10.0",          # image handling for slides
  "cairosvg>=2.7",         # SVG -> PNG for slides when needed
  "PyYAML>=6.0"            # --options file loading
]

[project.optional-dependencies]
dev = [
  "pytest>=7.0",
  "pytest-cov>=4.0"
]
test = [
  "pytest>=7.0",
  "pytest-cov>=4.0"
]

[project.urls]
Repository = "https://github.com/aai-research-lab/FastMDAnalysis"
Documentation = "https://fastmdanalysis.readthedocs.io"
Issues = "https://github.com/aai-research-lab/FastMDAnalysis/issues"

[project.scripts]
# Explicit module:function entrypoint
fastmda = "fastmdanalysis.cli.main:main"

# Package discovery for src/ layout
[tool.hatch.build.targets.wheel]
packages = ["src/fastmdanalysis"]

# Include non-.py assets (datasets, examples, etc.) in wheels & sdists
[tool.hatch.build]
include = [
  "src/fastmdanalysis/**",
  "README.md",
  "LICENSE"
]
exclude = [
  "src/fastmdanalysis/**/old_*",
  "src/fastmdanalysis/**/old_*/**",
  ".github/workflows/old_*"
]

# ----------------------------- Pytest config ----------------------------------
[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
addopts = "-ra --strict-markers --disable-warnings"

markers = [
  "slow: time-consuming tests (run with -m slow or exclude with -m 'not slow')",
  "cli: tests that invoke the command-line interface",
  "slides: tests that require python-pptx/Pillow and create a deck"
]

# Silence known benign warnings (MDTraj CRYST1, etc.)
filterwarnings = [
  "ignore:Unlikely unit cell vectors detected.*CRYST1:UserWarning:mdtraj.formats.pdb.pdbfile",
  "ignore:.*deprecated.*:DeprecationWarning"
]

# ----------------------------- Coverage config --------------------------------
[tool.coverage.run]
source = ["src/fastmdanalysis"]
branch = true
omit = [
  "src/fastmdanalysis/__main__.py",            # tiny entry point
  "src/fastmdanalysis/cli/*",                  # CLI is integration-heavy; add tests later
  "src/fastmdanalysis/utils/slideshow.py",     # relies on python-pptx & FS; test later with fakes
  "src/fastmdanalysis/datasets.py",            # data locators (not core logic)
]

[tool.coverage.report]
show_missing = true
precision = 1
exclude_lines = [
  "pragma: no cover",
  "if TYPE_CHECKING:"
]
