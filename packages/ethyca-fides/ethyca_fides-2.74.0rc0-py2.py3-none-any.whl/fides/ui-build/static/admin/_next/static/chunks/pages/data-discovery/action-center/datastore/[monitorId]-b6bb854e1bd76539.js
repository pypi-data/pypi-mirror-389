(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6721],{58095:function(e,t,n){var r=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},95372:function(e){e.exports=function(e,t,n,r){for(var i=e.length,l=n+(r?1:-1);r?l--:++l<i;)if(t(e[l],l,e))return l;return -1}},8817:function(e,t,n){var r=n(95372),i=n(1129),l=n(58263);e.exports=function(e,t,n){return t==t?l(e,t,n):r(e,i,n)}},1129:function(e){e.exports=function(e){return e!=e}},74833:function(e,t,n){var r=n(56127),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},92198:function(e,t,n){var r=n(52485),i=n(58095),l=n(21796),a=n(65581),o=n(47111),s=n(43735);e.exports=function(e,t,n){var c=-1,u=i,d=e.length,p=!0,f=[],h=f;if(n)p=!1,u=l;else if(d>=200){var m=t?null:o(e);if(m)return s(m);p=!1,u=a,h=new r}else h=t?[]:f;e:for(;++c<d;){var g=e[c],y=t?t(g):g;if(g=n||0!==g?g:0,p&&y==y){for(var v=h.length;v--;)if(h[v]===y)continue e;t&&h.push(y),f.push(g)}else u(h,y,n)||(h!==f&&h.push(y),f.push(g))}return f}},56632:function(e,t,n){var r=n(89278),i=n(80068),l=n(50098);e.exports=function(e){return function(t,n,a){var o=Object(t);if(!i(t)){var s=r(n,3);t=l(t),n=function(e){return s(o[e],e,o)}}var c=e(t,n,a);return c>-1?o[s?t[c]:c]:void 0}}},47111:function(e,t,n){var r=n(46151),i=n(50344),l=n(43735),a=r&&1/l(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=a},58263:function(e){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1}},56127:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},66726:function(e,t,n){var r=n(11611),i=n(82846),l=n(91936),a=Math.max,o=Math.min;e.exports=function(e,t,n){var s,c,u,d,p,f,h=0,m=!1,g=!1,y=!0;if("function"!=typeof e)throw TypeError("Expected a function");function v(t){var n=s,r=c;return s=c=void 0,h=t,d=e.apply(r,n)}function _(e){var n=e-f,r=e-h;return void 0===f||n>=t||n<0||g&&r>=u}function A(){var e,n,r,l=i();if(_(l))return x(l);p=setTimeout(A,(e=l-f,n=l-h,r=t-e,g?o(r,u-n):r))}function x(e){return(p=void 0,y&&s)?v(e):(s=c=void 0,d)}function E(){var e,n=i(),r=_(n);if(s=arguments,c=this,f=n,r){if(void 0===p)return h=e=f,p=setTimeout(A,t),m?v(e):d;if(g)return clearTimeout(p),p=setTimeout(A,t),v(f)}return void 0===p&&(p=setTimeout(A,t)),d}return t=l(t)||0,r(n)&&(m=!!n.leading,u=(g="maxWait"in n)?a(l(n.maxWait)||0,t):u,y="trailing"in n?!!n.trailing:y),E.cancel=function(){void 0!==p&&clearTimeout(p),h=0,s=f=c=p=void 0},E.flush=function(){return void 0===p?d:x(i())},E}},64925:function(e,t,n){var r=n(56632)(n(66259));e.exports=r},66259:function(e,t,n){var r=n(95372),i=n(89278),l=n(47991),a=Math.max;e.exports=function(e,t,n){var o=null==e?0:e.length;if(!o)return -1;var s=null==n?0:l(n);return s<0&&(s=a(o+s,0)),r(e,i(t,3),s)}},50344:function(e){e.exports=function(){}},82846:function(e,t,n){var r=n(77400);e.exports=function(){return r.Date.now()}},94919:function(e,t,n){var r=n(91936),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-i?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,n){var r=n(94919);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},91936:function(e,t,n){var r=n(74833),i=n(11611),l=n(55193),a=0/0,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(l(e))return a;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):o.test(e)?a:+e}},83766:function(e,t,n){var r=n(92198);e.exports=function(e){return e&&e.length?r(e):[]}},83806:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/datastore/[monitorId]",function(){return n(23956)}])},30952:function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var r=n(24246),i=n(66726),l=n.n(i),a=n(27378),o=n(26917);let s=e=>{let{value:t,onChange:n,placeholder:i,...s}=e,[c,u]=(0,a.useState)(t);(0,a.useEffect)(()=>{u(t||"")},[t]);let d=l()(n,500),p=(0,a.useCallback)(e=>{u(e),d(e)},[]);return(0,r.jsx)(o.Z,{value:c,onChange:p,onClear:()=>{u(""),n("")},placeholder:i,...s})}},35287:function(e,t,n){"use strict";var r=n(24246),i=n(98227),l=n(88038),a=n.n(l);n(27378),t.Z=e=>{let{children:t,title:n,fullHeight:l,fullWidth:o,mainProps:s}=e;return(0,r.jsxs)(i.kCb,{"data-testid":n,direction:"column",height:l?"100vh":"calc(100vh - 48px)",width:o?"100vw":"calc(100vw - 240px)",children:[(0,r.jsxs)(a(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(i.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...s,children:t})]})}},58754:function(e,t,n){"use strict";var r=n(24246),i=n(98227),l=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:a=!0,children:o,rightContent:s,style:c,...u}=e;return(0,r.jsxs)("div",{...u,style:a?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...c}:{paddingBottom:"24px",...c},children:[(0,r.jsxs)(i.jqI,{justify:"space-between",children:["string"==typeof t?(0,r.jsx)(i.lQT,{className:n||o?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,s&&(0,r.jsx)("div",{"data-testid":"page-header-right-content",children:s})]}),!!n&&(0,r.jsx)(l.m,{className:o?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),o]})}},12627:function(e,t,n){"use strict";var r=n(24246),i=n(79283),l=n(34929);t.Z=e=>{let{selectedTaxonomies:t,showDisabled:n=!1,...a}=e,{getDataCategoryDisplayNameProps:o,getDataCategories:s}=(0,l.Z)(),c=(n?s():s().filter(e=>e.active)).filter(e=>!(null==t?void 0:t.includes(e.fides_key))).map(e=>{let{name:t,primaryName:n}=o(e.fides_key);return{value:e.fides_key,name:t,primaryName:n,description:e.description||""}});return(0,r.jsx)(i.l,{options:c,...a})}},79283:function(e,t,n){"use strict";n.d(t,{l:function(){return u}});var r=n(24246),i=n(98227),l=n(72707),a=n.n(l);let o=e=>{let{data:{formattedTitle:t,description:n,name:l,primaryName:a}}=e;return(0,r.jsxs)(i.jqI,{gap:12,title:"".concat(t," - ").concat(n),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:a||l}),a&&": ".concat(l)]}),(0,r.jsx)("em",{children:n})]})},s=e=>"options"in e&&Array.isArray(e.options),c=e=>({...e,className:a().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),u=e=>{let{options:t,...n}=e,l=null==t?void 0:t.map(e=>s(e)?{...e,options:e.options.map(c)}:c(e));return(0,r.jsx)(i.WPr,{options:l,filterOption:(e,t)=>{var n,r;return(null==t?void 0:null===(n=t.formattedTitle)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(r=t.value)||void 0===r?void 0:r.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:o,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...n})}},34929:function(e,t,n){"use strict";var r=n(24246),i=n(64925),l=n.n(i),a=n(27378),o=n(16134),s=n(30002),c=n(28079),u=n(57072);let d=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,o.C)(c.U3),{isLoading:n}=(0,u.MO)(),r=(0,o.C)(u.qb),{isLoading:i}=(0,s.te)();return{dataUses:t,dataSubjects:(0,o.C)(s.ZL),dataCategories:r,isLoading:e||n||i}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:n,isLoading:i}=d(),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},s=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t(e);if(!r)return{};let i=t(o(e,n)),l=!!r.parent_key;return{name:r.name||void 0,primaryName:l&&(null==i?void 0:i.name)!==r.name&&(null==i?void 0:i.name)||void 0}},c=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:i,primaryName:l}=s(e,t,n);return i?l?(0,r.jsxs)(a.Fragment,{children:[(0,r.jsxs)("strong",{children:[l,":"]})," ",i]},e):(0,r.jsx)("strong",{children:i},e):e},u=t=>l()(e,{fides_key:t}),p=e=>l()(t,{fides_key:e}),f=e=>l()(n,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:u,getDataUseDisplayName:e=>c(e,u,1),getDataUseDisplayNameProps:e=>s(e,u,1),getDataCategories:()=>t,getDataCategoryByKey:p,getDataCategoryDisplayName:e=>c(e,p,2),getDataCategoryDisplayNameProps:e=>s(e,p,2),getDataSubjects:()=>n,getDataSubjectByKey:f,getDataSubjectDisplayName:e=>{let t=f(e);return t?t.name:e},getPrimaryKey:o,isLoading:i}}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return c}});var r=n(24246),i=n(98227),l=n(79894),a=n.n(l),o=n(27378);let{Text:s}=i.AntTypography,c=e=>{let{items:t,...n}=e,l=(0,o.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let l=n===t.length-1,o={...e},c=o.onClick&&!o.href;return("string"==typeof o.title&&(o.title=(0,r.jsx)(s,{style:{color:"inherit",maxWidth:l?void 0:400},ellipsis:!l,id:l?"breadcrumb-current-page":void 0,children:o.title})),c)?o.title=(0,r.jsx)(i.wpx,{type:"text",size:"small",icon:o.icon,onClick:o.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:o.title}):(o.icon&&(o.title=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"anticon align-text-bottom",children:o.icon}),o.title]})),o.href&&o.title&&(o.title=(0,r.jsx)(a(),{href:o.href,className:"ant-breadcrumb-link",children:o.title}),delete o.href)),o}),[t]);return(0,r.jsx)(i.zrq,{items:l,...n})}},9270:function(e,t,n){"use strict";n.d(t,{S:function(){return l}});var r=n(27378),i=n(36866);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.h)(e),{pageIndex:n,pageSize:l,updatePageIndex:a,updatePageSize:o,pageSizeOptions:s,showSizeChanger:c}=t,u=(0,r.useMemo)(()=>({current:n,pageSize:l,showSizeChanger:c,pageSizeOptions:s.map(String),onChange:a,onShowSizeChange:(e,t)=>{o(t)}}),[n,l,c,s,a,o]);return{...t,paginationProps:u}}},59001:function(e,t,n){"use strict";n.d(t,{Ch:function(){return s},Lo:function(){return a},_g:function(){return c},ac:function(){return l},aq:function(){return u}});var r,i,l,a,o=n(65735);let s="root";(r=l||(l={})).DATA_CATEGORY="data_category",r.DATA_USE="data_use",r.DATA_SUBJECT="data_subject",r.SYSTEM_GROUP="system_group",(i=a||(a={})).DATA_CATEGORIES="Data categories",i.DATA_USES="Data uses",i.DATA_SUBJECTS="Data subjects",i.SYSTEM_GROUPS="System groups";let c=e=>{switch(e){case"data_category":return"Data categories";case"data_use":return"Data uses";case"data_subject":return"Data subjects";case"system_group":return"System groups";default:return e}},u=e=>{switch(e){case"data_category":return{UPDATE:o.Sh.DATA_CATEGORY_UPDATE,CREATE:o.Sh.DATA_CATEGORY_CREATE,DELETE:o.Sh.DATA_CATEGORY_DELETE,READ:o.Sh.DATA_CATEGORY_READ};case"data_use":return{UPDATE:o.Sh.DATA_USE_UPDATE,CREATE:o.Sh.DATA_USE_CREATE,DELETE:o.Sh.DATA_USE_DELETE,READ:o.Sh.DATA_USE_READ};case"data_subject":return{UPDATE:o.Sh.DATA_SUBJECT_UPDATE,CREATE:o.Sh.DATA_SUBJECT_CREATE,DELETE:o.Sh.DATA_SUBJECT_DELETE,READ:o.Sh.DATA_SUBJECT_READ};case"system_group":return{UPDATE:o.Sh.SYSTEM_GROUP_UPDATE,CREATE:o.Sh.SYSTEM_GROUP_CREATE,DELETE:o.Sh.SYSTEM_GROUP_DELETE,READ:o.Sh.SYSTEM_GROUP_READ};default:return{UPDATE:o.Sh.TAXONOMY_UPDATE,CREATE:o.Sh.TAXONOMY_CREATE,DELETE:o.Sh.TAXONOMY_DELETE,READ:o.Sh.TAXONOMY_READ}}}},90673:function(e,t,n){"use strict";n.d(t,{Cd:function(){return l},Xl:function(){return a}});var r=n(65735),i=n(59001);let l=(e,t)=>{let n;if(null==t&&e.every(e=>void 0===e.parent_key))n=e;else{let r=null!=t?t:null;n=e.filter(e=>e.parent_key===r)}return n.map(t=>{var n,r;let i=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:l(e,i),is_default:null!==(n=t.is_default)&&void 0!==n&&n,active:null!==(r=t.active)&&void 0!==r&&r}})},a=e=>{switch(e){case i.ac.DATA_CATEGORY:return r.P6.DATA_CATEGORY;case i.ac.DATA_SUBJECT:return r.P6.DATA_SUBJECT;case i.ac.DATA_USE:return r.P6.DATA_USE;default:return}}},57072:function(e,t,n){"use strict";n.d(t,{Bd:function(){return r.Bd},L5:function(){return r.L5},MO:function(){return r.MO},qb:function(){return r.qb}});var r=n(5785)},39864:function(e,t,n){"use strict";n.d(t,{Cy:function(){return a},J1:function(){return l},MU:function(){return r},ci:function(){return i},d9:function(){return o}});let{useGetCustomTaxonomiesQuery:r,useLazyGetTaxonomyQuery:i,useCreateTaxonomyMutation:l,useUpdateTaxonomyMutation:a,useDeleteTaxonomyMutation:o}=n(78780).u.injectEndpoints({endpoints:e=>({getCustomTaxonomies:e.query({query:()=>({url:"taxonomies"})}),getTaxonomy:e.query({query:e=>({url:"taxonomies/".concat(e,"/elements")}),providesTags:(e,t,n)=>[{type:"Taxonomy",id:n}],transformResponse:e=>{let t=[],n=[...e],r=n.filter(e=>null===e.parent_key);r.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...r);let i=n.filter(e=>null!==e.parent_key);for(;i.length>0;){let e=i.filter(e=>t.some(t=>t.fides_key===e.parent_key));if(0===e.length){t.push(...i.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)));break}e.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...e),i=i.filter(t=>!e.includes(t))}return t}}),createTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t,"/elements"),method:"POST",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}}),updateTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t,"/elements/").concat(n.fides_key),method:"PUT",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}}),deleteTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,key:n}=e;return{url:"taxonomies/".concat(t,"/").concat(n),method:"DELETE"}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}})})})},23956:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return e7}});var r,i,l,a,o=n(24246),s=n(98227),c=n(25980),u=n(86677),d=n(27378),p=n(43929),f=n(30952),h=n(35287),m=n(17245),g=n(77830),y=n(58754),v=n(9270),_=n(37059),A=n(65735);(r=l||(l={})).CLASSIFY="classify",r.APPROVE="approve",r.UN_APPROVE="un-approve",r.PROMOTE="promote",r.PROMOTE_REMOVALS="promote-removals",r.MUTE="mute",r.UN_MUTE="un-mute",r.ASSIGN_CATEGORIES="assign-categories";let{APPROVE:x,CLASSIFY:E,PROMOTE:S,MUTE:T,UN_MUTE:j}=l,b={approve:"Approve","assign-categories":"Assign categories",classify:"Classify",mute:"Ignore",promote:"Confirm","promote-removals":"Promote removals","un-approve":"Un-approve","un-mute":"Restore"},C={approve:"Approving","assign-categories":"Updating data categories",classify:"Classifying",mute:"Ignoring",promote:"Confirming","promote-removals":"Promoting removals","un-approve":"Un-approving","un-mute":"Restoring"},I={approve:"Approved","assign-categories":"Data category updated",classify:"Classified",mute:"Ignored",promote:"Confirmed","promote-removals":"Promoted removals","un-approve":"Un-approved","un-mute":"Restored"},D=[x,S],L=[E,x,S,T,j],R=[E,S],k={[x]:"You can only approve resources with a data category applied",[E]:"You cannot classify resources that are already in classification or ignored",[T]:"You cannot ignore resources that are already ignored",[S]:"You can only confirm resources that have a data category applied",[j]:"You can only restore resources that are ignored"},O={classify:[A.LL.ADDITION,A.LL.CLASSIFICATION_ADDITION,A.LL.CLASSIFICATION_UPDATE,A.LL.CLASSIFICATION_ERROR],approve:[A.LL.CLASSIFICATION_ADDITION,A.LL.CLASSIFICATION_UPDATE,A.LL.APPROVED],"un-approve":[A.LL.APPROVED],promote:[A.LL.CLASSIFICATION_ADDITION,A.LL.CLASSIFICATION_UPDATE,A.LL.APPROVED,A.LL.PROMOTION_ERROR],"promote-removals":[A.LL.REMOVAL,A.LL.REMOVAL_PROMOTION_ERROR],mute:[A.LL.ADDITION,A.LL.CLASSIFICATION_ADDITION,A.LL.CLASSIFICATION_UPDATE,A.LL.APPROVED,A.LL.REMOVAL,A.LL.CLASSIFICATION_ERROR,A.LL.PROMOTION_ERROR,A.LL.REMOVAL_PROMOTION_ERROR],"un-mute":[A.LL.MUTED],"assign-categories":[A.LL.ADDITION,A.LL.CLASSIFICATION_ADDITION,A.LL.CLASSIFICATION_UPDATE,A.LL.APPROVED,A.LL.CLASSIFICATION_ERROR,A.LL.PROMOTION_ERROR]},P={"assign-categories":null,"promote-removals":null,"un-approve":null,"un-mute":(0,o.jsx)(s.PJP.G7x,{}),approve:(0,o.jsx)(s.PJP.MCw,{}),classify:(0,o.jsx)(s.QMR,{size:14}),mute:(0,o.jsx)(s.PJP.uzw,{}),promote:(0,o.jsx)(s.PJP.MCw,{})},w={"assign-categories":e=>null,"promote-removals":e=>null,"un-approve":e=>null,"un-mute":e=>"Are you sure you want to restore ".concat(e.toLocaleString()," resources?"),approve:e=>"Are you sure you want to approve ".concat(e.toLocaleString()," resources?"),classify:e=>"Are you sure you want to run the classifier and apply data categories to ".concat(e.toLocaleString()," unlabeled resources?"),mute:e=>"Are you sure you want to ignore ".concat(e.toLocaleString()," resources? After ignoring, these resources may reappear in future scans."),promote:e=>"Are you sure you want to confirm these ".concat(e.toLocaleString()," resources? After confirming this data can be used for policy automation and DSRs. ")},N={onCancel:async()=>!1,onOk:async()=>!0,icon:null,width:542};var U=n(98784),M=n.n(U);let q="space",F=e=>e.map(e=>{let{itemKey:t}=e;return t}),z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeListItem:t=null,enableKeyboardShortcuts:n=!1}=e,[r,i]=(0,d.useState)("inclusive"),[l,a]=(0,d.useState)([]),[o,s]=(0,d.useState)([]),c=e=>{s(M().uniqBy(e,"itemKey"))},u=(e,t)=>{let n=l.find(t=>e===t.itemKey);n&&((("inclusive"===r?t:!t)?"add":"remove")=="add"?c([...o,n]):c(o.filter(t=>t.itemKey!==e)))},f=e=>{i(e),s([])},h=l.filter(e=>{let{itemKey:t}=e;return!o.find(e=>e.itemKey===t)}),m="inclusive"===r?o:h,g="exclusive"===r?o:h;return(0,p.y1)("h",()=>{f("exclusive")},{enabled:n}),(0,p.y1)("l",()=>{f("inclusive")},{enabled:n}),(0,p.y1)(q,e=>{if(t){e.preventDefault();let n=m.some(e=>e.itemKey===t.itemKey);u(t.itemKey,!n)}},{enabled:n},[t,m,u]),{excludedListItems:g,indeterminate:"inclusive"===r?m.length>0&&l.length!==m.length:g.length>0,isBulkSelect:"inclusive"===r?m.length>0&&l.length===m.length:0===g.length,listSelectMode:r,resetListSelect:()=>{s([]),i("inclusive")},selectedListItems:m,updateListItems:a,updateListSelectMode:f,updateSelectedListItem:u}},G=e=>{let{...t}=e;return(0,o.jsx)(s.$zI,{title:"Keyboard shortcuts",footer:null,...t,children:(0,o.jsx)(s.Yfl,{bordered:!0,column:1,items:[{key:"".concat(s.dHR.NAVIGATE_UP,"-").concat(s.dHR.NAVIGATE_DOWN),label:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:s.dHR.NAVIGATE_DOWN})," ","/"," ",(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:s.dHR.NAVIGATE_UP})]}),children:"Activate the next/previous field"},{key:q,label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:q}),children:"Toggle checkbox of the active field"},{key:"h",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"h"}),children:"Select all fields"},{key:"l",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"l"}),children:"Deselect all fields"},{key:s.dHR.CLEAR_FOCUS,label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:s.dHR.CLEAR_FOCUS}),children:"Clear the active field"},{key:"o",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"o"}),children:"Open/close details drawer for active field"},{key:"a",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"a"}),children:"Approve the active field"},{key:"c",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"c"}),children:"Confirm the active field"},{key:"i",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"i"}),children:"Ignore the active field"},{key:"r",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"r"}),children:"Restore the active field"},{key:"e",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"e"}),children:"Edit data categories for the active field"},{key:"?",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"?"}),children:"Open/close this modal"}]})})};var Y=n(78780),J=n(16394);let{useFieldActionsMutation:K,useGetMonitorFieldsQuery:B,useLazyGetAllowedActionsQuery:V}=Y.u.injectEndpoints({endpoints:e=>({getMonitorFields:e.query({query:e=>{let{path:{monitor_config_id:t},query:{page:n=1,size:r=20,search:i,diff_status:l,confidence_score:a,...o}}=e,s=(0,J.$J)({...o,...i?{search:[i]}:{},...l?{diff_status:l}:{},...a?{confidence_score:a}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields?").concat(null==s?void 0:s.toString()),params:{page:n,size:r}}},providesTags:["Monitor Field Results"]}),fieldActions:e.mutation({query:e=>{let{path:{monitor_config_id:t,action_type:n},query:{search:r,diff_status:i,confidence_score:l,...a},...o}=e,s=(0,J.$J)({...a,...r?{search:[r]}:{},...i?{diff_status:i}:{},...l?{confidence_score:l}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields/").concat(n,"?").concat(s.toString()),method:"POST",body:o}},invalidatesTags:["Monitor Field Results","Monitor Field Details"]}),getAllowedActions:e.query({query:e=>{let{path:{monitor_config_id:t},query:{search:n,diff_status:r,confidence_score:i,...l},...a}=e,o=(0,J.$J)({...l,...n?{search:[n]}:{},...r?{diff_status:r}:{},...i?{confidence_score:i}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields/allowed-actions?").concat(o.toString()),method:"POST",body:a}},providesTags:["Allowed Monitor Field Actions"]})})});var $=n(83766),W=n.n($),Z=n(59001),H=n(90673),Q=n(39864),X=n(3124),ee=n.n(X);let et="load_more",en="skeleton",er=["Unlabeled","Classifying","In Review","Approved","Confirming...","Confirmed","Removed","Ignored","Error"],ei=["Confirmed","Ignored","Confirming..."],el=e=>e.filter(e=>!ei.includes(e)),ea={addition:{label:"Unlabeled"},approved:{label:"Approved",color:s.tAb.SUCCESS},classification_addition:{label:"In Review",color:s.tAb.CAUTION},classification_error:{label:"Error",color:s.tAb.ERROR},classification_queued:{label:"Classifying",color:s.tAb.INFO},classification_update:{label:"In Review",color:s.tAb.CAUTION},classifying:{label:"Classifying",color:s.tAb.INFO},monitored:{label:"Confirmed",color:s.tAb.MINOS},muted:{label:"Ignored",color:s.tAb.DEFAULT},promoting:{label:"Confirming...",color:s.tAb.DEFAULT},promotion_error:{label:"Error",color:s.tAb.ERROR},removal:{label:"Removed",color:s.tAb.ERROR},removing:{label:"In Review",color:s.tAb.CAUTION},removal_promotion_error:{label:"Error",color:s.tAb.ERROR}},eo={[A.D$.DATABASE]:s.PJP.S9g,[A.D$.FIELD]:s.PJP.sgG,[A.D$.SCHEMA]:s.PJP.ehp,[A.D$.TABLE]:s.PJP.iA_},es={STATUS:"status-section",DATA_CATEGORY:"data-category-section",CONFIDENCE:"confidence-section"},ec={[A.Ag.ADDITION]:{color:ee().FIDESUI_SUCCESS,tooltip:"This resource was added in the latest scan"},[A.Ag.REMOVAL]:{color:ee().FIDESUI_ERROR,tooltip:"This resource was removed in the latest scan"},[A.Ag.CHANGE]:{color:ee().FIDESUI_WARNING,tooltip:"This resource was modified in the latest scan"}},eu=(e,t)=>{if(!e||0===e.length)return[];let n=(e,t)=>{let r=t=>{if(t.value===e)return{title:t.label||e,children:t.children||[]};if(t.children&&t.children.length>0){let r=n(e,t.children);if(r)return r}return null};return t.reduce((e,t)=>null!=e?e:r(t),null)},r=new Map;e.forEach(e=>{let i=e.split(".");i.forEach((e,l)=>{let a=i.slice(0,l+1).join(".");if(!r.has(a)){let e=n(a,t);r.set(a,{title:(null==e?void 0:e.title)||(0,J.kC)(a.split(".").pop()||a),key:a,checkable:!0,selectable:!1})}})});let i=Array.from(r.values()),l=new Map;i.forEach(e=>{let t=e.key.toString().split(".");if(t.length>1){let n=t.slice(0,-1).join(".");l.has(n)||l.set(n,[]),l.get(n).push(e)}});let a=e=>(l.get(e)||[]).map(e=>{let t=a(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}});return i.filter(e=>1===e.key.toString().split(".").length).map(e=>{let t=a(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}})},ed=e=>{let{resourceStatus:t,setResourceStatus:n,dataCategory:r,setDataCategory:i,resetToInitialState:l,monitorId:a,stagedResourceUrn:c}=e,[u,p]=(0,d.useState)(t),[f,h]=(0,d.useState)(r),[m,g]=(0,d.useState)([es.STATUS]);(0,d.useEffect)(()=>{p(t)},[t]),(0,d.useEffect)(()=>{h(r)},[r]);let y=c.join(",");(0,d.useEffect)(()=>{l()},[y]);let{data:v,refetch:A}=(0,_.S0)({monitor_config_id:a,staged_resource_urn:c},{refetchOnMountOrArgChange:!0}),[x,{data:E=[]}]=(0,Q.ci)();(0,d.useEffect)(()=>{x(Z.ac.DATA_CATEGORY)},[x]);let S=(0,d.useMemo)(()=>(0,H.Cd)(E),[E]),T=(0,d.useMemo)(()=>er.map(e=>({title:e.replace(/\.{3}$/,""),key:e,checkable:!0,selectable:!1,isLeaf:!0})),[]),j=(0,d.useMemo)(()=>(null==v?void 0:v.data_category)&&0!==v.data_category.length?eu(v.data_category,S):[],[null==v?void 0:v.data_category,S]),b=(0,d.useMemo)(()=>{let e=[];return T.length>0&&e.push({title:"Status",key:es.STATUS,checkable:!0,selectable:!1,isLeaf:!1,children:T}),j.length>0&&e.push({title:"Data category",key:es.DATA_CATEGORY,checkable:!0,selectable:!1,isLeaf:!1,children:j}),e},[T,j]),C=(0,d.useMemo)(()=>W()([...null!=u?u:[],...null!=f?f:[]]),[u,f]),I=(0,d.useMemo)(()=>{let e=0;return t&&(e+=new Set(t).size),r&&(e+=new Set(r).size),e},[t,r]);return(0,o.jsx)(s.wn$,{treeProps:{checkable:!0,checkedKeys:C,onCheck:e=>{let t=Array.isArray(e)?e:e.checked,n=[],r=[],i=Object.values(es),l=(e,t)=>t.some(t=>t!==e&&t.startsWith("".concat(e,"."))),a=t.map(e=>e.toString());t.forEach(e=>{let t=e.toString();if(i.some(e=>e===t))return;let o=er.find(e=>e===t);o?n.push(o):l(t,a)||r.push(t)}),p(n.length>0?n:[]),h(r.length>0?r:[])},treeData:b,expandedKeys:m,onExpand:e=>{g(e)}},onApply:()=>{n(u&&u.length>0?Array.from(new Set(u)):u),i(f&&f.length>0?Array.from(new Set(f)):f)},onReset:()=>{l(),p(el([...er])),h([])},onClear:()=>{p([]),h([])},onOpenChange:e=>{if(e){A();return}p(t),h(r)},activeFiltersCount:I})};(i=a||(a={})).LOW="low",i.HIGH="high",i.MANUAL="manual";let ep=e=>{let{percent:t,confidenceScore:n}=e;return null},ef=e=>{switch(e){case 1:return A.D$.DATABASE;case 2:return A.D$.SCHEMA;case 3:return A.D$.TABLE;default:return A.D$.FIELD}},eh=e=>{if(!e||"string"!=typeof e)return[];let t=e.trim();if(!t)return[];let n=t.split(".");if(n.length<2)return[];let r=n.filter(e=>e&&e.trim().length>0);return r.length<2?[]:(r.shift(),r.length>0&&r.pop(),0===r.length)?[]:r.map((e,t)=>{let n=eo[ef(t+1)];return{title:e.trim(),IconComponent:n}})};var em=n(79283),eg=n(34929),ey=e=>{let{onSelectDataCategory:t,urn:n,...r}=e,{getDataCategoryDisplayNameProps:i,getDataCategories:l}=(0,eg.Z)(),a=l().filter(e=>e.active),[c,u]=(0,d.useState)(!1),p=a.map(e=>{let{name:t,primaryName:n}=i(e.fides_key);return{value:e.fides_key,label:(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:n||t}),n&&": ".concat(t)]}),name:t,primaryName:n,description:e.description||""}});return(0,o.jsx)(em.l,{options:p,prefix:(0,o.jsx)(s.wpx,{"aria-label":"Add Data Category",type:"text",size:"small",icon:(0,o.jsx)(s.PJP.mm_,{}),disabled:r.disabled}),placeholder:"",suffixIcon:null,classNames:{root:"w-full max-w-full overflow-hidden p-0 cursor-pointer -ml-5"},style:{"--ant-select-multiple-selector-bg-disabled":"transparent"},variant:"borderless",autoFocus:!1,maxTagCount:"responsive",open:c,onOpenChange:e=>u(e),onSelect:e=>{t(e),u(!1)},"data-classification-select":n,...r})},ev=n(97947),e_=n.n(ev);let eA=e=>{let{label:t,closable:n,onClose:r,isFromClassifier:i}=e;return(0,o.jsx)(s.j8w,{color:"white",bordered:!0,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:n,onClose:r,style:{marginInlineEnd:"calc((var(--ant-padding-xs) * 0.5))"},icon:i&&(0,o.jsx)(s.QMR,{}),children:(0,o.jsx)(s.lKn,{size:"sm",children:t})})},ex=e=>{let{title:t,IconComponent:n}=e;return{title:n?(0,o.jsxs)(s.jqI,{gap:3,align:"center",children:[(0,o.jsx)(n,{}),(0,o.jsx)("span",{children:t})]}):t}};var eE=e=>{let{urn:t,classifications:n,name:r,diff_status:i,selected:l,onSelect:c,onSetDataCategories:u,dataCategoriesDisabled:d,onNavigate:p,preferred_data_categories:f,actions:h}=e;return(0,o.jsx)(s.krs.Item,{actions:[n&&n.length>0&&(0,o.jsx)(ep,{percent:n.find(e=>e.confidence_score===a.HIGH)?100:25}),...null!=h?h:[]],children:(0,o.jsx)(s.krs.Item.Meta,{avatar:(0,o.jsx)("div",{className:"ml-2",children:(0,o.jsx)(s.E_O,{checked:l,onChange:e=>c&&c(t,e.target.checked)})}),title:(0,o.jsxs)(s.jqI,{gap:12,align:"center",className:e_()["monitor-field__title"],children:[(0,o.jsx)(s.wpx,{type:"text",size:"small",className:"-mx-2",onClick:()=>p&&p(t),children:r}),i&&i!==A.LL.ADDITION&&(0,o.jsx)(s.j8w,{bordered:!1,color:ea[i].color,children:ea[i].label}),(0,o.jsx)(s.esZ,{title:t,mouseEnterDelay:.5,children:(0,o.jsx)(s.zrq,{className:e_()["monitor-field__breadcrumb"],items:eh(t).map(ex),role:"presentation",style:{overflow:"hidden"}})})]}),description:(0,o.jsx)(ey,{mode:"multiple",value:null!=f?f:[],urn:t,tagRender:e=>{let r=!!(null==n?void 0:n.find(t=>t.label===e.value));return eA({...e,isFromClassifier:r,onClose:()=>{var n;u(t,null!==(n=null==f?void 0:f.filter(t=>t!==e.value))&&void 0!==n?n:[])}})},onSelectDataCategory:e=>{(null==f?void 0:f.includes(e))||u(t,[...null!=f?f:[],e])},disabled:d})})},t)},eS=n(812);let eT=(e,t)=>e.find(e=>{let{children:n}=e;return n&&!!n.find(e=>e.key.toString()===t)}),ej=(e,t)=>e.reduce((e,n)=>{if(n.children){var r;return null!==(r=eT(n.children,t))&&void 0!==r?r:ej(n.children,t)}return e},null),eb=e=>{let{node:t,treeData:n,onLoadMore:r}=e;if(!t.title)return null;if(t.key.toString().startsWith(et)){let e=ej(n,t.key.toString());return(0,o.jsx)(s.wpx,{type:"link",block:!0,onClick:()=>{(null==e?void 0:e.key)&&r(e.key.toString())},className:"p-0",children:t.title})}if(t.key.toString().startsWith(en))return(0,o.jsx)(s.N_L,{paragraph:!1,title:{width:"80px"},active:!0,children:t.title});let i=t.status?ec[t.status]:null;return(0,o.jsxs)(s.jqI,{gap:4,align:"center",className:"inline-flex",children:[i&&(0,o.jsx)(s.esZ,{title:i.tooltip,children:(0,o.jsx)(s.PJP.fRw,{className:"size-2",style:{color:i.color}})}),(0,o.jsx)(s.lKn,{ellipsis:{tooltip:t.title},children:t.title})]})},eC=(e,t,n)=>e.map(e=>e.key===t?{...e,status:n}:e.children?{...e,children:eC(e.children,t,n)}:e),eI=(e,t)=>e.map(e=>{if(e.key===t){let{children:t,...n}=e;return n}return e.children?{...e,children:eI(e.children,t)}:e}),eD=e=>{let t=[];return e.children&&e.children.length>0&&e.children.forEach(e=>{"string"==typeof e.key&&(t.push(e.key),t.push(...eD(e)))}),t},eL=(e,t)=>{for(let n of e){if(n.key===t)return n;if(n.children){let e=eL(n.children,t);if(e)return e}}},eR=(e,t)=>{var n;let r=e.items.map(e=>{let t=e.resource_type?eo[e.resource_type]:void 0;return{title:e.name,key:e.urn,selectable:!0,icon:t?()=>(0,o.jsx)(t,{className:"h-full"}):void 0,status:e.update_status,isLeaf:e.resource_type===A.D$.FIELD||!e.has_grandchildren,classifyable:[A.D$.SCHEMA,A.D$.TABLE,A.D$.ENDPOINT,A.D$.FIELD].includes(e.resource_type)}});return(null!==(n=null==r?void 0:r.length)&&void 0!==n?n:0)<100?r:[...r,{title:"Load more...",key:"".concat(et,"-").concat(e.page,"-").concat(t),selectable:!1,isLeaf:!0}]},ek=(e,t,n)=>e.map(e=>{if(e.key===t){var r,i;return{...e,children:[...null!==(i=null===(r=e.children)||void 0===r?void 0:r.filter(e=>!(e.key.toString().startsWith(et)||e.key.toString().startsWith(en))))&&void 0!==i?i:[],...n]}}return e.children?{...e,children:ek(e.children,t,n)}:e}),eO=(e,t,n)=>e.map(e=>e.key===t?{...e,children:n}:e.children?{...e,children:eO(e.children,t,n)}:e),eP=(e,t,n)=>e.map(e=>{if(e.key===t){var r;let t=(null!==(r=e.children)&&void 0!==r?r:[]).filter(e=>!(e.key.toString().startsWith(et)||e.key.toString().startsWith(en))),i=new Map(n.map(e=>[e.key,e])),l=new Map(t.map(e=>[e.key,e])),a=t.map(e=>{let t=i.get(e.key);return null!=t?t:e});return n.forEach(e=>{l.has(e.key)||a.push(e)}),{...e,children:a}}return e.children?{...e,children:eP(e.children,t,n)}:e}),ew=(0,d.forwardRef)((e,t)=>{let{selectedNodeKeys:n,setSelectedNodeKeys:r,onClickClassifyButton:i}=e,l=(0,u.useRouter)(),{errorAlert:a}=(0,m.VY)(),c=decodeURIComponent(l.query.monitorId),[p]=(0,_.RV)(),[f]=(0,_.M8)(),[h,g]=(0,d.useState)({}),[y,v]=(0,d.useState)([]),[A,x]=(0,d.useState)([]),E=(0,d.useRef)({}),S=(0,d.useRef)({}),T=(0,d.useCallback)(async e=>{var t;let{nodeKey:n,queryParams:r,fastUpdateFn:i,detailedUpdateFn:l}=e,a=(null!==(t=E.current[n])&&void 0!==t?t:0)+1;E.current[n]=a;let o=p({...r,include_descendant_details:!1}),s=p({...r,include_descendant_details:!0});o.then(e=>{let{data:t}=e;t&&E.current[n]===a&&S.current[n]!==a&&i(t)}),s.then(e=>{let{data:t}=e;t&&E.current[n]===a&&(S.current[n]=a,(null!=l?l:i)(t))})},[p]),j=(0,d.useCallback)(e=>new Promise(t=>{let{children:n,key:r}=e;if(n){t();return}let i=r.toString();T({nodeKey:i,queryParams:{monitor_config_id:c,staged_resource_urn:i,size:100},fastUpdateFn:e=>{v(t=>eO(t,r,eR(e,i))),g(e=>({...e,[i]:{pageSize:100,pageIndex:1}}))}}),t()}),[T,c]),b=(0,d.useCallback)(e=>{let t=h[e];t&&(v(t=>ek(t,e,[...Array(100)].map((t,n)=>({key:"".concat(en,"-").concat(e,"-").concat(n),title:"SKELETON",isLeaf:!0})))),T({nodeKey:e,queryParams:{monitor_config_id:c,staged_resource_urn:e,size:100,page:t.pageIndex+1},fastUpdateFn:t=>{v(n=>ek(n,e,eR(t,e)))},detailedUpdateFn:t=>{v(n=>eP(n,e,eR(t,e))),g(t=>{var n,r;return{...t,[e]:{pageSize:100,pageIndex:(null!==(r=null===(n=t[e])||void 0===n?void 0:n.pageIndex)&&void 0!==r?r:0)+1}}})}}))},[h,T,c]),C=(0,d.useCallback)(e=>{v(t=>{let n=eL(t,e),r=[e];return n&&r.push(...eD(n)),x(e=>e.filter(e=>!r.includes(e.toString()))),g(e=>{let t={...e};return r.forEach(e=>{delete t[e]}),t}),r.forEach(e=>{delete E.current[e],delete S.current[e]}),eI(t,e)})},[]),I=(0,d.useCallback)(async e=>{let t=async e=>{try{let t=await f({monitor_config_id:c,...e&&{staged_resource_urn:e}});if(t.error){a((0,eS.e$)(t.error),"Failed to get schema explorer ancestors statuses");return}let n=t.data;if(!n)return;e?C(e):n.forEach(e=>{C(e.urn)}),v(e=>n.reduce((e,t)=>eC(e,t.urn,t.update_status),e))}catch(e){a("An unexpected error occurred while refreshing the schema explorer")}};if(0===e.length){await t();return}await Promise.all(e.map(e=>t(e)))},[f,c,C,a]),D=(0,d.useCallback)((e,t)=>{x(e),t.expanded&&!t.node.children&&j&&j(t.node)},[j]);return(0,d.useImperativeHandle)(t,()=>({refreshResourcesAndAncestors:I})),(0,d.useEffect)(()=>{(async()=>{y.length>0||T({nodeKey:"root",queryParams:{monitor_config_id:c,size:100},fastUpdateFn:e=>{v(eR(e))}})})()},[T,c,v,y.length]),(0,o.jsxs)(s.jqI,{gap:"middle",vertical:!0,className:"h-full",children:[(0,o.jsx)(s.lQT,{level:3,className:"sticky top-0",children:"Schema explorer"}),(0,o.jsx)(s.a$q,{loadData:j,treeData:y,expandedKeys:A,onExpand:D,onSelect:(e,t)=>{r(t.selectedNodes.filter(e=>e.classifyable).map(e=>e.key))},showIcon:!0,showLine:!0,blockNode:!0,rootClassName:"h-full overflow-x-hidden",titleRender:e=>(0,o.jsx)(eb,{node:e,treeData:y,onLoadMore:b})}),n.length>0&&(0,o.jsxs)(s.jqI,{justify:"space-between",align:"center",children:[(0,o.jsxs)("span",{children:[n.length," selected"]}),(0,o.jsx)(s.wpx,{"aria-label":"Classify ".concat(n.length," Selected Nodes"),icon:(0,o.jsx)(s.QMR,{size:12}),size:"small",onClick:i})]})]})});ew.displayName="MonitorTree";var eN=n(12627);let eU=e=>{let{itemKey:t,actions:n}=e;return M().isEmpty(n)?null:(0,o.jsx)(s.jqI,{gap:"small",justify:"flex-end",children:n.map((e,r)=>{let{callback:i,label:l,disabled:a}=e;return(0,o.jsx)(s.wpx,{onClick:()=>i(t),type:r===n.length-1?"primary":"default",disabled:a,children:l},l)})})},eM=e=>{let{title:t,titleIcon:n,titleTag:r}=e;return(0,o.jsxs)(s.jqI,{align:"center",gap:"small",children:[n,(0,o.jsx)("span",{children:t}),r&&(0,o.jsx)(s.j8w,{...r})]})},eq=e=>{let{title:t,titleIcon:n,titleTag:r,actions:i,width:l=480,...a}=e;return(0,o.jsx)(s.To0,{title:(0,o.jsx)(eM,{title:t,titleIcon:n,titleTag:r}),footer:a.footer||!i?a.footer:(0,o.jsx)(eU,{itemKey:a.itemKey,actions:i}),width:l,...a})},eF=(e,t)=>(0,o.jsx)(t,{...e,className:"!sticky top-0 z-[2] bg-white"}),ez=e=>{var t,n,r,i,l;let{resource:a,fieldActions:c,...u}=e;return(0,o.jsx)(eq,{...u,classNames:{body:"!pt-0 !mt-[var(--ant-padding-lg)] max-h-full"},children:a?(0,o.jsx)(s.A5g,{defaultActiveKey:"details",renderTabBar:eF,items:[{key:"details",label:"Details",children:(0,o.jsxs)(s.jqI,{gap:"middle",vertical:!0,children:[(0,o.jsx)(s.Yfl,{bordered:!0,size:"small",column:1,items:[{key:"system",label:"System",children:a.system_key},{key:"path",label:"Path",children:a.urn},{key:"data-type",label:"Data type",children:a.resource_type},{key:"description",label:"Description",children:a.description}]}),(0,o.jsx)(s.PPS,{layout:"vertical",children:(0,o.jsx)(s.PPS.Item,{label:"Data categories",children:(0,o.jsx)(eN.Z,{variant:"outlined",mode:"multiple",maxTagCount:"responsive",value:[...null!==(i=null===(t=a.classifications)||void 0===t?void 0:t.map(e=>{let{label:t}=e;return t}))&&void 0!==i?i:[],...null!==(l=null===(n=a.user_assigned_data_categories)||void 0===n?void 0:n.map(e=>e))&&void 0!==l?l:[]],autoFocus:!1,disabled:null==a||!a.diff_status||!O["assign-categories"].some(e=>e===a.diff_status),onChange:e=>c["assign-categories"]([a.urn],{user_assigned_data_categories:e})})})}),a.classifications&&a.classifications.length>0&&(0,o.jsx)(s.krs,{dataSource:a.classifications,renderItem:e=>(0,o.jsx)(s.krs.Item,{children:(0,o.jsx)(s.krs.Item.Meta,{avatar:(0,o.jsx)(s.t3Z,{style:{backgroundColor:null===ee()||void 0===ee()?void 0:ee().FIDESUI_BG_DEFAULT},icon:(0,o.jsx)(s.QMR,{color:"black"})}),title:(0,o.jsxs)(s.jqI,{align:"center",gap:"middle",children:[(0,o.jsx)("div",{children:e.label}),(0,o.jsx)(ep,{percent:100*e.score})]}),description:e.rationale})})})]})},{key:"activity",label:"Activity",children:(0,o.jsx)(s.krs,{dataSource:"errors"in a&&a.errors?null===(r=a.errors)||void 0===r?void 0:r.map((e,t)=>({key:t,title:e.phase,description:new Date(e.timestamp).toLocaleString(),content:e.message})):[],renderItem:(e,t)=>(0,o.jsxs)(s.krs.Item,{children:[(0,o.jsx)(s.krs.Item.Meta,{title:e.title,description:e.description}),(0,o.jsx)(s.FUI,{ellipsis:{expandable:"collapsible",rows:3},copyable:{icon:(0,o.jsx)(s.PJP.CKM,{className:"pt-1",size:18})},children:e.content})]},t),itemLayout:"vertical"})}]}):null})};var eG=n(31883);let eY=(e,t)=>({title:e,okText:e,content:t,...N}),eJ=(e,t)=>"".concat(I[e]).concat((0,J._6)(null!=t?t:0,"","".concat(e===l.ASSIGN_CATEGORIES?" for":""," ").concat(null==t?void 0:t.toLocaleString()," resources"))),eK=e=>"".concat(I[e]," failed").concat(e===l.CLASSIFY||e===l.PROMOTE?": View summary in the activity tab":""),eB=(e,t,n,r)=>{let[i]=K(),a=a=>async(o,s,c)=>{let u=Date.now();if(!await t.confirm(eY(b[a],w[a](c))))return;n.open({key:u,type:"loading",content:"".concat(C[a]," ").concat(c," ").concat((0,J._6)(c,"resource","resources"),"..."),duration:0});let d=await i({query:{...o.query},path:{monitor_config_id:e,action_type:a},body:{excluded_resource_urns:s}});if((0,eG.D4)(d)){n.open({key:u,type:"error",content:eK(a),duration:5});return}if(n.open({key:u,type:"success",content:eJ(a,c),duration:5}),r&&a!==l.APPROVE){let e=o.query.staged_resource_urn||[];await r(e)}};return{"assign-categories":a(l.ASSIGN_CATEGORIES),"promote-removals":a(l.PROMOTE_REMOVALS),"un-approve":a(l.UN_APPROVE),"un-mute":a(l.UN_MUTE),approve:a(l.APPROVE),classify:a(l.CLASSIFY),mute:a(l.MUTE),promote:a(l.PROMOTE)}},eV={DRAWER_OPEN:".ant-drawer-open",DRAWER_SELECT:".ant-drawer-open .ant-select",SELECT:".ant-select",SELECT_SELECTOR:".ant-select-selector",SELECT_DISABLED:"ant-select-disabled",INPUT:"input",LIST_ITEM_SELECT:"[data-classification-select]"},e$=(e,t,n,r,i,a)=>{let o=e=>{let t=e.querySelector(eV.SELECT_SELECTOR);if(!t)return!1;if(e.classList.contains(eV.SELECT_DISABLED))return i.warning("You cannot assign categories to this resource in its current state"),!1;let n=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(n);let r=e.querySelector(eV.INPUT);return r&&r.focus(),!0},s=n=>{var r;e&&(e.diff_status&&(null===(r=O[n])||void 0===r?void 0:r.includes(e.diff_status))?t[n]([e.urn]):i.warning(k[n]))};(0,p.y1)("a",()=>s(l.APPROVE),[e,t]),(0,p.y1)("c",()=>s(l.PROMOTE),[e,t]),(0,p.y1)("i",()=>s(l.MUTE),[e,t]),(0,p.y1)("r",()=>s(l.UN_MUTE),[e,t]),(0,p.y1)("o",()=>{e&&a?r(void 0):e&&!a&&r(e.urn)},[e,r,a]),(0,p.y1)("e",t=>{if(t.preventDefault(),!e)return;let n=null;if(a){let e=document.querySelector(eV.DRAWER_OPEN);e&&(n=e.querySelector(eV.SELECT))}else{let t=CSS.escape(e.urn);n=document.querySelector('[data-classification-select="'.concat(t,'"]'))}n&&o(n)},[e,i,a]),(0,p.y1)("escape",e=>{let t=document.activeElement;if((null==t?void 0:t.tagName)!=="INPUT")return;let n=t.closest(eV.LIST_ITEM_SELECT),r=t.closest(eV.DRAWER_SELECT);(n||r)&&(e.preventDefault(),e.stopPropagation(),t.blur())},{enableOnFormTags:["INPUT"]},[a])};var eW=n(70675);let eZ=e=>{let[t,...n]=e.map(e=>Object.values(l).flatMap(t=>O[t].some(t=>t===e)?[t]:[]));return n.reduce((e,t)=>M().intersection(e,[...t]),null!=t?t:[])},eH=(e,t,n,r)=>{let[i]=(0,eW.LI)(),[a]=(0,_.Av)(),[o]=(0,eW.zV)(),[s]=(0,eW.Hf)(),[c]=(0,eW._J)(),[u]=(0,eW.NA)(),d=(e,i)=>async(l,a)=>{let o=Date.now();if(!(1===l.length||await t.confirm(eY(b[e],w[e](l.length)))))return;n.open({key:o,type:"loading",content:"".concat(C[e]," ").concat(l.length," ").concat((0,J._6)(l.length,"resource","resources"),"..."),duration:0});let s=await i(l,a);if((0,eG.D4)(s)){n.open({key:o,type:"error",content:eK(e),duration:5});return}n.open({key:o,type:"success",content:eJ(e,l.length),duration:5}),r&&await r(l)},p=async e=>o({staged_resource_urns:e}),f=async e=>c({staged_resource_urns:e}),h=async e=>s({staged_resource_urns:e}),m=async t=>a({monitor_config_key:e,staged_resource_urns:t}),g=async(t,n)=>{var r;let[i]=t;return u({monitor_config_id:e,staged_resource_urn:i,user_assigned_data_categories:null!==(r=null==n?void 0:n.user_assigned_data_categories)&&void 0!==r?r:void 0})},y=async t=>i({monitor_config_key:e,staged_resource_urns:t});return{"assign-categories":d(l.ASSIGN_CATEGORIES,g),"promote-removals":()=>{},"un-approve":()=>{},"un-mute":d(l.UN_MUTE,f),approve:d(l.APPROVE,y),classify:d(l.CLASSIFY,m),mute:d(l.MUTE,p),promote:d(l.PROMOTE,h)}};var eQ=n(40431);let eX=()=>{let[e,t]=(0,eQ.v1)("resourceStatus",(0,eQ.S$)((0,eQ.km)(er))),[n,r]=(0,eQ.v1)("confidenceScore",(0,eQ.S$)((0,eQ.jx)(Object.values(a)))),[i,l]=(0,eQ.v1)("dataCategory",(0,eQ.S$)(eQ.Oi));return(0,d.useEffect)(()=>{if(null===e){let e=el([...er]);t(e.length>0?e:[])}},[]),{resourceStatus:e,setResourceStatus:t,confidenceScore:n,setConfidenceScore:r,dataCategory:i,setDataCategory:l,reset:()=>{t([]),r([]),l([])},resetToInitialState:()=>{t(el([...er])),r(null),l(null)}}},e0=e=>Object.values(A.LL).flatMap(t=>ea[t].label===e?[t]:[]);var e1=()=>{var e,t,n,r,i;let l=decodeURIComponent((0,u.useRouter)().query.monitorId),a=(0,d.useRef)(null),[c,A]=s.Pg3.useMessage(),[x,E]=s.$zI.useModal(),[S,T]=(0,d.useState)(!1),{paginationProps:j,pageIndex:C,pageSize:I,resetPagination:w}=(0,v.S)({defaultPageSize:25}),N=(0,m.Rx)(),{resourceStatus:U,confidenceScore:M,dataCategory:q,...Y}=eX(),{data:J}=(0,_.vc)({monitor_config_id:l}),[K,$]=(0,d.useState)([]),W={path:{monitor_config_id:l},query:{staged_resource_urn:K.map(e=>e.toString()),search:N.searchProps.value,diff_status:U?U.flatMap(e0):void 0,confidence_score:M||void 0,data_category:q||void 0}},{data:Z,isFetching:H,refetch:Q}=B({...W,query:{...W.query,size:I,page:C}}),[X,ee]=(0,d.useState)(),[et,en]=(0,d.useState)(),[er,ei]=(0,_.mC)(),[el,{data:eo,isFetching:es}]=V(),ec=ei.data,eu=eB(l,x,c,async e=>{var t;await (null===(t=a.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),ep=eH(l,x,c,async e=>{var t;await (null===(t=a.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),{excludedListItems:ef,indeterminate:eh,isBulkSelect:em,listSelectMode:eg,resetListSelect:ey,selectedListItems:ev,updateListItems:e_,updateListSelectMode:eA,updateSelectedListItem:ex}=z({activeListItem:et,enableKeyboardShortcuts:!0}),eS=async e=>{ee(e)};(0,p.y1)("?",()=>T(!S),{useKey:!0},[S]);let eT=em?null==eo?void 0:eo.allowed_actions:eZ(ev.flatMap(e=>{let{diff_status:t}=e;return t?[t]:[]})),ej=null!==(n=null==Z?void 0:Z.total)&&void 0!==n?n:0,eb="exclusive"===eg&&(null==Z?void 0:Z.total)?ej-ef.length:ev.length;return(0,d.useEffect)(()=>{Z&&e_(Z.items.map(e=>{let{urn:t,...n}=e;return{itemKey:t,urn:t,...n}}))},[null==Z?void 0:Z.items]),(0,d.useEffect)(()=>{X&&er({stagedResourceUrn:X})},[X]),(0,d.useEffect)(()=>{w(),ey()},[U,M,K,N.searchQuery,q]),e$(et,ep,ex,eS,c,!!X),(0,o.jsxs)(h.Z,{title:"Action center - Discovered assets by system",mainProps:{overflow:"hidden"},fullHeight:!0,children:[(0,o.jsx)(y.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:g.vi},{title:l}],isSticky:!1}),(0,o.jsxs)(s.LgQ,{className:"h-[calc(100%-48px)] overflow-hidden",children:[(0,o.jsx)(s.LgQ.Panel,{defaultSize:250,style:{paddingRight:"var(--ant-padding-md)"},children:(0,o.jsx)(ew,{ref:a,selectedNodeKeys:K,setSelectedNodeKeys:$,onClickClassifyButton:()=>{ep.classify(K.map(e=>e.toString()))}})}),(0,o.jsx)(s.LgQ.Panel,{style:{paddingLeft:"var(--ant-padding-md)"},children:(0,o.jsxs)(s.jqI,{vertical:!0,gap:"middle",className:"h-full",children:[(0,o.jsxs)(s.jqI,{justify:"space-between",children:[(0,o.jsx)(s.lQT,{level:2,children:"Monitor results"}),(0,o.jsx)(s.jqI,{align:"center",children:(null==J?void 0:J.last_monitored)&&(0,o.jsxs)(s.lKn,{type:"secondary",children:["Last scan:"," ",new Date(null==J?void 0:J.last_monitored).toLocaleString()]})})]}),(0,o.jsxs)(s.jqI,{justify:"space-between",children:[(0,o.jsxs)(s.jqI,{gap:"small",children:[(0,o.jsx)(f.f,{value:N.searchQuery,onChange:N.updateSearch,placeholder:"Search"}),(0,o.jsx)(s.esZ,{title:"Show keyboard shortcuts",children:(0,o.jsx)(s.wpx,{type:"text","aria-label":"Show keyboard shortcuts",icon:(0,o.jsx)(s.PJP.WWB,{}),onClick:()=>T(!0)})})]}),(0,o.jsxs)(s.jqI,{gap:"small",children:[(0,o.jsx)(ed,{resourceStatus:U,confidenceScore:M,dataCategory:q,...Y,monitorId:l,stagedResourceUrn:K.map(e=>e.toString())}),(0,o.jsx)(s.S0p,{onOpenChange:e=>{e&&em&&el({...W,query:{...W.query},body:{excluded_resource_urns:F(ef).map(e=>e.toString())}})},menu:{items:[...L.map(e=>({key:e,label:!es&&(null==eT?void 0:eT.includes(e))?b[e]:(0,o.jsx)(s.esZ,{title:k[e],children:b[e]}),disabled:es||!(null==eT?void 0:eT.includes(e)),onClick:()=>{em?eu[e](W,ef.map(e=>e.itemKey.toString()),eb):ep[e](ev.map(e=>{let{itemKey:t}=e;return t.toString()}))}}))]},disabled:ev.length<=0,children:(0,o.jsx)(s.wpx,{type:"primary",icon:(0,o.jsx)(s.PJP._ME,{}),iconPosition:"end",loading:es,children:"Actions"})}),(0,o.jsx)(s.esZ,{title:"Refresh",children:(0,o.jsx)(s.wpx,{icon:(0,o.jsx)(s.PJP.CQM,{}),onClick:()=>Q(),"aria-label":"Refresh"})})]})]}),(0,o.jsxs)(s.jqI,{gap:"middle",align:"center",children:[(0,o.jsx)(s.E_O,{id:"select-all",checked:em,indeterminate:eh,onChange:e=>eA(e.target.checked?"exclusive":"inclusive")}),(0,o.jsx)("label",{htmlFor:"select-all",children:"Select all"}),!!eb&&(0,o.jsxs)(s.lKn,{strong:!0,children:[eb.toLocaleString()," selected"]})]}),(0,o.jsx)(s.krs,{dataSource:null==Z?void 0:Z.items,className:"-ml-3 h-full overflow-y-scroll pl-1",loading:H,enableKeyboardShortcuts:!0,onActiveItemChange:(0,d.useCallback)(e=>{(null==e?void 0:e.urn)?(en({...e,itemKey:e.urn}),X&&e.urn!==X&&ee(e.urn)):en(void 0)},[X]),renderItem:e=>eE({...e,selected:F(ev).includes(e.urn),onSelect:ex,onNavigate:eS,onSetDataCategories:(e,t)=>ep["assign-categories"]([e],{user_assigned_data_categories:t}),dataCategoriesDisabled:null==e||!e.diff_status||!O["assign-categories"].some(t=>t===e.diff_status),actions:(null==e?void 0:e.diff_status)?R.map(t=>(0,o.jsx)(s.esZ,{title:b[t],children:(0,o.jsx)(s.wpx,{"aria-label":b[t],icon:P[t],onClick:()=>ep[t]([e.urn]),disabled:null==e||!e.diff_status||!O[t].some(t=>t===e.diff_status),style:{fontSize:"var(--ant-button-content-font-size-lg)"}})},t)):[]})}),(0,o.jsx)(s.B7X,{...j,showSizeChanger:{suffixIcon:(0,o.jsx)(s.PJP._ME,{})},total:(null==Z?void 0:Z.total)||0,hideOnSinglePage:(null===(e=j.pageSize)||void 0===e?void 0:e.toString())===(null===(t=j.pageSizeOptions)||void 0===t?void 0:t[0])})]})})]}),(0,o.jsx)(ez,{itemKey:null!==(r=null==ec?void 0:ec.urn)&&void 0!==r?r:"",title:null!==(i=null==ec?void 0:ec.name)&&void 0!==i?i:null,titleIcon:(0,o.jsx)(s.PJP.sgG,{}),titleTag:{bordered:!1,color:(null==ec?void 0:ec.diff_status)?ea[ec.diff_status].color:void 0,className:"font-normal text-[var(--ant-font-size-sm)]",children:(null==ec?void 0:ec.diff_status)?ea[ec.diff_status].label:null},actions:D.map(e=>({label:b[e],callback:t=>ep[e]([t]),disabled:null==ec||!ec.diff_status||!O[e].some(e=>e===ec.diff_status)})),open:!!X,onClose:()=>ee(void 0),resource:ec,fieldActions:ep}),(0,o.jsx)(G,{open:S,onCancel:()=>T(!1)}),E,A]})};let e2=()=>(0,o.jsx)(o.Fragment,{children:"Attempting to access monitor results without the required feature flag enabled"});var e7=()=>{let{flags:e}=(0,c.hz)();return e.heliosV2?(0,o.jsx)(e1,{}):(0,o.jsx)(s.ux6,{status:"error",title:(0,o.jsx)(e2,{})})}},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return r.Bw},D4:function(){return r.D4}});var r=n(19043)},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},97947:function(e){e.exports={"monitor-field__title":"MonitorFieldListItem_monitor-field__title__YrxOU","monitor-field__breadcrumb":"MonitorFieldListItem_monitor-field__breadcrumb__Rn4vE"}}},function(e){e.O(0,[431,7245,7059,2888,9774,179],function(){return e(e.s=83806)}),_N_E=e.O()}]);